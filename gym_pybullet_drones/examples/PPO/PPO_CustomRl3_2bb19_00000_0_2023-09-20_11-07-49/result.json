{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.912269072744343}, "policy_0": {"total_loss": 2.912269072744343, "policy_loss": -0.0033339127488434313, "vf_loss": 2.9136036302030086, "vf_loss_unclipped": 3.603432213395834, "vf_explained_var": 0.004136261415481567, "entropy": 5.90237523727417, "mean_kl_loss": 0.009996749469661155, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 255.28869284224885, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15668.536, "sample_time_ms": 6618.993, "synch_weights_time_ms": 2.999}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "2bb19_00000", "date": "2023-09-20_11-08-11", "timestamp": 1695200891, "time_this_iter_s": 15.670039415359497, "time_total_s": 15.670039415359497, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E63B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 15.670039415359497, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 3.656521739130434, "ram_util_percent": 41.71739130434783}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.4839954473183954}, "policy_0": {"total_loss": 3.4839954473183954, "policy_loss": -0.0034857265239581466, "vf_loss": 3.4854489454433324, "vf_loss_unclipped": 4.3294772711917755, "vf_explained_var": 0.006537118363380432, "entropy": 5.78045120716095, "mean_kl_loss": 0.010161078054812969, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 240.20591496837267, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16160.457, "sample_time_ms": 6843.461, "synch_weights_time_ms": 2.5}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "2bb19_00000", "date": "2023-09-20_11-08-28", "timestamp": 1695200908, "time_this_iter_s": 16.6533784866333, "time_total_s": 32.3234179019928, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E5EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 32.3234179019928, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 5.63913043478261, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.836769961810345}, "policy_0": {"total_loss": 2.836769961810345, "policy_loss": -0.007754981142655015, "vf_loss": 2.84202890538387, "vf_loss_unclipped": 3.6085317659299823, "vf_explained_var": -0.004718572616577149, "entropy": 5.700567065620422, "mean_kl_loss": 0.012480164662533207, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.6685571388706, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 15736.383, "sample_time_ms": 6642.048, "synch_weights_time_ms": 2.333}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "2bb19_00000", "date": "2023-09-20_11-08-43", "timestamp": 1695200923, "time_this_iter_s": 14.890232563018799, "time_total_s": 47.2136504650116, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316055E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 47.2136504650116, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 2.938095238095238, "ram_util_percent": 41.176190476190484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.1006114399334415}, "policy_0": {"total_loss": 6.1006114399334415, "policy_loss": -0.0031948875725269317, "vf_loss": 6.102001778453588, "vf_loss_unclipped": 2232.9319880530297, "vf_explained_var": 0.013328887677192688, "entropy": 5.804039194869995, "mean_kl_loss": 0.009022774340010802, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.1226105380242, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 15531.924, "sample_time_ms": 6544.931, "synch_weights_time_ms": 2.25}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "2bb19_00000", "date": "2023-09-20_11-08-58", "timestamp": 1695200938, "time_this_iter_s": 14.920550346374512, "time_total_s": 62.13420081138611, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E7250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 62.13420081138611, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 3.1428571428571423, "ram_util_percent": 41.00952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.989201712036133}, "policy_0": {"total_loss": 9.989201712036133, "policy_loss": -0.0027178075198084116, "vf_loss": 9.99077205619812, "vf_loss_unclipped": 8623.175344628906, "vf_explained_var": -0.07290064437389374, "entropy": 6.017341295433044, "mean_kl_loss": 0.0057372274829765955, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.6532756201092, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 15436.983, "sample_time_ms": 6515.126, "synch_weights_time_ms": 2.2}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "2bb19_00000", "date": "2023-09-20_11-09-13", "timestamp": 1695200953, "time_this_iter_s": 15.058220863342285, "time_total_s": 77.1924216747284, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E7B50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 77.1924216747284, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 3.3619047619047615, "ram_util_percent": 41.07142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.990847866821289}, "policy_0": {"total_loss": 9.990847866821289, "policy_loss": -0.0014579302305472084, "vf_loss": 9.991366609191894, "vf_loss_unclipped": 10122.911236621094, "vf_explained_var": -0.007609754061698913, "entropy": 6.008173801612854, "mean_kl_loss": 0.004695947574733873, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.04010328062355, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 15351.343, "sample_time_ms": 6481.788, "synch_weights_time_ms": 2.167}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "2bb19_00000", "date": "2023-09-20_11-09-28", "timestamp": 1695200968, "time_this_iter_s": 14.924139738082886, "time_total_s": 92.11656141281128, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164305E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 92.11656141281128, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 3.3095238095238093, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.99593761997223}, "policy_0": {"total_loss": 9.99593761997223, "policy_loss": -0.0022258092299103738, "vf_loss": 9.99743180847168, "vf_loss_unclipped": 61102.03286074219, "vf_explained_var": -0.0025357696056365966, "entropy": 5.94418130607605, "mean_kl_loss": 0.007316262124071363, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.6201202681194, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 15325.915, "sample_time_ms": 6466.576, "synch_weights_time_ms": 2.143}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "2bb19_00000", "date": "2023-09-20_11-09-43", "timestamp": 1695200983, "time_this_iter_s": 15.175347805023193, "time_total_s": 107.29190921783447, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164312D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 107.29190921783447, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 2.463636363636364, "ram_util_percent": 41.05909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.995203806877136}, "policy_0": {"total_loss": 9.995203806877136, "policy_loss": -0.0011348006825894117, "vf_loss": 9.995568212890625, "vf_loss_unclipped": 80636.62310078125, "vf_explained_var": -0.026931660437583924, "entropy": 5.9081449199676515, "mean_kl_loss": 0.007703945679567551, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.8568782351717, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 15290.887, "sample_time_ms": 6448.306, "synch_weights_time_ms": 2.25}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "2bb19_00000", "date": "2023-09-20_11-09-58", "timestamp": 1695200998, "time_this_iter_s": 15.047688722610474, "time_total_s": 122.33959794044495, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316431E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 122.33959794044495, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 2.980952380952381, "ram_util_percent": 41.042857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.993788115119933}, "policy_0": {"total_loss": 9.993788115119933, "policy_loss": -0.0005108835637569428, "vf_loss": 9.993640866088867, "vf_loss_unclipped": 77870.73439140625, "vf_explained_var": -0.04578217778205872, "entropy": 5.880209666442871, "mean_kl_loss": 0.006581347597028434, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.04739930186173, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 15281.498, "sample_time_ms": 6445.141, "synch_weights_time_ms": 2.333}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "2bb19_00000", "date": "2023-09-20_11-10-13", "timestamp": 1695201013, "time_this_iter_s": 15.208385944366455, "time_total_s": 137.5479838848114, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E7490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 137.5479838848114, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 2.4476190476190474, "ram_util_percent": 41.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.99197130355835}, "policy_0": {"total_loss": 9.99197130355835, "policy_loss": -0.0018075771614909173, "vf_loss": 9.99294585723877, "vf_loss_unclipped": 75478.827421875, "vf_explained_var": -0.026861242818832398, "entropy": 5.815769941520691, "mean_kl_loss": 0.008330372642859584, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.8054037986996, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 15281.2, "sample_time_ms": 6454.88, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "2bb19_00000", "date": "2023-09-20_11-10-28", "timestamp": 1695201028, "time_this_iter_s": 15.279523372650146, "time_total_s": 152.82750725746155, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316431630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 152.82750725746155, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 1.8318181818181822, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.992208090782166}, "policy_0": {"total_loss": 9.992208090782166, "policy_loss": -0.0011464220508933067, "vf_loss": 9.992592185211182, "vf_loss_unclipped": 73511.68072265625, "vf_explained_var": -0.052638985133171085, "entropy": 5.80674012966156, "mean_kl_loss": 0.0076235275633320275, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.06748506454227, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 15212.095, "sample_time_ms": 6423.45, "synch_weights_time_ms": 2.3}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "2bb19_00000", "date": "2023-09-20_11-10-43", "timestamp": 1695201043, "time_this_iter_s": 14.978487968444824, "time_total_s": 167.80599522590637, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316430E50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 167.80599522590637, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 2.595238095238095, "ram_util_percent": 41.05238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.992473678588867}, "policy_0": {"total_loss": 9.992473678588867, "policy_loss": -0.0008982731938362122, "vf_loss": 9.992678527832032, "vf_loss_unclipped": 71182.693903125, "vf_explained_var": -0.019514869856834413, "entropy": 5.699148475837707, "mean_kl_loss": 0.006934256069448566, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 253.8969970835439, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 15122.3, "sample_time_ms": 6398.783, "synch_weights_time_ms": 2.3}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "2bb19_00000", "date": "2023-09-20_11-10-59", "timestamp": 1695201059, "time_this_iter_s": 15.756420373916626, "time_total_s": 183.562415599823, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316432440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 183.562415599823, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 2.963636363636364, "ram_util_percent": 41.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.990309165763856}, "policy_0": {"total_loss": 9.990309165763856, "policy_loss": -0.0034130925627425313, "vf_loss": 9.99271504058838, "vf_loss_unclipped": 69289.21271484374, "vf_explained_var": -0.010959136748313903, "entropy": 5.602147714996338, "mean_kl_loss": 0.010072063143018749, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.4900709226143, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 15140.124, "sample_time_ms": 6405.291, "synch_weights_time_ms": 2.3}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "2bb19_00000", "date": "2023-09-20_11-11-14", "timestamp": 1695201074, "time_this_iter_s": 15.068477153778076, "time_total_s": 198.63089275360107, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316432F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 198.63089275360107, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 2.5142857142857147, "ram_util_percent": 41.14285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.991045988845825}, "policy_0": {"total_loss": 9.991045988845825, "policy_loss": -0.002523769300431013, "vf_loss": 9.992676890563965, "vf_loss_unclipped": 65520.24072734375, "vf_explained_var": 3.815040588378906e-05, "entropy": 5.521707968902588, "mean_kl_loss": 0.008928573444906397, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.63216117599006, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 15154.111, "sample_time_ms": 6417.692, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "2bb19_00000", "date": "2023-09-20_11-11-29", "timestamp": 1695201089, "time_this_iter_s": 15.059417724609375, "time_total_s": 213.69031047821045, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E7370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 213.69031047821045, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 2.5952380952380953, "ram_util_percent": 41.152380952380966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.979861784362793}, "policy_0": {"total_loss": 9.979861784362793, "policy_loss": -0.0021820491310209035, "vf_loss": 9.981281618499755, "vf_loss_unclipped": 52289.52204599609, "vf_explained_var": -0.0009311471462249756, "entropy": 5.437234245109558, "mean_kl_loss": 0.007621976443316271, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.5280382787341, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 15160.516, "sample_time_ms": 6414.394, "synch_weights_time_ms": 2.5}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "2bb19_00000", "date": "2023-09-20_11-11-44", "timestamp": 1695201104, "time_this_iter_s": 15.123270034790039, "time_total_s": 228.8135805130005, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164331C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 228.8135805130005, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 2.4954545454545456, "ram_util_percent": 41.11363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.977757530212402}, "policy_0": {"total_loss": 9.977757530212402, "policy_loss": -0.002155934446118772, "vf_loss": 9.979174403381348, "vf_loss_unclipped": 33699.878609375, "vf_explained_var": 1.206977367401123e-05, "entropy": 5.4175380573272705, "mean_kl_loss": 0.007390620011830834, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.63735606595253, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 15191.215, "sample_time_ms": 6422.006, "synch_weights_time_ms": 2.601}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "2bb19_00000", "date": "2023-09-20_11-12-00", "timestamp": 1695201120, "time_this_iter_s": 15.231125831604004, "time_total_s": 244.0447063446045, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316432290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 244.0447063446045, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 2.895238095238095, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.990714362716675}, "policy_0": {"total_loss": 9.990714362716675, "policy_loss": -0.0017048452019691467, "vf_loss": 9.991809300613403, "vf_loss_unclipped": 49367.93742861328, "vf_explained_var": -1.5242815017700195e-06, "entropy": 5.391482355690003, "mean_kl_loss": 0.00609891296349233, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.23605304949706, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 15199.223, "sample_time_ms": 6436.268, "synch_weights_time_ms": 2.601}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "2bb19_00000", "date": "2023-09-20_11-12-15", "timestamp": 1695201135, "time_this_iter_s": 15.255433082580566, "time_total_s": 259.30013942718506, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316431FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 259.30013942718506, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 4.640909090909091, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.986643433380127}, "policy_0": {"total_loss": 9.986643433380127, "policy_loss": -0.0013200934544205665, "vf_loss": 9.987411985397339, "vf_loss_unclipped": 46147.73062944336, "vf_explained_var": -7.179403305053711e-06, "entropy": 5.4156371730804445, "mean_kl_loss": 0.00551554414289285, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.01172704974994, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 15227.152, "sample_time_ms": 6467.942, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "2bb19_00000", "date": "2023-09-20_11-12-30", "timestamp": 1695201150, "time_this_iter_s": 15.325981378555298, "time_total_s": 274.62612080574036, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316433880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 274.62612080574036, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 4.971428571428571, "ram_util_percent": 41.171428571428564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.357355297645926}, "policy_0": {"total_loss": 9.357355297645926, "policy_loss": -0.005606541672814638, "vf_loss": 9.360057685008645, "vf_loss_unclipped": 791.4128271036298, "vf_explained_var": -0.01646515688896179, "entropy": 5.566388153266907, "mean_kl_loss": 0.029041450195190555, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 258.3431824409093, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 15254.842, "sample_time_ms": 6510.086, "synch_weights_time_ms": 2.401}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 19, "trial_id": "2bb19_00000", "date": "2023-09-20_11-12-46", "timestamp": 1695201166, "time_this_iter_s": 15.486281156539917, "time_total_s": 290.1124019622803, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316448430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 290.1124019622803, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 3.5454545454545454, "ram_util_percent": 41.21818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.960381159576774}, "policy_0": {"total_loss": 7.960381159576774, "policy_loss": -0.0014866022616624832, "vf_loss": 7.960326464125514, "vf_loss_unclipped": 60.56637462391555, "vf_explained_var": -0.006619368982315063, "entropy": 5.489062558174133, "mean_kl_loss": 0.010275380343449068, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.53316069800036, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 15256.432, "sample_time_ms": 6515.251, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 20, "trial_id": "2bb19_00000", "date": "2023-09-20_11-13-01", "timestamp": 1695201181, "time_this_iter_s": 15.296427965164185, "time_total_s": 305.40882992744446, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316430DC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 305.40882992744446, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 3.8818181818181823, "ram_util_percent": 41.21818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.1071227621923665}, "policy_0": {"total_loss": 4.1071227621923665, "policy_loss": -0.004670401260256767, "vf_loss": 4.11007785718739, "vf_loss_unclipped": 7.510336190250516, "vf_explained_var": -0.038678487753868104, "entropy": 5.517901987075805, "mean_kl_loss": 0.011435355677164626, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 259.62525371437914, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15299.366, "sample_time_ms": 6542.738, "synch_weights_time_ms": 2.401}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 21, "trial_id": "2bb19_00000", "date": "2023-09-20_11-13-16", "timestamp": 1695201196, "time_this_iter_s": 15.408820867538452, "time_total_s": 320.8176507949829, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316432EF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 320.8176507949829, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 3.6333333333333333, "ram_util_percent": 41.35238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.625576701903366}, "policy_0": {"total_loss": 7.625576701903366, "policy_loss": -0.006666141275735572, "vf_loss": 7.629381001034379, "vf_loss_unclipped": 3975.767787738362, "vf_explained_var": 0.024453432059288027, "entropy": 5.541069044685364, "mean_kl_loss": 0.01907892521583708, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 247.0707392251919, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 15342.893, "sample_time_ms": 6527.998, "synch_weights_time_ms": 2.401}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 22, "trial_id": "2bb19_00000", "date": "2023-09-20_11-13-33", "timestamp": 1695201213, "time_this_iter_s": 16.190694332122803, "time_total_s": 337.0083451271057, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AC280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 337.0083451271057, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 6.291304347826089, "ram_util_percent": 41.53913043478262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.994907080841065}, "policy_0": {"total_loss": 9.994907080841065, "policy_loss": -0.002819656682759523, "vf_loss": 9.996827793884277, "vf_loss_unclipped": 35927.24500537109, "vf_explained_var": 0.0004688839197158813, "entropy": 5.7232163652420045, "mean_kl_loss": 0.005993059000118228, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 248.7424449921475, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 15444.334, "sample_time_ms": 6547.706, "synch_weights_time_ms": 2.401}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 23, "trial_id": "2bb19_00000", "date": "2023-09-20_11-13-49", "timestamp": 1695201229, "time_this_iter_s": 16.083890199661255, "time_total_s": 353.09223532676697, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ACA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 353.09223532676697, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 5.039130434782608, "ram_util_percent": 41.604347826086965}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.991557203865051}, "policy_0": {"total_loss": 9.991557203865051, "policy_loss": -0.002245923487842083, "vf_loss": 9.992832410430909, "vf_loss_unclipped": 43466.60170981445, "vf_explained_var": 9.364898204803467e-05, "entropy": 5.762251514816284, "mean_kl_loss": 0.006471439889276553, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.0121331890592, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 15459.335, "sample_time_ms": 6560.226, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 24, "trial_id": "2bb19_00000", "date": "2023-09-20_11-14-04", "timestamp": 1695201244, "time_this_iter_s": 15.210422992706299, "time_total_s": 368.30265831947327, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AD510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 368.30265831947327, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 2.580952380952381, "ram_util_percent": 41.56666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.988377201461793}, "policy_0": {"total_loss": 9.988377201461793, "policy_loss": -0.0025028991930186747, "vf_loss": 9.98973115119934, "vf_loss_unclipped": 36416.05826860351, "vf_explained_var": -1.2342071533203124e-05, "entropy": 5.7713206022262575, "mean_kl_loss": 0.007659716223490614, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 242.73182916963012, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 15595.117, "sample_time_ms": 6696.631, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 25, "trial_id": "2bb19_00000", "date": "2023-09-20_11-14-20", "timestamp": 1695201260, "time_this_iter_s": 16.480091333389282, "time_total_s": 384.78274965286255, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316432F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 384.78274965286255, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 8.079166666666667, "ram_util_percent": 41.50416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.985150994682312}, "policy_0": {"total_loss": 9.985150994682312, "policy_loss": -0.00417123458236456, "vf_loss": 9.987964673614503, "vf_loss_unclipped": 34977.53951918945, "vf_explained_var": -5.681159496307373e-05, "entropy": 5.716992523574829, "mean_kl_loss": 0.009050489149471468, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.43159358435463, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 104000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 15584.783, "sample_time_ms": 6691.588, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 26, "trial_id": "2bb19_00000", "date": "2023-09-20_11-14-36", "timestamp": 1695201276, "time_this_iter_s": 15.128786087036133, "time_total_s": 399.9115357398987, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316433B50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 399.9115357398987, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 2.3666666666666667, "ram_util_percent": 41.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.987070012664795}, "policy_0": {"total_loss": 9.987070012664795, "policy_loss": -0.0018646990664303302, "vf_loss": 9.98800053062439, "vf_loss_unclipped": 33499.531273999026, "vf_explained_var": -4.1431546211242675e-05, "entropy": 5.664355034828186, "mean_kl_loss": 0.0062279485190952985, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15000000596046448}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.74609685538667, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 108000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 15587.638, "sample_time_ms": 6675.242, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 27, "trial_id": "2bb19_00000", "date": "2023-09-20_11-14-51", "timestamp": 1695201291, "time_this_iter_s": 15.283984661102295, "time_total_s": 415.195520401001, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AD360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 415.195520401001, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 2.5666666666666664, "ram_util_percent": 41.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.986755337905883}, "policy_0": {"total_loss": 9.986755337905883, "policy_loss": -0.0012769237801432609, "vf_loss": 9.987378630828857, "vf_loss_unclipped": 41437.69611582031, "vf_explained_var": -5.94869613647461e-05, "entropy": 5.628426705360413, "mean_kl_loss": 0.004357555472911918, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 260.20049743453706, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 15592.416, "sample_time_ms": 6682.256, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 28, "trial_id": "2bb19_00000", "date": "2023-09-20_11-15-06", "timestamp": 1695201306, "time_this_iter_s": 15.374759912490845, "time_total_s": 430.5702803134918, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AC430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 430.5702803134918, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 3.277272727272728, "ram_util_percent": 41.55909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.986629188728333}, "policy_0": {"total_loss": 9.986629188728333, "policy_loss": -0.0007366177625954152, "vf_loss": 9.986967294692993, "vf_loss_unclipped": 41421.215632421874, "vf_explained_var": 0.0003055075645446777, "entropy": 5.595109265327453, "mean_kl_loss": 0.005313649352053472, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 259.18190317214203, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 116000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 15587.406, "sample_time_ms": 6660.82, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 29, "trial_id": "2bb19_00000", "date": "2023-09-20_11-15-22", "timestamp": 1695201322, "time_this_iter_s": 15.435177087783813, "time_total_s": 446.00545740127563, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ADD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 446.00545740127563, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 3.477272727272727, "ram_util_percent": 41.577272727272735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.967415018844605}, "policy_0": {"total_loss": 9.967415018844605, "policy_loss": -0.0035065472397953273, "vf_loss": 9.970064775085449, "vf_loss_unclipped": 27862.40838178711, "vf_explained_var": -0.014506190252304077, "entropy": 5.490677139472961, "mean_kl_loss": 0.011423756583419162, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.1962142714731, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 120000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 15571.989, "sample_time_ms": 6645.404, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 30, "trial_id": "2bb19_00000", "date": "2023-09-20_11-15-37", "timestamp": 1695201337, "time_this_iter_s": 15.14226222038269, "time_total_s": 461.1477196216583, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164312D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 461.1477196216583, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 2.742857142857143, "ram_util_percent": 41.57142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.931268011283874}, "policy_0": {"total_loss": 9.931268011283874, "policy_loss": -0.0020601796768605707, "vf_loss": 9.932759321594238, "vf_loss_unclipped": 16534.582422833253, "vf_explained_var": -0.07615129325389862, "entropy": 5.449873064613342, "mean_kl_loss": 0.007585018678028792, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.3696552337848, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 124000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 15538.638, "sample_time_ms": 6622.705, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 31, "trial_id": "2bb19_00000", "date": "2023-09-20_11-15-52", "timestamp": 1695201352, "time_this_iter_s": 15.07631254196167, "time_total_s": 476.22403216362, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E6170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 476.22403216362, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 2.6545454545454548, "ram_util_percent": 41.50909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.79651534099579}, "policy_0": {"total_loss": 9.79651534099579, "policy_loss": -0.002139448379725218, "vf_loss": 9.798087048912048, "vf_loss_unclipped": 5754.503397238922, "vf_explained_var": -0.16583637502193452, "entropy": 5.362762009620666, "mean_kl_loss": 0.007569820681206329, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.47754951181884, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 128000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 15420.733, "sample_time_ms": 6588.735, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 32, "trial_id": "2bb19_00000", "date": "2023-09-20_11-16-07", "timestamp": 1695201367, "time_this_iter_s": 15.01264476776123, "time_total_s": 491.2366769313812, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ADFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 491.2366769313812, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 2.8761904761904766, "ram_util_percent": 41.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.669565506070851}, "policy_0": {"total_loss": 9.669565506070851, "policy_loss": -0.0012982208505272865, "vf_loss": 9.670118134124204, "vf_loss_unclipped": 2294.557611223514, "vf_explained_var": -0.084691708278656, "entropy": 5.2957322923660275, "mean_kl_loss": 0.009941074973880132, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.7296655375051, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 132000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 15301.129, "sample_time_ms": 6568.986, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 33, "trial_id": "2bb19_00000", "date": "2023-09-20_11-16-22", "timestamp": 1695201382, "time_this_iter_s": 14.88684606552124, "time_total_s": 506.12352299690247, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ACF70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 506.12352299690247, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 3.0857142857142854, "ram_util_percent": 41.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.67172870952785}, "policy_0": {"total_loss": 9.67172870952785, "policy_loss": -0.0029916497506201267, "vf_loss": 9.67354026196599, "vf_loss_unclipped": 722.8357324613869, "vf_explained_var": -0.02171853995323181, "entropy": 5.297964218521118, "mean_kl_loss": 0.015734510772089563, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.5314051935368, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 136000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 15264.344, "sample_time_ms": 6541.39, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 34, "trial_id": "2bb19_00000", "date": "2023-09-20_11-16-37", "timestamp": 1695201397, "time_this_iter_s": 14.84257435798645, "time_total_s": 520.9660973548889, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AE170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 520.9660973548889, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 3.4809523809523806, "ram_util_percent": 41.54761904761905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.591893437992036}, "policy_0": {"total_loss": 9.591893437992036, "policy_loss": -0.0035525363637134433, "vf_loss": 9.594459965524823, "vf_loss_unclipped": 598.6893097654439, "vf_explained_var": -0.04286638815402984, "entropy": 5.062771761703491, "mean_kl_loss": 0.013146758809882772, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.89955528680525, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 140000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 15098.468, "sample_time_ms": 6391.924, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 35, "trial_id": "2bb19_00000", "date": "2023-09-20_11-16-52", "timestamp": 1695201412, "time_this_iter_s": 14.822328567504883, "time_total_s": 535.7884259223938, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AE9E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 535.7884259223938, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 3.614285714285714, "ram_util_percent": 41.61428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.771241343229264}, "policy_0": {"total_loss": 8.771241343229264, "policy_loss": -0.002561896387115121, "vf_loss": 8.77327313099131, "vf_loss_unclipped": 395.5425289174102, "vf_explained_var": -0.06698779006004334, "entropy": 4.7917987224578855, "mean_kl_loss": 0.00706811274488573, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}}, "episode_reward_max": -265537.08436641085, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -282768.0568099861, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -63732.11628323525}, "policy_reward_mean": {"policy_0": -70692.01420249637}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8485710139977412, "mean_inference_ms": 0.8147950329399997, "mean_action_processing_ms": 0.2533801840887594, "mean_env_wait_ms": 1.2626945525419555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4999995231628418}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.62099359475985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 144000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 15074.876, "sample_time_ms": 6387.952, "synch_weights_time_ms": 2.142}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 36, "trial_id": "2bb19_00000", "date": "2023-09-20_11-17-07", "timestamp": 1695201427, "time_this_iter_s": 14.895922899246216, "time_total_s": 550.68434882164, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316430790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 550.68434882164, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 3.490476190476191, "ram_util_percent": 41.709523809523816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.748903379335534}, "policy_0": {"total_loss": 7.748903379335534, "policy_loss": -0.007014891401305795, "vf_loss": 7.7529312314283105, "vf_loss_unclipped": 102.40602167770975, "vf_explained_var": -0.052764376831054685, "entropy": 4.987336258506775, "mean_kl_loss": 0.039827233892513324, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.43797856893775, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 148000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 15076.677, "sample_time_ms": 6409.515, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 37, "trial_id": "2bb19_00000", "date": "2023-09-20_11-17-22", "timestamp": 1695201442, "time_this_iter_s": 15.302995443344116, "time_total_s": 565.9873442649841, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ACF70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 565.9873442649841, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 3.595238095238096, "ram_util_percent": 41.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.327693995243311}, "policy_0": {"total_loss": 5.327693995243311, "policy_loss": -0.0053864163102582095, "vf_loss": 5.33073131615445, "vf_loss_unclipped": 18.53651932970807, "vf_explained_var": -0.0014523234844207764, "entropy": 4.962252946853638, "mean_kl_loss": 0.020880823928679456, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.8766524449206, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 152000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 15032.625, "sample_time_ms": 6362.083, "synch_weights_time_ms": 2.041}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 38, "trial_id": "2bb19_00000", "date": "2023-09-20_11-17-37", "timestamp": 1695201457, "time_this_iter_s": 14.933245658874512, "time_total_s": 580.9205899238586, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ACB80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 580.9205899238586, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 3.3761904761904766, "ram_util_percent": 41.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.147606019059615}, "policy_0": {"total_loss": 4.147606019059615, "policy_loss": -0.0024413733523339035, "vf_loss": 4.149119792057574, "vf_loss_unclipped": 55.188837188078466, "vf_explained_var": 0.016367712640762328, "entropy": 4.929175496482849, "mean_kl_loss": 0.005496800670852826, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.3931754731711, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 156000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 14996.506, "sample_time_ms": 6325.805, "synch_weights_time_ms": 2.041}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 39, "trial_id": "2bb19_00000", "date": "2023-09-20_11-17-52", "timestamp": 1695201472, "time_this_iter_s": 15.07497763633728, "time_total_s": 595.9955675601959, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163A8C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 595.9955675601959, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 3.3142857142857145, "ram_util_percent": 41.46666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.709223068236222}, "policy_0": {"total_loss": 2.709223068236222, "policy_loss": -0.003828835763409734, "vf_loss": 2.711816235529259, "vf_loss_unclipped": 58.05538259810098, "vf_explained_var": 0.014330318140983582, "entropy": 4.815224716758728, "mean_kl_loss": 0.007322489429503912, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.11699802690714, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 160000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 14968.822, "sample_time_ms": 6303.772, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 40, "trial_id": "2bb19_00000", "date": "2023-09-20_11-18-07", "timestamp": 1695201487, "time_this_iter_s": 14.865424156188965, "time_total_s": 610.8609917163849, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316431EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 610.8609917163849, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 4.128571428571429, "ram_util_percent": 41.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.8767197351509706}, "policy_0": {"total_loss": 1.8767197351509706, "policy_loss": -0.005662352307885885, "vf_loss": 1.880520265159011, "vf_loss_unclipped": 2.0308601043313743, "vf_explained_var": 0.03828423345088959, "entropy": 4.702708097267151, "mean_kl_loss": 0.011033014463742438, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 268.35036102711683, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 164000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 14952.079, "sample_time_ms": 6292.288, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 41, "trial_id": "2bb19_00000", "date": "2023-09-20_11-18-22", "timestamp": 1695201502, "time_this_iter_s": 14.906885623931885, "time_total_s": 625.7678773403168, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AC4C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 625.7678773403168, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 5.223809523809525, "ram_util_percent": 41.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.653645653589442}, "policy_0": {"total_loss": 2.653645653589442, "policy_loss": -0.00400881374925375, "vf_loss": 2.6558634358763693, "vf_loss_unclipped": 3.5354531551718713, "vf_explained_var": 0.017157486438751222, "entropy": 4.621753805923462, "mean_kl_loss": 0.010613524777823477, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.67339634986524, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 168000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 14956.623, "sample_time_ms": 6289.636, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 42, "trial_id": "2bb19_00000", "date": "2023-09-20_11-18-37", "timestamp": 1695201517, "time_this_iter_s": 15.057080268859863, "time_total_s": 640.8249576091766, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AE320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 640.8249576091766, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 3.9590909090909094, "ram_util_percent": 41.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.417958844092558}, "policy_0": {"total_loss": 4.417958844092558, "policy_loss": -0.0037377410143613816, "vf_loss": 4.420322018416785, "vf_loss_unclipped": 276.336540053924, "vf_explained_var": -0.07888086280822754, "entropy": 4.636238283538819, "mean_kl_loss": 0.008145594252741103, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 259.6987415740244, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 172000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 15008.384, "sample_time_ms": 6302.208, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 43, "trial_id": "2bb19_00000", "date": "2023-09-20_11-18-52", "timestamp": 1695201532, "time_this_iter_s": 15.404461860656738, "time_total_s": 656.2294194698334, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164323B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 656.2294194698334, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 2.9238095238095236, "ram_util_percent": 41.14285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.0634538705799725}, "policy_0": {"total_loss": 4.0634538705799725, "policy_loss": -0.003376673048734665, "vf_loss": 4.065661343041435, "vf_loss_unclipped": 330.9838074133787, "vf_explained_var": -0.11685890891551971, "entropy": 4.512160212039947, "mean_kl_loss": 0.006928580622796107, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.3849932994545, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 176000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 15037.272, "sample_time_ms": 6317.381, "synch_weights_time_ms": 2.141}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 44, "trial_id": "2bb19_00000", "date": "2023-09-20_11-19-07", "timestamp": 1695201547, "time_this_iter_s": 15.130451202392578, "time_total_s": 671.359870672226, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AD510>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 671.359870672226, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 2.836363636363636, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.0417213916344568}, "policy_0": {"total_loss": 2.0417213916344568, "policy_loss": -0.0032139965899754316, "vf_loss": 2.0436867584516296, "vf_loss_unclipped": 2.1183540427495724, "vf_explained_var": 0.019786393427848815, "entropy": 4.452216130065918, "mean_kl_loss": 0.0073993600142996, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.1880061072911, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 180000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 15063.603, "sample_time_ms": 6325.974, "synch_weights_time_ms": 2.241}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 45, "trial_id": "2bb19_00000", "date": "2023-09-20_11-19-22", "timestamp": 1695201562, "time_this_iter_s": 15.08563780784607, "time_total_s": 686.445508480072, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AE200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 686.445508480072, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 3.395238095238095, "ram_util_percent": 41.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.403514840088645}, "policy_0": {"total_loss": 1.403514840088645, "policy_loss": -0.007935682404786348, "vf_loss": 1.4093864988692104, "vf_loss_unclipped": 1.4807869532950222, "vf_explained_var": 0.02999158923625946, "entropy": 4.421961342048645, "mean_kl_loss": 0.0122312533478369, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.86722463154837, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 184000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 15073.389, "sample_time_ms": 6323.051, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 46, "trial_id": "2bb19_00000", "date": "2023-09-20_11-19-37", "timestamp": 1695201577, "time_this_iter_s": 14.989726781845093, "time_total_s": 701.4352352619171, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AECB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 701.4352352619171, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 3.2380952380952372, "ram_util_percent": 41.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.9532609607272083}, "policy_0": {"total_loss": 0.9532609607272083, "policy_loss": -0.004968830160982907, "vf_loss": 0.9566295351549983, "vf_loss_unclipped": 0.9959642759844661, "vf_explained_var": 0.009460849094390869, "entropy": 4.480375704956055, "mean_kl_loss": 0.009483014793463371, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.31727914963193, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 188000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 15045.357, "sample_time_ms": 6289.099, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 47, "trial_id": "2bb19_00000", "date": "2023-09-20_11-19-52", "timestamp": 1695201592, "time_this_iter_s": 15.02167820930481, "time_total_s": 716.4569134712219, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AF520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 716.4569134712219, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 2.9285714285714284, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.7985769181618932}, "policy_0": {"total_loss": 0.7985769181618932, "policy_loss": -0.007749694598373025, "vf_loss": 0.8040305485211313, "vf_loss_unclipped": 0.80455052799806, "vf_explained_var": 0.051121524071693424, "entropy": 4.437474837684631, "mean_kl_loss": 0.01360628538322726, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 257.9762803266995, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 192000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 15102.663, "sample_time_ms": 6303.035, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 48, "trial_id": "2bb19_00000", "date": "2023-09-20_11-20-08", "timestamp": 1695201608, "time_this_iter_s": 15.507301092147827, "time_total_s": 731.9642145633698, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316432F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 731.9642145633698, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 2.3000000000000003, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.6468742136582266}, "policy_0": {"total_loss": 0.6468742136582266, "policy_loss": -0.006008836749941111, "vf_loss": 0.6511450210992247, "vf_loss_unclipped": 0.6511450210992247, "vf_explained_var": -0.025772866868972778, "entropy": 4.421990501403808, "mean_kl_loss": 0.01029940320579699, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.7571067584026, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 196000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 15117.783, "sample_time_ms": 6302.233, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 49, "trial_id": "2bb19_00000", "date": "2023-09-20_11-20-23", "timestamp": 1695201623, "time_this_iter_s": 15.224188804626465, "time_total_s": 747.1884033679962, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AF370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 747.1884033679962, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 2.8190476190476184, "ram_util_percent": 41.1857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.47704214609887}, "policy_0": {"total_loss": 2.47704214609887, "policy_loss": -0.012601814737915993, "vf_loss": 2.486818849617336, "vf_loss_unclipped": 201.2646484514297, "vf_explained_var": -0.02200113515853882, "entropy": 4.5886180170059205, "mean_kl_loss": 0.01674140349831523, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.26150238563105, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 15139.387, "sample_time_ms": 6315.052, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 50, "trial_id": "2bb19_00000", "date": "2023-09-20_11-20-38", "timestamp": 1695201638, "time_this_iter_s": 15.081459760665894, "time_total_s": 762.2698631286621, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ACB80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 762.2698631286621, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 2.7363636363636363, "ram_util_percent": 41.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.708782339727879}, "policy_0": {"total_loss": 4.708782339727879, "policy_loss": -0.0027837857261300085, "vf_loss": 4.710529389747442, "vf_loss_unclipped": 487.1069385373676, "vf_explained_var": -0.023136927819252015, "entropy": 4.8400679878234865, "mean_kl_loss": 0.006143685031516998, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.70653707745186, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 204000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 15177.228, "sample_time_ms": 6333.554, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 51, "trial_id": "2bb19_00000", "date": "2023-09-20_11-20-54", "timestamp": 1695201654, "time_this_iter_s": 15.28629469871521, "time_total_s": 777.5561578273773, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ADAB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 777.5561578273773, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 2.7571428571428576, "ram_util_percent": 41.16190476190478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.837753135440685}, "policy_0": {"total_loss": 4.837753135440685, "policy_loss": -0.004707782382145524, "vf_loss": 4.840687016514689, "vf_loss_unclipped": 499.04809181692974, "vf_explained_var": -0.19906935303211212, "entropy": 4.708565581130982, "mean_kl_loss": 0.010512101594375598, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.7623249127944, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 208000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 15193.908, "sample_time_ms": 6330.956, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 52, "trial_id": "2bb19_00000", "date": "2023-09-20_11-21-09", "timestamp": 1695201669, "time_this_iter_s": 15.223882675170898, "time_total_s": 792.7800405025482, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AFD90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 792.7800405025482, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 3.209090909090909, "ram_util_percent": 41.177272727272744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.967654364337912}, "policy_0": {"total_loss": 3.967654364337912, "policy_loss": -0.0045068879932165145, "vf_loss": 3.970797216925747, "vf_loss_unclipped": 261.7287013286926, "vf_explained_var": -0.19816339945793152, "entropy": 4.570752516651154, "mean_kl_loss": 0.008083196707837487, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.86820521409254, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 212000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 15152.529, "sample_time_ms": 6312.616, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 53, "trial_id": "2bb19_00000", "date": "2023-09-20_11-21-24", "timestamp": 1695201684, "time_this_iter_s": 14.99067234992981, "time_total_s": 807.770712852478, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AE320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 807.770712852478, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 3.304761904761905, "ram_util_percent": 41.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.1655282960538986}, "policy_0": {"total_loss": 1.1655282960538986, "policy_loss": -0.005081024709530175, "vf_loss": 1.169678061197838, "vf_loss_unclipped": 34.345484974478325, "vf_explained_var": -0.04056753604412079, "entropy": 4.513026056480408, "mean_kl_loss": 0.005518582787177002, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}}, "episode_reward_max": -171973.9260044769, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -236385.15979031665, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": -22038.525112171974}, "policy_reward_mean": {"policy_0": -59096.28994757911}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8523264308334941, "mean_inference_ms": 0.8150779057212985, "mean_action_processing_ms": 0.2537130341465473, "mean_env_wait_ms": 1.2600328500666027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.02499222755432129, "ViewRequirementAgentConnector_ms": 0.4999816417694092}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 260.8950059239836, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 216000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 15172.768, "sample_time_ms": 6325.426, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 54, "trial_id": "2bb19_00000", "date": "2023-09-20_11-21-39", "timestamp": 1695201699, "time_this_iter_s": 15.332836866378784, "time_total_s": 823.1035497188568, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AEE60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 823.1035497188568, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 2.877272727272727, "ram_util_percent": 41.10454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.9779842051090673}, "policy_0": {"total_loss": 3.9779842051090673, "policy_loss": -0.00604902924336493, "vf_loss": 3.9815601097948847, "vf_loss_unclipped": 6.0495506152518095, "vf_explained_var": -0.07265745294094085, "entropy": 4.8006766340255735, "mean_kl_loss": 0.014655556706747666, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 257.87067594739125, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 220000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 15215.569, "sample_time_ms": 6355.238, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 55, "trial_id": "2bb19_00000", "date": "2023-09-20_11-21-55", "timestamp": 1695201715, "time_this_iter_s": 15.513651132583618, "time_total_s": 838.6172008514404, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017315FE04C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 838.6172008514404, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 2.576190476190476, "ram_util_percent": 41.01904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.987207127591036}, "policy_0": {"total_loss": 2.987207127591036, "policy_loss": -0.006143513213098049, "vf_loss": 2.991563231546432, "vf_loss_unclipped": 3.4756233054943384, "vf_explained_var": 0.007333348321914673, "entropy": 4.826243468093872, "mean_kl_loss": 0.01059208158362053, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.2575924373851, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 224000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 15219.001, "sample_time_ms": 6355.586, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 56, "trial_id": "2bb19_00000", "date": "2023-09-20_11-22-10", "timestamp": 1695201730, "time_this_iter_s": 15.024044752120972, "time_total_s": 853.6412456035614, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316430820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 853.6412456035614, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 3.066666666666667, "ram_util_percent": 41.00476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.70035966299437}, "policy_0": {"total_loss": 3.70035966299437, "policy_loss": -0.004738890354335308, "vf_loss": 3.7038859290689228, "vf_loss_unclipped": 181.48517596598566, "vf_explained_var": -0.10860126645565032, "entropy": 4.810496488380432, "mean_kl_loss": 0.007185998613936863, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.5737742609113, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 228000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 15211.948, "sample_time_ms": 6356.779, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 57, "trial_id": "2bb19_00000", "date": "2023-09-20_11-22-25", "timestamp": 1695201745, "time_this_iter_s": 14.95114803314209, "time_total_s": 868.5923936367035, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650C670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 868.5923936367035, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 3.0681818181818183, "ram_util_percent": 41.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.413436677311267}, "policy_0": {"total_loss": 5.413436677311267, "policy_loss": -0.0035577621555887163, "vf_loss": 5.415919859156013, "vf_loss_unclipped": 564.4631428979247, "vf_explained_var": -0.3058843398332596, "entropy": 4.792817413330078, "mean_kl_loss": 0.00636786720197922, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.09836465230455, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 232000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 15181.762, "sample_time_ms": 6344.155, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 58, "trial_id": "2bb19_00000", "date": "2023-09-20_11-22-40", "timestamp": 1695201760, "time_this_iter_s": 15.205439805984497, "time_total_s": 883.797833442688, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E7BE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 883.797833442688, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 3.1571428571428575, "ram_util_percent": 41.0952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.361048804321117}, "policy_0": {"total_loss": 7.361048804321117, "policy_loss": -0.0032475742558948696, "vf_loss": 7.362961185327918, "vf_loss_unclipped": 2910.685283601246, "vf_explained_var": -0.1231701420545578, "entropy": 4.922075463867188, "mean_kl_loss": 0.007912176353741415, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.1634000916068, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 236000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 15185.209, "sample_time_ms": 6350.839, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 59, "trial_id": "2bb19_00000", "date": "2023-09-20_11-22-55", "timestamp": 1695201775, "time_this_iter_s": 15.258659362792969, "time_total_s": 899.056492805481, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AFD90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 899.056492805481, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 2.727272727272727, "ram_util_percent": 41.07272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.3724691611400806}, "policy_0": {"total_loss": 6.3724691611400806, "policy_loss": -0.006948147147148848, "vf_loss": 6.377246374296025, "vf_loss_unclipped": 4480.079129467557, "vf_explained_var": -0.006708283090591431, "entropy": 4.946847597885132, "mean_kl_loss": 0.01286481736628466, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.4539662436836, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 240000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 15184.116, "sample_time_ms": 6348.057, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 60, "trial_id": "2bb19_00000", "date": "2023-09-20_11-23-10", "timestamp": 1695201790, "time_this_iter_s": 15.070525646209717, "time_total_s": 914.1270184516907, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AD1B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 914.1270184516907, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 3.338095238095238, "ram_util_percent": 41.0904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.529027062236145}, "policy_0": {"total_loss": 6.529027062236145, "policy_loss": -0.0033738951951265334, "vf_loss": 6.530745097606257, "vf_loss_unclipped": 6921.091488993327, "vf_explained_var": 0.011419599080085755, "entropy": 4.998886479759216, "mean_kl_loss": 0.00981251816602162, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.8886279309797, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 244000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 15177.243, "sample_time_ms": 6352.291, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 61, "trial_id": "2bb19_00000", "date": "2023-09-20_11-23-26", "timestamp": 1695201806, "time_this_iter_s": 15.217567682266235, "time_total_s": 929.3445861339569, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650C820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 929.3445861339569, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 3.538095238095238, "ram_util_percent": 40.94761904761904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.534505247102678}, "policy_0": {"total_loss": 6.534505247102678, "policy_loss": -0.0026533249959349633, "vf_loss": 6.535952196616307, "vf_loss_unclipped": 6847.585478507155, "vf_explained_var": 0.042843572664260865, "entropy": 5.025413932228088, "mean_kl_loss": 0.007148865181328802, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.7094899268268, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 248000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 15166.045, "sample_time_ms": 6360.776, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 62, "trial_id": "2bb19_00000", "date": "2023-09-20_11-23-41", "timestamp": 1695201821, "time_this_iter_s": 15.112905025482178, "time_total_s": 944.4574911594391, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650CCA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 944.4574911594391, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 3.5045454545454544, "ram_util_percent": 40.90454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.586977903720737}, "policy_0": {"total_loss": 8.586977903720737, "policy_loss": -0.003386112108826637, "vf_loss": 8.589206471166015, "vf_loss_unclipped": 6695.019137801084, "vf_explained_var": 0.03627627124786377, "entropy": 5.125354281425476, "mean_kl_loss": 0.006859663883345638, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 263.3015889795995, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 252000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 15186.349, "sample_time_ms": 6375.956, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 63, "trial_id": "2bb19_00000", "date": "2023-09-20_11-23-56", "timestamp": 1695201836, "time_this_iter_s": 15.193704843521118, "time_total_s": 959.6511960029602, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650D750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 959.6511960029602, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 3.5238095238095237, "ram_util_percent": 40.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.86649680441767}, "policy_0": {"total_loss": 8.86649680441767, "policy_loss": -0.004943080259859562, "vf_loss": 8.869913325335085, "vf_loss_unclipped": 3626.0221339002865, "vf_explained_var": 0.027805941557884215, "entropy": 5.1715080940246585, "mean_kl_loss": 0.009046349731973897, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.9242265988363, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 256000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 15163.031, "sample_time_ms": 6363.607, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 64, "trial_id": "2bb19_00000", "date": "2023-09-20_11-24-11", "timestamp": 1695201851, "time_this_iter_s": 15.09965705871582, "time_total_s": 974.750853061676, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AEC20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 974.750853061676, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 5.228571428571429, "ram_util_percent": 40.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.866263223481178}, "policy_0": {"total_loss": 8.866263223481178, "policy_loss": -0.0028772029630839825, "vf_loss": 8.86786952686198, "vf_loss_unclipped": 3086.7213735046375, "vf_explained_var": 0.03048581619262695, "entropy": 5.168914698600769, "mean_kl_loss": 0.007531269006948935, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.75862378923057, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 260000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 15122.676, "sample_time_ms": 6343.17, "synch_weights_time_ms": 2.5}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 65, "trial_id": "2bb19_00000", "date": "2023-09-20_11-24-26", "timestamp": 1695201866, "time_this_iter_s": 15.110100746154785, "time_total_s": 989.8609538078308, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E6D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 989.8609538078308, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 5.652380952380952, "ram_util_percent": 40.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.422410331300647}, "policy_0": {"total_loss": 8.422410331300647, "policy_loss": -0.0020854781985282897, "vf_loss": 8.423517328959704, "vf_loss_unclipped": 3779.9374107889475, "vf_explained_var": 0.00893422417640686, "entropy": 5.1083608261108395, "mean_kl_loss": 0.005798536652037978, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.20770158762895, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 264000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 15134.331, "sample_time_ms": 6356.56, "synch_weights_time_ms": 2.5}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 66, "trial_id": "2bb19_00000", "date": "2023-09-20_11-24-41", "timestamp": 1695201881, "time_this_iter_s": 15.141603469848633, "time_total_s": 1005.0025572776794, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650D5A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1005.0025572776794, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 3.736363636363636, "ram_util_percent": 40.93636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.131083558814879}, "policy_0": {"total_loss": 7.131083558814879, "policy_loss": -0.0019024691969156265, "vf_loss": 7.13212976129204, "vf_loss_unclipped": 6375.380468752266, "vf_explained_var": 0.03610855383872986, "entropy": 4.942932117652893, "mean_kl_loss": 0.005074207300151284, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.15299080724157, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 268000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 15153.691, "sample_time_ms": 6370.696, "synch_weights_time_ms": 2.6}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 67, "trial_id": "2bb19_00000", "date": "2023-09-20_11-24-56", "timestamp": 1695201896, "time_this_iter_s": 15.144739866256714, "time_total_s": 1020.1472971439362, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650CEE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1020.1472971439362, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 3.6809523809523816, "ram_util_percent": 40.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.581498230107687}, "policy_0": {"total_loss": 7.581498230107687, "policy_loss": -0.003719025431573391, "vf_loss": 7.584019135928154, "vf_loss_unclipped": 4117.420329946684, "vf_explained_var": 0.008069323396682739, "entropy": 4.987317235565185, "mean_kl_loss": 0.0070999802562691, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16875000298023224}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.34068993227675, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 272000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 15158.082, "sample_time_ms": 6394.66, "synch_weights_time_ms": 2.6}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 68, "trial_id": "2bb19_00000", "date": "2023-09-20_11-25-12", "timestamp": 1695201912, "time_this_iter_s": 15.248348712921143, "time_total_s": 1035.3956458568573, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650D900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1035.3956458568573, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 3.8863636363636362, "ram_util_percent": 40.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.70009437115267}, "policy_0": {"total_loss": 8.70009437115267, "policy_loss": -0.0019076901823282242, "vf_loss": 8.701237989076972, "vf_loss_unclipped": 5573.312360960516, "vf_explained_var": -0.10781375594139099, "entropy": 4.9705171377182005, "mean_kl_loss": 0.004527835058201163, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.3286383725645, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 276000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 15157.12, "sample_time_ms": 6403.393, "synch_weights_time_ms": 2.3}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 69, "trial_id": "2bb19_00000", "date": "2023-09-20_11-25-27", "timestamp": 1695201927, "time_this_iter_s": 15.250048398971558, "time_total_s": 1050.6456942558289, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1050.6456942558289, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 3.2904761904761903, "ram_util_percent": 40.957142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.834211912738905}, "policy_0": {"total_loss": 8.834211912738905, "policy_loss": -0.003174962245672941, "vf_loss": 8.836652669754624, "vf_loss_unclipped": 5870.051355332223, "vf_explained_var": 0.01993601725101471, "entropy": 5.082141118431092, "mean_kl_loss": 0.008701706477382323, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.41899050026393, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 280000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 15174.548, "sample_time_ms": 6411.031, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 70, "trial_id": "2bb19_00000", "date": "2023-09-20_11-25-42", "timestamp": 1695201942, "time_this_iter_s": 15.244798421859741, "time_total_s": 1065.8904926776886, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AC940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1065.8904926776886, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 3.1545454545454543, "ram_util_percent": 40.96363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.85141622082591}, "policy_0": {"total_loss": 8.85141622082591, "policy_loss": -0.0017634872406721116, "vf_loss": 8.852517877802253, "vf_loss_unclipped": 12348.902523697123, "vf_explained_var": 0.01827146911621094, "entropy": 5.113369049358368, "mean_kl_loss": 0.007843761320569593, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.0034920963625, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 284000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 15168.122, "sample_time_ms": 6421.7, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 71, "trial_id": "2bb19_00000", "date": "2023-09-20_11-25-57", "timestamp": 1695201957, "time_this_iter_s": 15.15231442451477, "time_total_s": 1081.0428071022034, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AD1B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1081.0428071022034, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 3.695238095238094, "ram_util_percent": 40.9095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.841626137722283}, "policy_0": {"total_loss": 8.841626137722283, "policy_loss": -0.00189056984228082, "vf_loss": 8.842949596130103, "vf_loss_unclipped": 18967.431098388588, "vf_explained_var": 0.014457209277153014, "entropy": 5.097923672389984, "mean_kl_loss": 0.00672119327379296, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -160396.65938193473, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -40099.16484548365}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.853500070795273, "mean_inference_ms": 0.8153242159449275, "mean_action_processing_ms": 0.2538481328158894, "mean_env_wait_ms": 1.2545537591548117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.01666148503621419, "ViewRequirementAgentConnector_ms": 0.44992367426554364}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.15959004138705, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 288000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 15143.139, "sample_time_ms": 6431.059, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 72, "trial_id": "2bb19_00000", "date": "2023-09-20_11-26-12", "timestamp": 1695201972, "time_this_iter_s": 14.862071752548218, "time_total_s": 1095.9048788547516, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1095.9048788547516, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 3.2095238095238097, "ram_util_percent": 40.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.84782142544426}, "policy_0": {"total_loss": 6.84782142544426, "policy_loss": -0.0028161635629832746, "vf_loss": 6.849234972566366, "vf_loss_unclipped": 97.97208543855548, "vf_explained_var": -0.031822626090049745, "entropy": 3.7216621019363405, "mean_kl_loss": 0.01662361025737482, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 252.20741028656553, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 292000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 15209.965, "sample_time_ms": 6550.028, "synch_weights_time_ms": 2.401}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 73, "trial_id": "2bb19_00000", "date": "2023-09-20_11-26-28", "timestamp": 1695201988, "time_this_iter_s": 15.861961841583252, "time_total_s": 1111.7668406963348, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650C9D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1111.7668406963348, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 4.0181818181818185, "ram_util_percent": 40.8090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.499860095106111}, "policy_0": {"total_loss": 5.499860095106111, "policy_loss": -0.002990929929167032, "vf_loss": 5.501730696605146, "vf_loss_unclipped": 31.98214703695625, "vf_explained_var": 0.0044555883407592775, "entropy": 3.626079113006592, "mean_kl_loss": 0.013278031961171291, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.8678300754262, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 296000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 15124.256, "sample_time_ms": 6504.688, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 74, "trial_id": "2bb19_00000", "date": "2023-09-20_11-26-42", "timestamp": 1695202002, "time_this_iter_s": 14.24357271194458, "time_total_s": 1126.0104134082794, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1126.0104134082794, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 4.300000000000001, "ram_util_percent": 40.809523809523796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.754167037931643}, "policy_0": {"total_loss": 5.754167037931643, "policy_loss": -0.0009377008438110351, "vf_loss": 5.754241632515937, "vf_loss_unclipped": 341.12379217391685, "vf_explained_var": -0.010334828209877014, "entropy": 3.901759416770935, "mean_kl_loss": 0.010229453244394972, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 280.41368784931336, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 300000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 15039.91, "sample_time_ms": 6460.977, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 75, "trial_id": "2bb19_00000", "date": "2023-09-20_11-26-57", "timestamp": 1695202017, "time_this_iter_s": 14.265638828277588, "time_total_s": 1140.276052236557, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650F1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1140.276052236557, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 4.26, "ram_util_percent": 40.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.82557225033138}, "policy_0": {"total_loss": 5.82557225033138, "policy_loss": -0.0015981604855507612, "vf_loss": 5.825409822573513, "vf_loss_unclipped": 497.172734539523, "vf_explained_var": -0.015718235850334168, "entropy": 4.228780743312836, "mean_kl_loss": 0.02086632723099756, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 279.5520047263126, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 304000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 14956.811, "sample_time_ms": 6420.917, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 76, "trial_id": "2bb19_00000", "date": "2023-09-20_11-27-11", "timestamp": 1695202031, "time_this_iter_s": 14.310607433319092, "time_total_s": 1154.586659669876, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ADBD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1154.586659669876, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 4.72, "ram_util_percent": 40.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.77039268396683}, "policy_0": {"total_loss": 5.77039268396683, "policy_loss": -0.004644622829556465, "vf_loss": 5.773446966196596, "vf_loss_unclipped": 492.40673483007106, "vf_explained_var": 0.029144834780693053, "entropy": 4.255815189933777, "mean_kl_loss": 0.012565709408397198, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 279.1155095273123, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 308000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 14875.635, "sample_time_ms": 6384.711, "synch_weights_time_ms": 2.102}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 77, "trial_id": "2bb19_00000", "date": "2023-09-20_11-27-25", "timestamp": 1695202045, "time_this_iter_s": 14.332984209060669, "time_total_s": 1168.9196438789368, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650EF80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1168.9196438789368, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 4.959999999999999, "ram_util_percent": 40.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.695104205536936}, "policy_0": {"total_loss": 5.695104205536936, "policy_loss": -0.00511906564226374, "vf_loss": 5.695558593311627, "vf_loss_unclipped": 464.5448593333629, "vf_explained_var": 0.045638094186782836, "entropy": 4.335711061668396, "mean_kl_loss": 0.0368565484781604, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18984375894069672}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 279.2170818540874, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 312000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 14783.477, "sample_time_ms": 6339.091, "synch_weights_time_ms": 2.155}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 78, "trial_id": "2bb19_00000", "date": "2023-09-20_11-27-40", "timestamp": 1695202060, "time_this_iter_s": 14.32777714729309, "time_total_s": 1183.2474210262299, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1183.2474210262299, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 4.4, "ram_util_percent": 40.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.544383116738498}, "policy_0": {"total_loss": 5.544383116738498, "policy_loss": -0.0009050441533327103, "vf_loss": 5.543953623151407, "vf_loss_unclipped": 475.8459925793167, "vf_explained_var": 0.052169335031509396, "entropy": 4.353450570201874, "mean_kl_loss": 0.007029678522919676, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18984375894069672}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 276.08472566973995, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 316000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 14707.503, "sample_time_ms": 6303.076, "synch_weights_time_ms": 2.155}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 79, "trial_id": "2bb19_00000", "date": "2023-09-20_11-27-54", "timestamp": 1695202074, "time_this_iter_s": 14.490781545639038, "time_total_s": 1197.738202571869, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164332E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1197.738202571869, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 3.8000000000000007, "ram_util_percent": 40.980952380952374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.770416932557709}, "policy_0": {"total_loss": 5.770416932557709, "policy_loss": -0.0014468376755714417, "vf_loss": 5.770095851548016, "vf_loss_unclipped": 474.8109580503777, "vf_explained_var": 0.053041953325271604, "entropy": 4.400753495979309, "mean_kl_loss": 0.009312556397639855, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18984375894069672}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.57689320760795, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 320000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 14640.01, "sample_time_ms": 6286.299, "synch_weights_time_ms": 2.055}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 80, "trial_id": "2bb19_00000", "date": "2023-09-20_11-28-09", "timestamp": 1695202089, "time_this_iter_s": 14.569867610931396, "time_total_s": 1212.3080701828003, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AEB90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1212.3080701828003, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 2.81, "ram_util_percent": 41.28499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.802634683246911}, "policy_0": {"total_loss": 5.802634683246911, "policy_loss": -0.00039804449677467344, "vf_loss": 5.801744443332217, "vf_loss_unclipped": 609.5584266121974, "vf_explained_var": 0.05946845262050628, "entropy": 4.451469915390015, "mean_kl_loss": 0.006786039750790223, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18984375894069672}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 272.63207498710676, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 324000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 14592.057, "sample_time_ms": 6257.855, "synch_weights_time_ms": 2.055}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 81, "trial_id": "2bb19_00000", "date": "2023-09-20_11-28-24", "timestamp": 1695202104, "time_this_iter_s": 14.673787593841553, "time_total_s": 1226.9818577766418, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E4D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1226.9818577766418, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 2.8380952380952387, "ram_util_percent": 41.29999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.4815904185149815}, "policy_0": {"total_loss": 5.4815904185149815, "policy_loss": -0.0024054497241042553, "vf_loss": 5.481941605177475, "vf_loss_unclipped": 701.1770800150305, "vf_explained_var": 0.0540464910030365, "entropy": 4.521500761795044, "mean_kl_loss": 0.010820749866016558, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18984375894069672}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 249.74700360299738, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 328000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 14707.571, "sample_time_ms": 6285.879, "synch_weights_time_ms": 2.155}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 82, "trial_id": "2bb19_00000", "date": "2023-09-20_11-28-40", "timestamp": 1695202120, "time_this_iter_s": 16.018211603164673, "time_total_s": 1243.0000693798065, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650D000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1243.0000693798065, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 8.663636363636364, "ram_util_percent": 41.46818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.366389859580994}, "policy_0": {"total_loss": 5.366389859580994, "policy_loss": -0.00036091153025627135, "vf_loss": 5.365880457646679, "vf_loss_unclipped": 649.3568416315148, "vf_explained_var": 0.054466028022766115, "entropy": 4.547394068145752, "mean_kl_loss": 0.004584357644906049, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.09492187947034836}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 260.2304522944641, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 332000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 14658.674, "sample_time_ms": 6163.255, "synch_weights_time_ms": 2.155}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 83, "trial_id": "2bb19_00000", "date": "2023-09-20_11-28-55", "timestamp": 1695202135, "time_this_iter_s": 15.372990846633911, "time_total_s": 1258.3730602264404, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164ADBD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1258.3730602264404, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 7.031818181818181, "ram_util_percent": 41.50909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.269175939454604}, "policy_0": {"total_loss": 5.269175939454604, "policy_loss": -0.00556494102999568, "vf_loss": 5.272557548848447, "vf_loss_unclipped": 324.66899335669643, "vf_explained_var": 0.05682560305595398, "entropy": 4.444866383934021, "mean_kl_loss": 0.023001398324321052, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.67767976138845, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 336000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 14728.851, "sample_time_ms": 6194.853, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 84, "trial_id": "2bb19_00000", "date": "2023-09-20_11-29-10", "timestamp": 1695202150, "time_this_iter_s": 14.945344924926758, "time_total_s": 1273.3184051513672, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650EF80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1273.3184051513672, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 3.8190476190476197, "ram_util_percent": 41.49523809523809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.424893774078414}, "policy_0": {"total_loss": 5.424893774078414, "policy_loss": -0.0037974038377404213, "vf_loss": 5.426653369239438, "vf_loss_unclipped": 351.1905000957523, "vf_explained_var": 0.05984611165523529, "entropy": 4.424263743972778, "mean_kl_loss": 0.01431217890942935, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 242.84034054586542, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 340000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 14949.56, "sample_time_ms": 6290.414, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 85, "trial_id": "2bb19_00000", "date": "2023-09-20_11-29-26", "timestamp": 1695202166, "time_this_iter_s": 16.473727703094482, "time_total_s": 1289.7921328544617, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650D5A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1289.7921328544617, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 11.00869565217391, "ram_util_percent": 41.652173913043484}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.153456387598068}, "policy_0": {"total_loss": 5.153456387598068, "policy_loss": -0.003270516836643219, "vf_loss": 5.15499177345084, "vf_loss_unclipped": 346.14226493510057, "vf_explained_var": 0.06006757929325104, "entropy": 4.466238455867767, "mean_kl_loss": 0.01218640288730894, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 254.59906414309944, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 344000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 15089.797, "sample_time_ms": 6415.495, "synch_weights_time_ms": 2.154}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 86, "trial_id": "2bb19_00000", "date": "2023-09-20_11-29-42", "timestamp": 1695202182, "time_this_iter_s": 15.711976528167725, "time_total_s": 1305.5041093826294, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650F7F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1305.5041093826294, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 6.186363636363637, "ram_util_percent": 42.113636363636374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.270068992941128}, "policy_0": {"total_loss": 5.270068992941128, "policy_loss": -0.002567081878334284, "vf_loss": 5.271510300481412, "vf_loss_unclipped": 364.44151116904027, "vf_explained_var": -0.020656975865364073, "entropy": 4.479088723564148, "mean_kl_loss": 0.007906779463239946, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 271.91603784292533, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 348000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 15127.741, "sample_time_ms": 6444.72, "synch_weights_time_ms": 2.15}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 87, "trial_id": "2bb19_00000", "date": "2023-09-20_11-29-57", "timestamp": 1695202197, "time_this_iter_s": 14.712422370910645, "time_total_s": 1320.21653175354, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165580D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1320.21653175354, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 1.9095238095238096, "ram_util_percent": 42.00476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.084346344431024}, "policy_0": {"total_loss": 5.084346344431024, "policy_loss": -0.0018866818191483616, "vf_loss": 5.085282304452918, "vf_loss_unclipped": 234.7940145070782, "vf_explained_var": -0.014757768726348876, "entropy": 3.8368144558906554, "mean_kl_loss": 0.006677178879090389, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.18192863176955, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 352000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 15159.389, "sample_time_ms": 6462.516, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 88, "trial_id": "2bb19_00000", "date": "2023-09-20_11-30-12", "timestamp": 1695202212, "time_this_iter_s": 14.644256353378296, "time_total_s": 1334.8607881069183, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650F400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1334.8607881069183, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 3.2571428571428576, "ram_util_percent": 41.68095238095239}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.729089730672724}, "policy_0": {"total_loss": 5.729089730672724, "policy_loss": -0.003867653100192547, "vf_loss": 5.730711323571159, "vf_loss_unclipped": 369.34238018229, "vf_explained_var": -0.003483537793159485, "entropy": 4.355452158355713, "mean_kl_loss": 0.015774854277166923, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 270.33097788929894, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 356000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 15190.226, "sample_time_ms": 6485.346, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 89, "trial_id": "2bb19_00000", "date": "2023-09-20_11-30-26", "timestamp": 1695202226, "time_this_iter_s": 14.798676252365112, "time_total_s": 1349.6594643592834, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650DAB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1349.6594643592834, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 3.157142857142857, "ram_util_percent": 41.690476190476204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.58045082823881}, "policy_0": {"total_loss": 4.58045082823881, "policy_loss": -0.004023429618543014, "vf_loss": 4.583329229489481, "vf_loss_unclipped": 173.36738760513416, "vf_explained_var": 0.021735784721374513, "entropy": 3.8783698197841643, "mean_kl_loss": 0.008041895159813158, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -150996.34984521585, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -37749.08746130389}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8554226981431106, "mean_inference_ms": 0.8152147208101905, "mean_action_processing_ms": 0.25388380591465864, "mean_env_wait_ms": 1.2513385147130947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.012496113777160645, "ViewRequirementAgentConnector_ms": 0.48749446868896484}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.0634418818166, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 360000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 15242.512, "sample_time_ms": 6534.422, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 90, "trial_id": "2bb19_00000", "date": "2023-09-20_11-30-41", "timestamp": 1695202241, "time_this_iter_s": 15.092727184295654, "time_total_s": 1364.752191543579, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164337F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1364.752191543579, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 4.238095238095237, "ram_util_percent": 41.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.2467515529959465}, "policy_0": {"total_loss": 7.2467515529959465, "policy_loss": -0.0042022047221660615, "vf_loss": 7.248479658907652, "vf_loss_unclipped": 84.93125421029926, "vf_explained_var": -0.005033911371231079, "entropy": 3.031864378166199, "mean_kl_loss": 0.01737640184966731, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.40625044673556, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 364000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 15299.687, "sample_time_ms": 6590.612, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 91, "trial_id": "2bb19_00000", "date": "2023-09-20_11-30-57", "timestamp": 1695202257, "time_this_iter_s": 15.245537757873535, "time_total_s": 1379.9977293014526, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173163E6CB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1379.9977293014526, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 1.3909090909090909, "ram_util_percent": 41.640909090909105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.125419542489387}, "policy_0": {"total_loss": 4.125419542489387, "policy_loss": -0.005089680946990848, "vf_loss": 4.128287489672005, "vf_loss_unclipped": 12.556559645052253, "vf_explained_var": 0.02932240173816681, "entropy": 2.996157312107086, "mean_kl_loss": 0.015604008173136025, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.591468896082, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 368000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 15160.1, "sample_time_ms": 6544.816, "synch_weights_time_ms": 1.997}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 92, "trial_id": "2bb19_00000", "date": "2023-09-20_11-31-11", "timestamp": 1695202271, "time_this_iter_s": 14.62233829498291, "time_total_s": 1394.6200675964355, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316570940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1394.6200675964355, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 1.7, "ram_util_percent": 41.605000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.156406774308044}, "policy_0": {"total_loss": 5.156406774308044, "policy_loss": -0.005647832029312849, "vf_loss": 5.159346054880018, "vf_loss_unclipped": 343.2209921211642, "vf_explained_var": -0.0005343311309814453, "entropy": 3.9957849835395813, "mean_kl_loss": 0.019023005846935122, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.993497016909, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 372000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 15149.757, "sample_time_ms": 6532.442, "synch_weights_time_ms": 1.997}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 93, "trial_id": "2bb19_00000", "date": "2023-09-20_11-31-27", "timestamp": 1695202287, "time_this_iter_s": 15.269554376602173, "time_total_s": 1409.8896219730377, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316431EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1409.8896219730377, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 6.14090909090909, "ram_util_percent": 41.66363636363638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.4561750731706615}, "policy_0": {"total_loss": 7.4561750731706615, "policy_loss": 0.0012852696779184043, "vf_loss": 7.453680526809499, "vf_loss_unclipped": 3511.1327542450713, "vf_explained_var": -0.02034942436218262, "entropy": 5.3708271037578585, "mean_kl_loss": 0.008493119275185744, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.96818430490987, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 376000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 15115.446, "sample_time_ms": 6530.146, "synch_weights_time_ms": 2.097}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 94, "trial_id": "2bb19_00000", "date": "2023-09-20_11-31-41", "timestamp": 1695202301, "time_this_iter_s": 14.601235389709473, "time_total_s": 1424.4908573627472, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E4D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1424.4908573627472, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 1.5500000000000003, "ram_util_percent": 41.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.474715936493873}, "policy_0": {"total_loss": 7.474715936493873, "policy_loss": -0.0011809176094830036, "vf_loss": 7.4750408112984035, "vf_loss_unclipped": 3843.6233095378384, "vf_explained_var": 0.0087923969745636, "entropy": 5.456678698539734, "mean_kl_loss": 0.006012296267245256, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.0890984110634, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 380000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 14927.652, "sample_time_ms": 6460.733, "synch_weights_time_ms": 2.197}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 95, "trial_id": "2bb19_00000", "date": "2023-09-20_11-31-56", "timestamp": 1695202316, "time_this_iter_s": 14.595793962478638, "time_total_s": 1439.0866513252258, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E8C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1439.0866513252258, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 1.5238095238095237, "ram_util_percent": 41.67619047619049}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.4772676536798475}, "policy_0": {"total_loss": 7.4772676536798475, "policy_loss": -0.001148915034532547, "vf_loss": 7.477422737963823, "vf_loss_unclipped": 3817.264607030757, "vf_explained_var": 0.02166110897064209, "entropy": 5.356505313396454, "mean_kl_loss": 0.006979979773033119, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.6601435984299, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 384000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 14879.435, "sample_time_ms": 6367.713, "synch_weights_time_ms": 2.197}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 96, "trial_id": "2bb19_00000", "date": "2023-09-20_11-32-11", "timestamp": 1695202331, "time_this_iter_s": 15.230804920196533, "time_total_s": 1454.3174562454224, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316570790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1454.3174562454224, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 4.080952380952381, "ram_util_percent": 41.66190476190478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.461481112456322}, "policy_0": {"total_loss": 7.461481112456322, "policy_loss": -0.0004468950226902962, "vf_loss": 7.460876372006442, "vf_loss_unclipped": 3580.3957233253986, "vf_explained_var": 0.0189989004611969, "entropy": 5.3501571579933165, "mean_kl_loss": 0.007385963866077509, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 255.71615101437848, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 388000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 14972.627, "sample_time_ms": 6415.146, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 97, "trial_id": "2bb19_00000", "date": "2023-09-20_11-32-27", "timestamp": 1695202347, "time_this_iter_s": 15.643344402313232, "time_total_s": 1469.9608006477356, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316570F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1469.9608006477356, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 7.368181818181818, "ram_util_percent": 41.83636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.458472575449943}, "policy_0": {"total_loss": 7.458472575449943, "policy_loss": -0.001640459982305765, "vf_loss": 7.458876505072904, "vf_loss_unclipped": 3388.638274770911, "vf_explained_var": 0.020271740412712097, "entropy": 5.342866316652298, "mean_kl_loss": 0.008684747074488587, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 244.15636004503702, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 392000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 15146.696, "sample_time_ms": 6582.493, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 98, "trial_id": "2bb19_00000", "date": "2023-09-20_11-32-43", "timestamp": 1695202363, "time_this_iter_s": 16.384944438934326, "time_total_s": 1486.34574508667, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316571A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1486.34574508667, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 9.282608695652176, "ram_util_percent": 41.97826086956521}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.443940901041031}, "policy_0": {"total_loss": 7.443940901041031, "policy_loss": -0.0020354576498270035, "vf_loss": 7.444632239816058, "vf_loss_unclipped": 3114.36838794317, "vf_explained_var": 0.018671599197387697, "entropy": 5.357995616436004, "mean_kl_loss": 0.009440061096793942, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 233.6512650541367, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 396000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 15378.981, "sample_time_ms": 6763.06, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 99, "trial_id": "2bb19_00000", "date": "2023-09-20_11-33-00", "timestamp": 1695202380, "time_this_iter_s": 17.121529817581177, "time_total_s": 1503.467274904251, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650C9D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1503.467274904251, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 11.820833333333333, "ram_util_percent": 42.44166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.459594319987297}, "policy_0": {"total_loss": 7.459594319987297, "policy_loss": 0.0006438766364008188, "vf_loss": 7.45801816834528, "vf_loss_unclipped": 3911.3874606123836, "vf_explained_var": 0.020092401123046874, "entropy": 5.398913791656494, "mean_kl_loss": 0.006547724362806912, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.1572077886819, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 400000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 15334.267, "sample_time_ms": 6717.479, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 100, "trial_id": "2bb19_00000", "date": "2023-09-20_11-33-15", "timestamp": 1695202395, "time_this_iter_s": 14.645583868026733, "time_total_s": 1518.1128587722778, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164332E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1518.1128587722778, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 1.9904761904761903, "ram_util_percent": 42.46190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.39079831366539}, "policy_0": {"total_loss": 7.39079831366539, "policy_loss": -0.0028057559363543986, "vf_loss": 7.392266643776046, "vf_loss_unclipped": 5469.216442337431, "vf_explained_var": 0.020962795233726503, "entropy": 5.411388580942154, "mean_kl_loss": 0.009393195753310284, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.14238281548023224}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.64683447763497, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 404000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 15271.651, "sample_time_ms": 6654.894, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 101, "trial_id": "2bb19_00000", "date": "2023-09-20_11-33-30", "timestamp": 1695202410, "time_this_iter_s": 14.619380474090576, "time_total_s": 1532.7322392463684, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316571900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1532.7322392463684, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 1.8523809523809522, "ram_util_percent": 42.48571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.399185020826757}, "policy_0": {"total_loss": 6.399185020826757, "policy_loss": -0.0009141016826033592, "vf_loss": 6.399461920409929, "vf_loss_unclipped": 3378.3732485054543, "vf_explained_var": 0.02119520297050476, "entropy": 5.43256107993126, "mean_kl_loss": 0.004475271684602194, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.35759407094247, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 408000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 15272.902, "sample_time_ms": 6651.302, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 102, "trial_id": "2bb19_00000", "date": "2023-09-20_11-33-44", "timestamp": 1695202424, "time_this_iter_s": 14.634846925735474, "time_total_s": 1547.3670861721039, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316570EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1547.3670861721039, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 1.705, "ram_util_percent": 42.335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.41300379671026}, "policy_0": {"total_loss": 4.41300379671026, "policy_loss": -0.0012280568838119506, "vf_loss": 4.413650229306565, "vf_loss_unclipped": 2371.4277091751533, "vf_explained_var": 0.0028383660316467284, "entropy": 5.244754821038246, "mean_kl_loss": 0.008169892794745101, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.53777626838763, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 412000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 15203.141, "sample_time_ms": 6649.463, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 103, "trial_id": "2bb19_00000", "date": "2023-09-20_11-33-59", "timestamp": 1695202439, "time_this_iter_s": 14.571943283081055, "time_total_s": 1561.939029455185, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316571EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1561.939029455185, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 1.6809523809523812, "ram_util_percent": 42.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.761839187516272}, "policy_0": {"total_loss": 3.761839187516272, "policy_loss": -0.0015896511182188987, "vf_loss": 3.762884541119024, "vf_loss_unclipped": 2250.5354106054197, "vf_explained_var": 0.014920250654220582, "entropy": 5.380409857869148, "mean_kl_loss": 0.007645717142467766, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.731065961485, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 416000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 15204.406, "sample_time_ms": 6652.224, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 104, "trial_id": "2bb19_00000", "date": "2023-09-20_11-34-13", "timestamp": 1695202453, "time_this_iter_s": 14.614882230758667, "time_total_s": 1576.5539116859436, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650E170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1576.5539116859436, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 1.8050000000000002, "ram_util_percent": 42.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.74503763791807}, "policy_0": {"total_loss": 2.74503763791807, "policy_loss": -0.0012710893750190735, "vf_loss": 2.7457321859727615, "vf_loss_unclipped": 1424.1271147603404, "vf_explained_var": 0.022849415469169618, "entropy": 5.1039431404590605, "mean_kl_loss": 0.008098385162452905, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.72045788926266, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 420000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 15201.052, "sample_time_ms": 6652.93, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 105, "trial_id": "2bb19_00000", "date": "2023-09-20_11-34-28", "timestamp": 1695202468, "time_this_iter_s": 14.562254905700684, "time_total_s": 1591.1161665916443, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650F7F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1591.1161665916443, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 1.9714285714285713, "ram_util_percent": 42.019047619047626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.68127660235808}, "policy_0": {"total_loss": 2.68127660235808, "policy_loss": -0.0015257272243499756, "vf_loss": 2.682139671526011, "vf_loss_unclipped": 1143.5162692916967, "vf_explained_var": 0.01785595428943634, "entropy": 5.009542233920097, "mean_kl_loss": 0.009308169981795072, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 275.6552009085184, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 424000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 15129.259, "sample_time_ms": 6640.848, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 106, "trial_id": "2bb19_00000", "date": "2023-09-20_11-34-43", "timestamp": 1695202483, "time_this_iter_s": 14.512880802154541, "time_total_s": 1605.6290473937988, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316571F30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1605.6290473937988, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 1.7099999999999997, "ram_util_percent": 42.045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.1881427282141757}, "policy_0": {"total_loss": 3.1881427282141757, "policy_loss": -0.0032154150485992432, "vf_loss": 3.1906512697219616, "vf_loss_unclipped": 1177.508472161913, "vf_explained_var": 0.024424630045890808, "entropy": 4.966517420434951, "mean_kl_loss": 0.009929239042490372, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.93227276424085, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 428000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 15019.929, "sample_time_ms": 6585.099, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 107, "trial_id": "2bb19_00000", "date": "2023-09-20_11-34-57", "timestamp": 1695202497, "time_this_iter_s": 14.551037311553955, "time_total_s": 1620.1800847053528, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316570670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1620.1800847053528, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 1.8523809523809527, "ram_util_percent": 42.00952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.0388418275438713}, "policy_0": {"total_loss": 3.0388418275438713, "policy_loss": -0.003831901583075523, "vf_loss": 3.0419185954272048, "vf_loss_unclipped": 989.6485524225413, "vf_explained_var": -0.019952329349517822, "entropy": 4.905750493693351, "mean_kl_loss": 0.01060730424062931, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -131990.01040521584, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32997.50260130394}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556308416317131, "mean_inference_ms": 0.8145333149356592, "mean_action_processing_ms": 0.2536159871132778, "mean_env_wait_ms": 1.2484549681333597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.4700136184692383}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.78785207978905, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 432000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 14837.303, "sample_time_ms": 6420.062, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 108, "trial_id": "2bb19_00000", "date": "2023-09-20_11-35-12", "timestamp": 1695202512, "time_this_iter_s": 14.558685541152954, "time_total_s": 1634.7387702465057, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316572710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1634.7387702465057, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 1.7000000000000002, "ram_util_percent": 42.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.275132800592855}, "policy_0": {"total_loss": 3.275132800592855, "policy_loss": -0.0036115535954479128, "vf_loss": 3.277719575844705, "vf_loss_unclipped": 37.16722142368406, "vf_explained_var": -0.013267887687683106, "entropy": 3.1208984048843385, "mean_kl_loss": 0.014394706022617174, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.6852204612527, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 436000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 14608.56, "sample_time_ms": 6259.207, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 109, "trial_id": "2bb19_00000", "date": "2023-09-20_11-35-27", "timestamp": 1695202527, "time_this_iter_s": 14.8341064453125, "time_total_s": 1649.5728766918182, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165730A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1649.5728766918182, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 1.5599999999999998, "ram_util_percent": 42.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.305345289024548}, "policy_0": {"total_loss": 2.305345289024548, "policy_loss": -0.0072026663847267625, "vf_loss": 2.311215176575258, "vf_loss_unclipped": 2.5640106048036366, "vf_explained_var": 0.01301969165802002, "entropy": 3.2729231874465943, "mean_kl_loss": 0.018720980793313358, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.05095832297286, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 440000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 14647.673, "sample_time_ms": 6289.785, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 110, "trial_id": "2bb19_00000", "date": "2023-09-20_11-35-42", "timestamp": 1695202542, "time_this_iter_s": 15.036712646484375, "time_total_s": 1664.6095893383026, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164332E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1664.6095893383026, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 1.3818181818181818, "ram_util_percent": 42.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.357256119446992}, "policy_0": {"total_loss": 3.357256119446992, "policy_loss": -0.0019214835343998858, "vf_loss": 3.35842189244777, "vf_loss_unclipped": 121.90430975362807, "vf_explained_var": 0.0005698525667190552, "entropy": 4.142251089572906, "mean_kl_loss": 0.0106153286678531, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07119140774011612}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 272.58425376248596, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 444000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 14653.372, "sample_time_ms": 6297.991, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 111, "trial_id": "2bb19_00000", "date": "2023-09-20_11-35-56", "timestamp": 1695202556, "time_this_iter_s": 14.676350831985474, "time_total_s": 1679.285940170288, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316573130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1679.285940170288, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 1.8, "ram_util_percent": 42.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.1050461658835413}, "policy_0": {"total_loss": 3.1050461658835413, "policy_loss": -0.008108444081922062, "vf_loss": 3.110704396383837, "vf_loss_unclipped": 131.84203003000505, "vf_explained_var": 0.03140376586914063, "entropy": 5.393129181480408, "mean_kl_loss": 0.034417298348017177, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10678711533546448}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.8446910213629, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 14694.725, "sample_time_ms": 6314.537, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 112, "trial_id": "2bb19_00000", "date": "2023-09-20_11-36-11", "timestamp": 1695202571, "time_this_iter_s": 15.04837942123413, "time_total_s": 1694.3343195915222, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316571870>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1694.3343195915222, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 4.533333333333333, "ram_util_percent": 42.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.352661040002853}, "policy_0": {"total_loss": 4.352661040002853, "policy_loss": -0.0037385150967369557, "vf_loss": 4.354383591161668, "vf_loss_unclipped": 454.37394409631344, "vf_explained_var": -0.039103033280372616, "entropy": 4.6673566729545595, "mean_kl_loss": 0.018878240778791952, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10678711533546448}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.8222864292106, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 452000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 14720.188, "sample_time_ms": 6325.302, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 113, "trial_id": "2bb19_00000", "date": "2023-09-20_11-36-26", "timestamp": 1695202586, "time_this_iter_s": 14.82557201385498, "time_total_s": 1709.1598916053772, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316571FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1709.1598916053772, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 3.547619047619047, "ram_util_percent": 42.02857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.6504936550721525}, "policy_0": {"total_loss": 1.6504936550721525, "policy_loss": -0.004556587538868189, "vf_loss": 1.6542153192964848, "vf_loss_unclipped": 65.17637378611244, "vf_explained_var": -0.07233695366382599, "entropy": 4.3012844990253445, "mean_kl_loss": 0.007818586847806, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10678711533546448}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.02011040326875, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 456000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 14773.935, "sample_time_ms": 6316.49, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 114, "trial_id": "2bb19_00000", "date": "2023-09-20_11-36-41", "timestamp": 1695202601, "time_this_iter_s": 15.152360200881958, "time_total_s": 1724.3122518062592, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316573A30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1724.3122518062592, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 3.6409090909090907, "ram_util_percent": 42.104545454545466}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.512531754307286}, "policy_0": {"total_loss": 2.512531754307286, "policy_loss": -0.005516070271655917, "vf_loss": 2.5156678607217966, "vf_loss_unclipped": 66.97451702840253, "vf_explained_var": 0.02108132801055908, "entropy": 4.830700203943253, "mean_kl_loss": 0.02228699428554537, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.16018067300319672}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 275.329196889662, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 460000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 14770.716, "sample_time_ms": 6310.102, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 115, "trial_id": "2bb19_00000", "date": "2023-09-20_11-36-56", "timestamp": 1695202616, "time_this_iter_s": 14.530062437057495, "time_total_s": 1738.8423142433167, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650F400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1738.8423142433167, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 1.72, "ram_util_percent": 42.275000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.894813650631055}, "policy_0": {"total_loss": 3.894813650631055, "policy_loss": 0.0020245039612054824, "vf_loss": 3.888835761039704, "vf_loss_unclipped": 201125.9625712938, "vf_explained_var": -0.050625756096839905, "entropy": 3.9841426987171173, "mean_kl_loss": 0.02468082682334134, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.24027100205421448}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.1101580368853, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 464000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 14784.239, "sample_time_ms": 6315.174, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 116, "trial_id": "2bb19_00000", "date": "2023-09-20_11-37-11", "timestamp": 1695202631, "time_this_iter_s": 14.648104190826416, "time_total_s": 1753.490418434143, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316573BE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1753.490418434143, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 1.3714285714285712, "ram_util_percent": 42.13809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.3380513709292514}, "policy_0": {"total_loss": 2.3380513709292514, "policy_loss": -9.94371083099395e-05, "vf_loss": 2.3363208441213237, "vf_loss_unclipped": 248.44833821258104, "vf_explained_var": -0.09163643765449524, "entropy": 4.2122216143369675, "mean_kl_loss": 0.007616265466309779, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.24027100205421448}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 271.4538842080043, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 468000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 14802.882, "sample_time_ms": 6312.896, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 117, "trial_id": "2bb19_00000", "date": "2023-09-20_11-37-25", "timestamp": 1695202645, "time_this_iter_s": 14.737467527389526, "time_total_s": 1768.2278859615326, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316570AF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1768.2278859615326, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 1.8476190476190477, "ram_util_percent": 42.20476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.3110826186702587}, "policy_0": {"total_loss": 1.3110826186702587, "policy_loss": -0.0004654819301329553, "vf_loss": 1.3085720784029924, "vf_loss_unclipped": 2.214869133647438, "vf_explained_var": 0.056967654418945315, "entropy": 4.14088103222847, "mean_kl_loss": 0.012386116718786798, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.24027100205421448}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.0302711683424, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 472000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 14834.035, "sample_time_ms": 6309.874, "synch_weights_time_ms": 2.102}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 118, "trial_id": "2bb19_00000", "date": "2023-09-20_11-37-40", "timestamp": 1695202660, "time_this_iter_s": 14.87021541595459, "time_total_s": 1783.0981013774872, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316572EF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1783.0981013774872, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 2.0619047619047617, "ram_util_percent": 42.69523809523811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.6183746606864966}, "policy_0": {"total_loss": 1.6183746606864966, "policy_loss": -0.0006075593010289595, "vf_loss": 1.608045567403268, "vf_loss_unclipped": 126.08769456337495, "vf_explained_var": 0.006561191439628601, "entropy": 4.2364641647100445, "mean_kl_loss": 0.04551800308218622, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3604065179824829}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.4125431967097, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 476000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 14880.972, "sample_time_ms": 6332.292, "synch_weights_time_ms": 2.102}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 119, "trial_id": "2bb19_00000", "date": "2023-09-20_11-37-56", "timestamp": 1695202676, "time_this_iter_s": 15.303483963012695, "time_total_s": 1798.4015853404999, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650DE10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1798.4015853404999, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 2.0714285714285716, "ram_util_percent": 42.87619047619047}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.430890188207198}, "policy_0": {"total_loss": 1.430890188207198, "policy_loss": -0.007939370621903799, "vf_loss": 1.433410133940261, "vf_loss_unclipped": 58.72981078062681, "vf_explained_var": -0.002181189441680908, "entropy": 4.301118287396431, "mean_kl_loss": 0.015036970228119253, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3604065179824829}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.6004231532826, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 480000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 14861.178, "sample_time_ms": 6302.756, "synch_weights_time_ms": 2.002}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 120, "trial_id": "2bb19_00000", "date": "2023-09-20_11-38-10", "timestamp": 1695202690, "time_this_iter_s": 14.837772369384766, "time_total_s": 1813.2393577098846, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316571E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1813.2393577098846, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 1.7333333333333332, "ram_util_percent": 43.05238095238096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.5695429521605373}, "policy_0": {"total_loss": 1.5695429521605373, "policy_loss": -0.0013083865321008488, "vf_loss": 1.5673533859610558, "vf_loss_unclipped": 7.409908405053615, "vf_explained_var": 0.010521234726905823, "entropy": 4.29939633731842, "mean_kl_loss": 0.009705595816402455, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3604065179824829}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 262.7945108561463, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 484000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 14915.844, "sample_time_ms": 6349.899, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 121, "trial_id": "2bb19_00000", "date": "2023-09-20_11-38-26", "timestamp": 1695202706, "time_this_iter_s": 15.222015142440796, "time_total_s": 1828.4613728523254, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316573250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1828.4613728523254, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 1.440909090909091, "ram_util_percent": 43.422727272727265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.6281359353147447}, "policy_0": {"total_loss": 1.6281359353147447, "policy_loss": -0.0009271703965961933, "vf_loss": 1.6261449081974104, "vf_loss_unclipped": 2.0434854380207135, "vf_explained_var": -0.02320387749671936, "entropy": 4.842913371276856, "mean_kl_loss": 0.008096963096839773, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3604065179824829}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 272.47866002446835, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 488000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 14879.211, "sample_time_ms": 6341.356, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 122, "trial_id": "2bb19_00000", "date": "2023-09-20_11-38-40", "timestamp": 1695202720, "time_this_iter_s": 14.68104887008667, "time_total_s": 1843.142421722412, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164AEB90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1843.142421722412, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 1.72, "ram_util_percent": 43.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.528323197846522}, "policy_0": {"total_loss": 3.528323197846522, "policy_loss": -0.0013681479573249818, "vf_loss": 3.527808798289299, "vf_loss_unclipped": 20946.89694481089, "vf_explained_var": 0.008790177750587463, "entropy": 4.7697166480064395, "mean_kl_loss": 0.005223410195200813, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3604065179824829}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 264.06859380271084, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 492000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 14911.512, "sample_time_ms": 6369.275, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 123, "trial_id": "2bb19_00000", "date": "2023-09-20_11-38-56", "timestamp": 1695202736, "time_this_iter_s": 15.148578643798828, "time_total_s": 1858.291000366211, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165731C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1858.291000366211, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 1.5727272727272728, "ram_util_percent": 43.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.7684775863772724}, "policy_0": {"total_loss": 2.7684775863772724, "policy_loss": -0.003924438489973545, "vf_loss": 2.7671966099437326, "vf_loss_unclipped": 58.99045909315907, "vf_explained_var": -0.04346055512428284, "entropy": 4.958365036821365, "mean_kl_loss": 0.01444319321924586, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3604065179824829}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.1644349922767, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 496000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 14860.795, "sample_time_ms": 6383.299, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 124, "trial_id": "2bb19_00000", "date": "2023-09-20_11-39-10", "timestamp": 1695202750, "time_this_iter_s": 14.645194053649902, "time_total_s": 1872.9361944198608, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1872.9361944198608, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 2.115, "ram_util_percent": 43.319999999999986}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.1866150570256635}, "policy_0": {"total_loss": 1.1866150570256635, "policy_loss": -0.002214396008010954, "vf_loss": 1.1853123047382803, "vf_loss_unclipped": 2.3264731919796438, "vf_explained_var": 0.003330935192108154, "entropy": 4.9783687151908875, "mean_kl_loss": 0.009758838399724527, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.3604065179824829}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.90394162076393, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 500000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 14868.355, "sample_time_ms": 6389.123, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 125, "trial_id": "2bb19_00000", "date": "2023-09-20_11-39-25", "timestamp": 1695202765, "time_this_iter_s": 14.605163097381592, "time_total_s": 1887.5413575172424, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C8B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1887.5413575172424, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 1.9714285714285713, "ram_util_percent": 43.18095238095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.3034855415225028}, "policy_0": {"total_loss": 1.3034855415225028, "policy_loss": -0.002320473222574219, "vf_loss": 1.3041209919851273, "vf_loss_unclipped": 15.379526207916067, "vf_explained_var": -0.02145587363243103, "entropy": 4.949874925804139, "mean_kl_loss": 0.00467533862208129, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18020325899124146}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -129396.0901176727, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -32349.022529418147}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8555429909674704, "mean_inference_ms": 0.8138278662625916, "mean_action_processing_ms": 0.25336137383125584, "mean_env_wait_ms": 1.2467933514208343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.008330742518107096, "ViewRequirementAgentConnector_ms": 0.466690460840861}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.99851697338823, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 504000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 14901.88, "sample_time_ms": 6427.715, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 126, "trial_id": "2bb19_00000", "date": "2023-09-20_11-39-40", "timestamp": 1695202780, "time_this_iter_s": 14.982860326766968, "time_total_s": 1902.5242178440094, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C9480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1902.5242178440094, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 1.6904761904761905, "ram_util_percent": 42.88571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.820965129828453}, "policy_0": {"total_loss": 4.820965129828453, "policy_loss": -0.003355142382066697, "vf_loss": 4.822605681714416, "vf_loss_unclipped": 73.34443924662769, "vf_explained_var": -0.0018705009937286378, "entropy": 4.000920804548263, "mean_kl_loss": 0.009514814088079583, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18020325899124146}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 258.1176668783388, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 508000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 14978.014, "sample_time_ms": 6471.426, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 127, "trial_id": "2bb19_00000", "date": "2023-09-20_11-39-55", "timestamp": 1695202795, "time_this_iter_s": 15.498807668685913, "time_total_s": 1918.0230255126953, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316573010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1918.0230255126953, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 1.5227272727272732, "ram_util_percent": 42.92272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.1033922168500254}, "policy_0": {"total_loss": 2.1033922168500254, "policy_loss": -0.005769312078878284, "vf_loss": 2.106643043348193, "vf_loss_unclipped": 2.519268524572253, "vf_explained_var": 0.028258359670639038, "entropy": 4.063068727779388, "mean_kl_loss": 0.013975781922094756, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18020325899124146}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 269.6774566051046, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 14974.446, "sample_time_ms": 6469.686, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 128, "trial_id": "2bb19_00000", "date": "2023-09-20_11-40-10", "timestamp": 1695202810, "time_this_iter_s": 14.834533452987671, "time_total_s": 1932.857558965683, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650DE10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1932.857558965683, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 1.7619047619047623, "ram_util_percent": 42.9095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.1555729552990757}, "policy_0": {"total_loss": 2.1555729552990757, "policy_loss": -0.0076402980223298075, "vf_loss": 2.161169004472997, "vf_loss_unclipped": 123.60847158778598, "vf_explained_var": 0.03832368276119232, "entropy": 4.372744248533249, "mean_kl_loss": 0.011344092158014246, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18020325899124146}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 276.31942845947077, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 516000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 14891.897, "sample_time_ms": 6419.736, "synch_weights_time_ms": 2.301}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 129, "trial_id": "2bb19_00000", "date": "2023-09-20_11-40-25", "timestamp": 1695202825, "time_this_iter_s": 14.478000164031982, "time_total_s": 1947.335559129715, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C89D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1947.335559129715, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 2.3449999999999998, "ram_util_percent": 42.88999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.011634328882536}, "policy_0": {"total_loss": 1.011634328882536, "policy_loss": -0.00756163695580326, "vf_loss": 1.0170217119339389, "vf_loss_unclipped": 1.0777718193176669, "vf_explained_var": 0.04724204943180084, "entropy": 4.426341283369064, "mean_kl_loss": 0.012065566764593678, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18020325899124146}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 275.45194421221794, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 520000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 14860.379, "sample_time_ms": 6410.883, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 130, "trial_id": "2bb19_00000", "date": "2023-09-20_11-40-39", "timestamp": 1695202839, "time_this_iter_s": 14.522589206695557, "time_total_s": 1961.8581483364105, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C80D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1961.8581483364105, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 2.342857142857143, "ram_util_percent": 42.83333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.836907162972144}, "policy_0": {"total_loss": 2.836907162972144, "policy_loss": -0.003151945370156318, "vf_loss": 2.837728468317166, "vf_loss_unclipped": 129.96608396639266, "vf_explained_var": -0.020851535177230835, "entropy": 4.508403069353103, "mean_kl_loss": 0.012933407741697737, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18020325899124146}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.23031103776606, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 524000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 14796.905, "sample_time_ms": 6354.666, "synch_weights_time_ms": 2.402}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 131, "trial_id": "2bb19_00000", "date": "2023-09-20_11-40-54", "timestamp": 1695202854, "time_this_iter_s": 14.58778166770935, "time_total_s": 1976.4459300041199, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CA200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1976.4459300041199, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 2.7, "ram_util_percent": 42.82499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.963808858359978}, "policy_0": {"total_loss": 4.963808858359978, "policy_loss": -0.00579251628187485, "vf_loss": 4.9652281136468055, "vf_loss_unclipped": 607.7569988376811, "vf_explained_var": -0.27111249918937685, "entropy": 4.655512557935714, "mean_kl_loss": 0.024268453209284054, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 260.86998030975565, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 528000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 14862.231, "sample_time_ms": 6382.36, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 132, "trial_id": "2bb19_00000", "date": "2023-09-20_11-41-09", "timestamp": 1695202869, "time_this_iter_s": 15.33530879020691, "time_total_s": 1991.7812387943268, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316572A70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1991.7812387943268, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 1.6954545454545455, "ram_util_percent": 43.14090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.20341113191247}, "policy_0": {"total_loss": 6.20341113191247, "policy_loss": -0.003483112660609186, "vf_loss": 6.203037761867046, "vf_loss_unclipped": 1002.9779777516246, "vf_explained_var": -0.44618856024742126, "entropy": 4.834179186105728, "mean_kl_loss": 0.014267176865064539, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.20932007483356, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 532000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 14844.427, "sample_time_ms": 6364.312, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 133, "trial_id": "2bb19_00000", "date": "2023-09-20_11-41-24", "timestamp": 1695202884, "time_this_iter_s": 14.971537828445435, "time_total_s": 2006.7527766227722, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C8B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2006.7527766227722, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 1.557142857142857, "ram_util_percent": 43.16190476190477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.087589797997475}, "policy_0": {"total_loss": 5.087589797997475, "policy_loss": -0.00013509866498061455, "vf_loss": 5.086015797314047, "vf_loss_unclipped": 709.5862908103794, "vf_explained_var": -0.30296607220172883, "entropy": 5.013167801237106, "mean_kl_loss": 0.006322862741100107, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.5340759108958, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 536000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 14875.244, "sample_time_ms": 6392.058, "synch_weights_time_ms": 2.323}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 134, "trial_id": "2bb19_00000", "date": "2023-09-20_11-41-39", "timestamp": 1695202899, "time_this_iter_s": 14.953374862670898, "time_total_s": 2021.7061514854431, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C8C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2021.7061514854431, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 3.6428571428571437, "ram_util_percent": 43.138095238095254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.021235772743076}, "policy_0": {"total_loss": 2.021235772743076, "policy_loss": -0.0027039753939025104, "vf_loss": 2.022246118895989, "vf_loss_unclipped": 14.30158722769497, "vf_explained_var": -0.027244510221481322, "entropy": 5.097191550302505, "mean_kl_loss": 0.006265647133082529, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 274.559171035413, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 540000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 14871.759, "sample_time_ms": 6391.074, "synch_weights_time_ms": 2.323}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 135, "trial_id": "2bb19_00000", "date": "2023-09-20_11-41-54", "timestamp": 1695202914, "time_this_iter_s": 14.570807218551636, "time_total_s": 2036.2769587039948, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C96C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2036.2769587039948, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 1.6904761904761902, "ram_util_percent": 43.14285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.709465954090003}, "policy_0": {"total_loss": 2.709465954090003, "policy_loss": -0.0054948485031491145, "vf_loss": 2.712386741347937, "vf_loss_unclipped": 188.32855618452612, "vf_explained_var": 0.03516255807876587, "entropy": 4.899555520057678, "mean_kl_loss": 0.009522799467270306, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.0699778179276, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 544000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 14838.449, "sample_time_ms": 6351.435, "synch_weights_time_ms": 2.323}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 136, "trial_id": "2bb19_00000", "date": "2023-09-20_11-42-08", "timestamp": 1695202928, "time_this_iter_s": 14.650260210037231, "time_total_s": 2050.927218914032, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CAB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2050.927218914032, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 3.03, "ram_util_percent": 43.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.831944644429302}, "policy_0": {"total_loss": 2.831944644429302, "policy_loss": -0.00359106209538877, "vf_loss": 2.8311776107757587, "vf_loss_unclipped": 2284.3181265242547, "vf_explained_var": 0.025563527369499208, "entropy": 4.396813770580292, "mean_kl_loss": 0.016122883372253455, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 275.40983326683056, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 548000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 14741.149, "sample_time_ms": 6306.784, "synch_weights_time_ms": 2.223}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 137, "trial_id": "2bb19_00000", "date": "2023-09-20_11-42-23", "timestamp": 1695202943, "time_this_iter_s": 14.525810718536377, "time_total_s": 2065.4530296325684, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164337F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2065.4530296325684, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 3.0904761904761906, "ram_util_percent": 43.042857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.902881698001921}, "policy_0": {"total_loss": 2.902881698001921, "policy_loss": -0.003647407752647996, "vf_loss": 2.901330454115616, "vf_loss_unclipped": 301.033063486819, "vf_explained_var": 0.030134471654891967, "entropy": 3.963912657737732, "mean_kl_loss": 0.019232574733431828, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 271.23113293032065, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 552000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 14732.653, "sample_time_ms": 6321.341, "synch_weights_time_ms": 2.123}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 138, "trial_id": "2bb19_00000", "date": "2023-09-20_11-42-38", "timestamp": 1695202958, "time_this_iter_s": 14.748569250106812, "time_total_s": 2080.201598882675, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x000001731650DE10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2080.201598882675, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 1.9428571428571435, "ram_util_percent": 43.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.5218796648211574}, "policy_0": {"total_loss": 1.5218796648211574, "policy_loss": -0.0008699474431574345, "vf_loss": 1.5213104016281476, "vf_loss_unclipped": 200.2731515980698, "vf_explained_var": -0.05542970290184021, "entropy": 4.290584352970123, "mean_kl_loss": 0.005324392427785642, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.2136346130202, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 556000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 14749.109, "sample_time_ms": 6331.091, "synch_weights_time_ms": 2.123}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 139, "trial_id": "2bb19_00000", "date": "2023-09-20_11-42-52", "timestamp": 1695202972, "time_this_iter_s": 14.642558336257935, "time_total_s": 2094.844157218933, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CAEF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2094.844157218933, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 1.5050000000000001, "ram_util_percent": 43.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.8843700530753005}, "policy_0": {"total_loss": 0.8843700530753005, "policy_loss": -0.0014285294771194457, "vf_loss": 0.8826665513056796, "vf_loss_unclipped": 0.9031375134963077, "vf_explained_var": -0.0696862224817276, "entropy": 4.278736471366883, "mean_kl_loss": 0.011587022529245223, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 273.46784631171244, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 560000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 14759.645, "sample_time_ms": 6338.484, "synch_weights_time_ms": 2.222}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 140, "trial_id": "2bb19_00000", "date": "2023-09-20_11-43-07", "timestamp": 1695202987, "time_this_iter_s": 14.627947807312012, "time_total_s": 2109.472105026245, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C8F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2109.472105026245, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 1.7285714285714289, "ram_util_percent": 42.79523809523809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.1107626843750478}, "policy_0": {"total_loss": 1.1107626843750478, "policy_loss": 0.0023304229132831097, "vf_loss": 1.1022638995173388, "vf_loss_unclipped": 64.08419461097745, "vf_explained_var": -0.01888617949485779, "entropy": 4.295449512004852, "mean_kl_loss": 0.022820020460969134, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 251.1375740473578, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 564000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 14893.769, "sample_time_ms": 6384.653, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 141, "trial_id": "2bb19_00000", "date": "2023-09-20_11-43-23", "timestamp": 1695203003, "time_this_iter_s": 15.930031538009644, "time_total_s": 2125.4021365642548, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C9AB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2125.4021365642548, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 3.7454545454545456, "ram_util_percent": 42.87272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.7329508496642112}, "policy_0": {"total_loss": 1.7329508496642112, "policy_loss": -0.00032813161723315717, "vf_loss": 1.7298835550648626, "vf_loss_unclipped": 20.53710368636674, "vf_explained_var": -0.035267812490463256, "entropy": 4.463387313938141, "mean_kl_loss": 0.008374303420069555, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 250.94290841883398, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 568000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 14954.426, "sample_time_ms": 6433.191, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 142, "trial_id": "2bb19_00000", "date": "2023-09-20_11-43-39", "timestamp": 1695203019, "time_this_iter_s": 15.941879987716675, "time_total_s": 2141.3440165519714, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CBAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2141.3440165519714, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 2.7304347826086963, "ram_util_percent": 44.508695652173905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.9788414999220987}, "policy_0": {"total_loss": 1.9788414999220987, "policy_loss": -0.0010199658984318375, "vf_loss": 1.9775910428037866, "vf_loss_unclipped": 9.9832291553488, "vf_explained_var": 0.015597917485237122, "entropy": 4.54949300069809, "mean_kl_loss": 0.005599633413780612, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 265.49204971766375, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 572000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 14964.109, "sample_time_ms": 6398.096, "synch_weights_time_ms": 2.122}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 143, "trial_id": "2bb19_00000", "date": "2023-09-20_11-43-54", "timestamp": 1695203034, "time_this_iter_s": 15.068361759185791, "time_total_s": 2156.412378311157, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173164337F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2156.412378311157, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 2.5761904761904764, "ram_util_percent": 44.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.234532945724763}, "policy_0": {"total_loss": 2.234532945724763, "policy_loss": -0.004276751198992133, "vf_loss": 2.2359261262301358, "vf_loss_unclipped": 30.079849156940355, "vf_explained_var": 0.030436267042160035, "entropy": 4.64789373588562, "mean_kl_loss": 0.007111904399845525, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -123240.271465883, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -30810.067866470778}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551309499363676, "mean_inference_ms": 0.813126606092039, "mean_action_processing_ms": 0.2531071709321569, "mean_env_wait_ms": 1.2452269271336873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.007140636444091797, "ViewRequirementAgentConnector_ms": 0.4785929407392229}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 267.2908481617144, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 576000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 14965.47, "sample_time_ms": 6364.029, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 144, "trial_id": "2bb19_00000", "date": "2023-09-20_11-44-09", "timestamp": 1695203049, "time_this_iter_s": 14.966971397399902, "time_total_s": 2171.379349708557, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CA050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2171.379349708557, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 2.2666666666666666, "ram_util_percent": 44.92380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.5648237719435243}, "policy_0": {"total_loss": 3.5648237719435243, "policy_loss": -0.007563715246226638, "vf_loss": 3.570611450134218, "vf_loss_unclipped": 23.155590171943604, "vf_explained_var": -0.031625773072242735, "entropy": 5.749518356323242, "mean_kl_loss": 0.004380337969971424, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 266.9282976850676, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 580000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 15007.118, "sample_time_ms": 6391.214, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 145, "trial_id": "2bb19_00000", "date": "2023-09-20_11-44-24", "timestamp": 1695203064, "time_this_iter_s": 14.987298011779785, "time_total_s": 2186.366647720337, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2186.366647720337, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 1.8285714285714285, "ram_util_percent": 44.990476190476194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.698442338268459}, "policy_0": {"total_loss": 3.698442338268459, "policy_loss": -0.005570734522398561, "vf_loss": 3.7020388937726616, "vf_loss_unclipped": 10.826853683306277, "vf_explained_var": 0.05475581533908844, "entropy": 6.27042569770813, "mean_kl_loss": 0.009738060352802858, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 261.69158431788645, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 584000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 15070.809, "sample_time_ms": 6409.183, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 146, "trial_id": "2bb19_00000", "date": "2023-09-20_11-44-39", "timestamp": 1695203079, "time_this_iter_s": 15.287168502807617, "time_total_s": 2201.6538162231445, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CB520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2201.6538162231445, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 1.7272727272727273, "ram_util_percent": 45.26363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.475513057947089}, "policy_0": {"total_loss": 4.475513057947089, "policy_loss": -0.0042849356660619375, "vf_loss": 4.478032270134985, "vf_loss_unclipped": 196.49882982362658, "vf_explained_var": 0.01886535394191742, "entropy": 6.703922543525696, "mean_kl_loss": 0.008709751770219373, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 104.10180592435458, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 588000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 17460.821, "sample_time_ms": 7242.198, "synch_weights_time_ms": 2.306}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 147, "trial_id": "2bb19_00000", "date": "2023-09-20_11-45-18", "timestamp": 1695203118, "time_this_iter_s": 38.42692470550537, "time_total_s": 2240.08074092865, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F0B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2240.08074092865, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 3.0962962962962965, "ram_util_percent": 45.601851851851855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.23121929945827}, "policy_0": {"total_loss": 7.23121929945827, "policy_loss": 0.0037584670037031174, "vf_loss": 7.224732261955738, "vf_loss_unclipped": 4089.2213340182902, "vf_explained_var": -0.11093065576553345, "entropy": 4.988771004867553, "mean_kl_loss": 0.01345923793285301, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 118.24459701671954, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 592000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 19368.882, "sample_time_ms": 7880.885, "synch_weights_time_ms": 2.506}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 148, "trial_id": "2bb19_00000", "date": "2023-09-20_11-45-52", "timestamp": 1695203152, "time_this_iter_s": 33.83018469810486, "time_total_s": 2273.9109256267548, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165C9900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2273.9109256267548, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 4.185106382978723, "ram_util_percent": 45.8531914893617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.8694309909296685}, "policy_0": {"total_loss": 6.8694309909296685, "policy_loss": -0.002659489145874977, "vf_loss": 6.870353479697183, "vf_loss_unclipped": 1389.8967336485166, "vf_explained_var": -0.2040612984895706, "entropy": 4.609393331217766, "mean_kl_loss": 0.008568100271476396, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.50562231880593, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 596000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 20653.861, "sample_time_ms": 7879.033, "synch_weights_time_ms": 2.706}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 149, "trial_id": "2bb19_00000", "date": "2023-09-20_11-46-19", "timestamp": 1695203179, "time_this_iter_s": 27.492346048355103, "time_total_s": 2301.40327167511, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165725F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2301.40327167511, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 4.112820512820513, "ram_util_percent": 47.03589743589743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.935499246655731}, "policy_0": {"total_loss": 7.935499246655731, "policy_loss": -0.0011048775730654597, "vf_loss": 7.93399714858532, "vf_loss_unclipped": 2259.2045029212713, "vf_explained_var": -0.17688902077674865, "entropy": 4.326839008331299, "mean_kl_loss": 0.012859464830096113, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.33566118039295, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 600000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 21924.608, "sample_time_ms": 7871.493, "synch_weights_time_ms": 2.806}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 150, "trial_id": "2bb19_00000", "date": "2023-09-20_11-46-47", "timestamp": 1695203207, "time_this_iter_s": 27.33641815185547, "time_total_s": 2328.7396898269653, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F05E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2328.7396898269653, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 3.628947368421053, "ram_util_percent": 47.184210526315795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.321646590355411}, "policy_0": {"total_loss": 7.321646590355411, "policy_loss": 0.001078931968472898, "vf_loss": 7.318239245600998, "vf_loss_unclipped": 3144.7423970693544, "vf_explained_var": -0.07560302665233612, "entropy": 4.190807530009747, "mean_kl_loss": 0.011485365400833144, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.22194362813553, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 604000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 23067.423, "sample_time_ms": 7840.225, "synch_weights_time_ms": 2.906}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 151, "trial_id": "2bb19_00000", "date": "2023-09-20_11-47-14", "timestamp": 1695203234, "time_this_iter_s": 27.357674837112427, "time_total_s": 2356.0973646640778, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F16C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2356.0973646640778, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 3.8102564102564096, "ram_util_percent": 47.09999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.582920061664947}, "policy_0": {"total_loss": 6.582920061664947, "policy_loss": 0.0027273766085505486, "vf_loss": 6.5761748121276495, "vf_loss_unclipped": 2997.341698303415, "vf_explained_var": -0.06046129360198975, "entropy": 4.033166897433996, "mean_kl_loss": 0.019819000825965487, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.79941209689676, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 608000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 24161.618, "sample_time_ms": 7760.646, "synch_weights_time_ms": 3.11}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 152, "trial_id": "2bb19_00000", "date": "2023-09-20_11-47-41", "timestamp": 1695203261, "time_this_iter_s": 26.883825540542603, "time_total_s": 2382.9811902046204, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CAEF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2382.9811902046204, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 3.6135135135135132, "ram_util_percent": 46.70270270270271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.812486986912135}, "policy_0": {"total_loss": 3.812486986912135, "policy_loss": -0.0035144516050815582, "vf_loss": 3.8141063565334306, "vf_loss_unclipped": 1057.7791729247174, "vf_explained_var": -0.031282358527183536, "entropy": 3.7920118723835796, "mean_kl_loss": 0.009347911390482022, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.42390475060787, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 612000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 25349.965, "sample_time_ms": 7768.772, "synch_weights_time_ms": 3.21}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 153, "trial_id": "2bb19_00000", "date": "2023-09-20_11-48-08", "timestamp": 1695203288, "time_this_iter_s": 26.951836824417114, "time_total_s": 2409.9330270290375, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017316572710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2409.9330270290375, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 4.08421052631579, "ram_util_percent": 46.72105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.0321170437157154}, "policy_0": {"total_loss": 3.0321170437157154, "policy_loss": -0.001080965220555663, "vf_loss": 3.031742111553578, "vf_loss_unclipped": 129.34028189212265, "vf_explained_var": 0.0136301340341568, "entropy": 3.423569606999308, "mean_kl_loss": 0.007181562900169229, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.9130216668479, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 616000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 26576.167, "sample_time_ms": 7768.274, "synch_weights_time_ms": 3.41}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 154, "trial_id": "2bb19_00000", "date": "2023-09-20_11-48-35", "timestamp": 1695203315, "time_this_iter_s": 27.228994131088257, "time_total_s": 2437.1620211601257, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CA4D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2437.1620211601257, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 4.218421052631578, "ram_util_percent": 46.842105263157904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.3982766810467466}, "policy_0": {"total_loss": 1.3982766810467466, "policy_loss": -0.0034583213156554847, "vf_loss": 1.398101216451591, "vf_loss_unclipped": 1.4242050526065286, "vf_explained_var": 0.022575667309761047, "entropy": 4.017648099426925, "mean_kl_loss": 0.017924395166294925, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.02999753683633, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 620000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 27816.801, "sample_time_ms": 7759.763, "synch_weights_time_ms": 3.61}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 155, "trial_id": "2bb19_00000", "date": "2023-09-20_11-49-02", "timestamp": 1695203342, "time_this_iter_s": 27.393133878707886, "time_total_s": 2464.5551550388336, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CBB50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2464.5551550388336, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 3.679487179487179, "ram_util_percent": 46.923076923076934}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.730365525153745}, "policy_0": {"total_loss": 0.730365525153745, "policy_loss": -0.001352313007111661, "vf_loss": 0.7287103676589759, "vf_loss_unclipped": 0.845035133055094, "vf_explained_var": 0.07139676682949066, "entropy": 3.608571412321925, "mean_kl_loss": 0.01483491090927273, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.71125598390273, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 624000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 29014.728, "sample_time_ms": 7739.392, "synch_weights_time_ms": 3.81}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 156, "trial_id": "2bb19_00000", "date": "2023-09-20_11-49-30", "timestamp": 1695203370, "time_this_iter_s": 27.266437530517578, "time_total_s": 2491.821592569351, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CBEB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2491.821592569351, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 4.110526315789474, "ram_util_percent": 47.00263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.1208636277009267}, "policy_0": {"total_loss": 1.1208636277009267, "policy_loss": -0.003351002424582839, "vf_loss": 1.1220150243707558, "vf_loss_unclipped": 1.181110051579084, "vf_explained_var": 0.04477313747406006, "entropy": 3.7869934662401676, "mean_kl_loss": 0.010850001233597868, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20272865891456604}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.6258737103581, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 628000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 27919.1, "sample_time_ms": 6910.216, "synch_weights_time_ms": 3.805}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 157, "trial_id": "2bb19_00000", "date": "2023-09-20_11-49-57", "timestamp": 1695203397, "time_this_iter_s": 27.469646215438843, "time_total_s": 2519.29123878479, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2519.29123878479, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 3.93076923076923, "ram_util_percent": 47.10512820512819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.7886752120861784}, "policy_0": {"total_loss": 0.7886752120861784, "policy_loss": -0.0032618312172591687, "vf_loss": 0.7877458793982478, "vf_loss_unclipped": 0.9244896428450556, "vf_explained_var": 0.04100882887840271, "entropy": 4.396614082804322, "mean_kl_loss": 0.020673761706650112, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 144.63973234278046, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 632000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 27301.773, "sample_time_ms": 6280.826, "synch_weights_time_ms": 3.705}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 158, "trial_id": "2bb19_00000", "date": "2023-09-20_11-50-25", "timestamp": 1695203425, "time_this_iter_s": 27.656920433044434, "time_total_s": 2546.9481592178345, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F1FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2546.9481592178345, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 4.157894736842105, "ram_util_percent": 47.121052631578934}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.7553390088199637}, "policy_0": {"total_loss": 0.7553390088199637, "policy_loss": -0.0034736526276916264, "vf_loss": 0.7556340497044443, "vf_loss_unclipped": 0.8149223901776194, "vf_explained_var": 0.06228088221549988, "entropy": 4.317066207399406, "mean_kl_loss": 0.010452757879659475, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.54918121332926, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 636000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 27300.951, "sample_time_ms": 6285.095, "synch_weights_time_ms": 3.705}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 159, "trial_id": "2bb19_00000", "date": "2023-09-20_11-50-52", "timestamp": 1695203452, "time_this_iter_s": 27.4841206073761, "time_total_s": 2574.4322798252106, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CAEF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2574.4322798252106, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 3.9794871794871787, "ram_util_percent": 47.21025641025642}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.4681934578205459}, "policy_0": {"total_loss": 0.4681934578205459, "policy_loss": -0.003917242947220802, "vf_loss": 0.4693047346205643, "vf_loss_unclipped": 0.4693047346205643, "vf_explained_var": 0.04241077196598053, "entropy": 4.093090281182527, "mean_kl_loss": 0.009227319809004621, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.61619441623372, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 640000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 27314.456, "sample_time_ms": 6298.907, "synch_weights_time_ms": 3.605}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 160, "trial_id": "2bb19_00000", "date": "2023-09-20_11-51-20", "timestamp": 1695203480, "time_this_iter_s": 27.471474409103394, "time_total_s": 2601.903754234314, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F0790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2601.903754234314, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 4.05128205128205, "ram_util_percent": 47.223076923076924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.5543904827404768}, "policy_0": {"total_loss": 0.5543904827404768, "policy_loss": -0.0041449997413903475, "vf_loss": 0.5547370896070656, "vf_loss_unclipped": 0.5608303957670386, "vf_explained_var": 0.009079245638847351, "entropy": 4.011317446237802, "mean_kl_loss": 0.012490900680687627, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 144.71624935021066, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 644000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 27342.918, "sample_time_ms": 6314.636, "synch_weights_time_ms": 3.605}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 161, "trial_id": "2bb19_00000", "date": "2023-09-20_11-51-48", "timestamp": 1695203508, "time_this_iter_s": 27.64129614830017, "time_total_s": 2629.545050382614, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F13F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2629.545050382614, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 3.838461538461538, "ram_util_percent": 47.276923076923076}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.5021331721950788}, "policy_0": {"total_loss": 0.5021331721950788, "policy_loss": -0.0051373275504214685, "vf_loss": 0.5041961404485095, "vf_loss_unclipped": 0.5176433860463489, "vf_explained_var": 0.06597885465621948, "entropy": 4.013902730870247, "mean_kl_loss": 0.01010993315606247, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -115641.26330595429, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28910.315826488593}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545957790754232, "mean_inference_ms": 0.8123178636006644, "mean_action_processing_ms": 0.25283312094726584, "mean_env_wait_ms": 1.243689488484757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.006248056888580322, "ViewRequirementAgentConnector_ms": 0.47501176595687866}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 143.8088313651826, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 648000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 27436.106, "sample_time_ms": 6342.837, "synch_weights_time_ms": 3.601}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 162, "trial_id": "2bb19_00000", "date": "2023-09-20_11-52-16", "timestamp": 1695203536, "time_this_iter_s": 27.816208124160767, "time_total_s": 2657.361258506775, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F2B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2657.361258506775, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 3.753846153846154, "ram_util_percent": 47.34102564102565}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.756251890689018}, "policy_0": {"total_loss": 5.756251890689018, "policy_loss": 0.0009175801116973162, "vf_loss": 5.752214400830865, "vf_loss_unclipped": 766.563501952663, "vf_explained_var": -0.05059014961719513, "entropy": 4.539971845054627, "mean_kl_loss": 0.010259659706385718, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.2971921967068, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 652000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 27494.1, "sample_time_ms": 6373.289, "synch_weights_time_ms": 3.7}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 163, "trial_id": "2bb19_00000", "date": "2023-09-20_11-52-43", "timestamp": 1695203563, "time_this_iter_s": 27.531782150268555, "time_total_s": 2684.8930406570435, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CB250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2684.8930406570435, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 4.094736842105263, "ram_util_percent": 47.40263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.728494654629985}, "policy_0": {"total_loss": 5.728494654629985, "policy_loss": 0.0006518051840364933, "vf_loss": 5.725356950959563, "vf_loss_unclipped": 1232.6169051217169, "vf_explained_var": 0.010274572348594666, "entropy": 3.8542815761089324, "mean_kl_loss": 0.008174764386362221, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 143.54153132552315, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 656000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 27558.051, "sample_time_ms": 6359.251, "synch_weights_time_ms": 3.7}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 164, "trial_id": "2bb19_00000", "date": "2023-09-20_11-53-11", "timestamp": 1695203591, "time_this_iter_s": 27.868499755859375, "time_total_s": 2712.761540412903, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F1A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2712.761540412903, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 3.81, "ram_util_percent": 47.432500000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.6627153159523385}, "policy_0": {"total_loss": 2.6627153159523385, "policy_loss": -0.004876423470373265, "vf_loss": 2.6612326592716475, "vf_loss_unclipped": 465.97720283274975, "vf_explained_var": -0.07157627470493316, "entropy": 2.961437486743927, "mean_kl_loss": 0.02091162380400783, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4561395049095154}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.13859199017173, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 660000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 27556.015, "sample_time_ms": 6355.019, "synch_weights_time_ms": 3.601}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 165, "trial_id": "2bb19_00000", "date": "2023-09-20_11-53-38", "timestamp": 1695203618, "time_this_iter_s": 27.37227725982666, "time_total_s": 2740.1338176727295, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F1C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2740.1338176727295, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 4.263157894736841, "ram_util_percent": 47.547368421052624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.5665139628186822}, "policy_0": {"total_loss": 0.5665139628186822, "policy_loss": -0.0015701907560229302, "vf_loss": 0.5636229123178231, "vf_loss_unclipped": 0.5735609898629891, "vf_explained_var": -0.048051612639427185, "entropy": 2.7717627982616424, "mean_kl_loss": 0.009780437390389852, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4561395049095154}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.16015887579832, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 664000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 27566.295, "sample_time_ms": 6366.242, "synch_weights_time_ms": 3.7}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 166, "trial_id": "2bb19_00000", "date": "2023-09-20_11-54-06", "timestamp": 1695203646, "time_this_iter_s": 27.36923885345459, "time_total_s": 2767.503056526184, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F31C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2767.503056526184, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 4.3921052631578945, "ram_util_percent": 47.5578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.3694885103638284}, "policy_0": {"total_loss": 0.3694885103638284, "policy_loss": -0.0002701256264001131, "vf_loss": 0.36004346351904226, "vf_loss_unclipped": 0.36004346351904226, "vf_explained_var": -0.16158176436424254, "entropy": 2.9557293512821197, "mean_kl_loss": 0.02129868910969417, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.72733468153777, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 668000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 27564.383, "sample_time_ms": 6372.288, "synch_weights_time_ms": 3.7}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 167, "trial_id": "2bb19_00000", "date": "2023-09-20_11-54-33", "timestamp": 1695203673, "time_this_iter_s": 27.45052218437195, "time_total_s": 2794.953578710556, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CAEF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2794.953578710556, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 4.410256410256411, "ram_util_percent": 47.599999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.4691095007916912}, "policy_0": {"total_loss": 0.4691095007916912, "policy_loss": 0.004521037381887436, "vf_loss": 0.45287457161033834, "vf_loss_unclipped": 0.46378000965202537, "vf_explained_var": -0.08701970283985137, "entropy": 3.1539097535133362, "mean_kl_loss": 0.017120327288280533, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.35716881808736, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 672000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 27550.733, "sample_time_ms": 6394.758, "synch_weights_time_ms": 3.8}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 168, "trial_id": "2bb19_00000", "date": "2023-09-20_11-55-01", "timestamp": 1695203701, "time_this_iter_s": 27.52042245864868, "time_total_s": 2822.4740011692047, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F03A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2822.4740011692047, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 3.6473684210526316, "ram_util_percent": 47.71052631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.6187212417975068}, "policy_0": {"total_loss": 0.6187212417975068, "policy_loss": 0.0007588425073772669, "vf_loss": 0.6107524623978208, "vf_loss_unclipped": 0.6195353981125425, "vf_explained_var": -0.11793507325649262, "entropy": 3.4261438101291657, "mean_kl_loss": 0.010537621312311967, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.43413385028214, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 676000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 27534.125, "sample_time_ms": 6399.767, "synch_weights_time_ms": 3.8}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 169, "trial_id": "2bb19_00000", "date": "2023-09-20_11-55-28", "timestamp": 1695203728, "time_this_iter_s": 27.318034410476685, "time_total_s": 2849.7920355796814, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F1B40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2849.7920355796814, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 3.728205128205128, "ram_util_percent": 47.78717948717948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.6400120986878872}, "policy_0": {"total_loss": 0.6400120986878872, "policy_loss": 0.003073047578334808, "vf_loss": 0.6286828802724793, "vf_loss_unclipped": 0.8284525402208283, "vf_explained_var": -0.21221359696388245, "entropy": 3.4925880466938017, "mean_kl_loss": 0.012066721791845338, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 144.47583349219988, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 680000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 27555.807, "sample_time_ms": 6450.644, "synch_weights_time_ms": 3.9}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 170, "trial_id": "2bb19_00000", "date": "2023-09-20_11-55-56", "timestamp": 1695203756, "time_this_iter_s": 27.688291788101196, "time_total_s": 2877.4803273677826, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F3E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2877.4803273677826, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 3.838461538461538, "ram_util_percent": 47.646153846153844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.5585958774842321}, "policy_0": {"total_loss": 1.5585958774842321, "policy_loss": 0.00042370173931121827, "vf_loss": 1.5520061457261638, "vf_loss_unclipped": 5.379603877316434, "vf_explained_var": -0.19965833473205566, "entropy": 3.3156022706985473, "mean_kl_loss": 0.009011906970588462, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.87161048998647, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 684000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 27496.827, "sample_time_ms": 6408.351, "synch_weights_time_ms": 4.0}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 171, "trial_id": "2bb19_00000", "date": "2023-09-20_11-56-23", "timestamp": 1695203783, "time_this_iter_s": 27.05199646949768, "time_total_s": 2904.5323238372803, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F2290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2904.5323238372803, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 5.207894736842106, "ram_util_percent": 47.21578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.3502729312829675}, "policy_0": {"total_loss": 2.3502729312829675, "policy_loss": -0.0012890758097171783, "vf_loss": 2.3425250525098336, "vf_loss_unclipped": 34.998741602383184, "vf_explained_var": -0.11384048609733581, "entropy": 3.385029935503006, "mean_kl_loss": 0.013207878726361378, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.40703883842113, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 688000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 27429.031, "sample_time_ms": 6367.51, "synch_weights_time_ms": 4.0}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 172, "trial_id": "2bb19_00000", "date": "2023-09-20_11-56-50", "timestamp": 1695203810, "time_this_iter_s": 27.137747049331665, "time_total_s": 2931.670070886612, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F35B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2931.670070886612, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 4.655263157894737, "ram_util_percent": 47.215789473684204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.514917493954301}, "policy_0": {"total_loss": 2.514917493954301, "policy_loss": -0.0026073151230812074, "vf_loss": 2.50630074013437, "vf_loss_unclipped": 149.5908582911369, "vf_explained_var": -0.0860595974445343, "entropy": 3.2522626526355745, "mean_kl_loss": 0.016404433130288817, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.56904226749447, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 692000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 27368.404, "sample_time_ms": 6336.155, "synch_weights_time_ms": 4.0}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 173, "trial_id": "2bb19_00000", "date": "2023-09-20_11-57-17", "timestamp": 1695203837, "time_this_iter_s": 26.92551040649414, "time_total_s": 2958.595581293106, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165CBB50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2958.595581293106, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 4.084210526315789, "ram_util_percent": 47.22105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.507385764968395}, "policy_0": {"total_loss": 2.507385764968395, "policy_loss": 0.0013583426862955094, "vf_loss": 2.5007555015327285, "vf_loss_unclipped": 398.75303299100415, "vf_explained_var": -0.10155115010738373, "entropy": 3.114870888376236, "mean_kl_loss": 0.007705127030731091, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.953350799392, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 696000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 27303.706, "sample_time_ms": 6352.424, "synch_weights_time_ms": 4.0}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 174, "trial_id": "2bb19_00000", "date": "2023-09-20_11-57-44", "timestamp": 1695203864, "time_this_iter_s": 27.220521450042725, "time_total_s": 2985.816102743149, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D689D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 2985.816102743149, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 3.1526315789473687, "ram_util_percent": 47.223684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.520594823330641}, "policy_0": {"total_loss": 2.520594823330641, "policy_loss": 0.00199261015355587, "vf_loss": 2.511734936026627, "vf_loss_unclipped": 1440.745454246978, "vf_explained_var": -0.02474903507232666, "entropy": 2.8366708373069764, "mean_kl_loss": 0.010036801774565538, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.13489417594573, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 700000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 27303.775, "sample_time_ms": 6339.873, "synch_weights_time_ms": 4.2}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 175, "trial_id": "2bb19_00000", "date": "2023-09-20_11-58-12", "timestamp": 1695203892, "time_this_iter_s": 27.37397027015686, "time_total_s": 3013.1900730133057, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F2290>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3013.1900730133057, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 3.663157894736842, "ram_util_percent": 46.971052631578935}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.446447648459766}, "policy_0": {"total_loss": 2.446447648459766, "policy_loss": -0.003718604850769043, "vf_loss": 2.441229628079851, "vf_loss_unclipped": 3914.4232958514153, "vf_explained_var": 0.01530586040019989, "entropy": 2.548465456867218, "mean_kl_loss": 0.013061248588700254, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6842092275619507}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.92959736048707, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 704000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 27308.099, "sample_time_ms": 6345.876, "synch_weights_time_ms": 4.1}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 176, "trial_id": "2bb19_00000", "date": "2023-09-20_11-58-39", "timestamp": 1695203919, "time_this_iter_s": 27.41247797012329, "time_total_s": 3040.602550983429, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F29E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3040.602550983429, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 3.356410256410256, "ram_util_percent": 47.24358974358974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.3218338573180139}, "policy_0": {"total_loss": 0.3218338573180139, "policy_loss": 0.00015514017939567565, "vf_loss": 0.3187553276533432, "vf_loss_unclipped": 2.305750185441429, "vf_explained_var": 0.01579100821018219, "entropy": 2.4405602821826933, "mean_kl_loss": 0.004272656181357161, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.34210461378097534}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.16949164592037, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 708000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 27299.796, "sample_time_ms": 6343.23, "synch_weights_time_ms": 4.201}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 177, "trial_id": "2bb19_00000", "date": "2023-09-20_11-59-07", "timestamp": 1695203947, "time_this_iter_s": 27.367491722106934, "time_total_s": 3067.970042705536, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F2680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3067.970042705536, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 3.8078947368421048, "ram_util_percent": 47.328947368421055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.06424412191957235}, "policy_0": {"total_loss": 0.06424412191957235, "policy_loss": 0.0012850452452898026, "vf_loss": 0.05960037573435311, "vf_loss_unclipped": 0.05960037573435311, "vf_explained_var": -0.0003559168815612793, "entropy": 2.4347211030483247, "mean_kl_loss": 0.009817760064429604, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.34210461378097534}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.60056495177025, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 712000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 27257.97, "sample_time_ms": 6305.649, "synch_weights_time_ms": 4.2}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 178, "trial_id": "2bb19_00000", "date": "2023-09-20_11-59-34", "timestamp": 1695203974, "time_this_iter_s": 27.10216736793518, "time_total_s": 3095.072210073471, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F03A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3095.072210073471, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 4.794871794871795, "ram_util_percent": 47.39743589743591}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.2127599473554641}, "policy_0": {"total_loss": 0.2127599473554641, "policy_loss": -0.0037185035854578018, "vf_loss": 0.2140264617252764, "vf_loss_unclipped": 0.2140781415272173, "vf_explained_var": 0.013875094532966615, "entropy": 2.5261315032958986, "mean_kl_loss": 0.007167366131160588, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.34210461378097534}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.09577867028548, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 716000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 27245.684, "sample_time_ms": 6286.219, "synch_weights_time_ms": 4.1}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 179, "trial_id": "2bb19_00000", "date": "2023-09-20_12-00-01", "timestamp": 1695204001, "time_this_iter_s": 27.195167303085327, "time_total_s": 3122.2673773765564, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D68F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3122.2673773765564, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 5.105263157894737, "ram_util_percent": 47.48684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.5369992644219659}, "policy_0": {"total_loss": 0.5369992644219659, "policy_loss": -0.000503132775425911, "vf_loss": 0.5345945561747181, "vf_loss_unclipped": 0.5681988105158436, "vf_explained_var": 0.02005445125102997, "entropy": 2.538824518966675, "mean_kl_loss": 0.00849986592229925, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.34210461378097534}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -113188.90175983722, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -28297.225439959348}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8546922337492683, "mean_inference_ms": 0.8121165867551404, "mean_action_processing_ms": 0.25272649589055607, "mean_env_wait_ms": 1.243156487020547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.005553828345404731, "ViewRequirementAgentConnector_ms": 0.47989024056328666}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.7030404028951, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 720000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 27185.191, "sample_time_ms": 6210.631, "synch_weights_time_ms": 4.1}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 180, "trial_id": "2bb19_00000", "date": "2023-09-20_12-00-28", "timestamp": 1695204028, "time_this_iter_s": 27.083365440368652, "time_total_s": 3149.350742816925, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D69AB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3149.350742816925, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 5.9447368421052635, "ram_util_percent": 47.547368421052624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.266880128364731}, "policy_0": {"total_loss": 6.266880128364731, "policy_loss": 0.00032490743659436703, "vf_loss": 6.265231910536066, "vf_loss_unclipped": 352.6339093699191, "vf_explained_var": 0.0125264897108078, "entropy": 5.085308784866333, "mean_kl_loss": 0.0038681792980650243, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.17105230689048767}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.7844933387715, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 724000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 27205.225, "sample_time_ms": 6232.282, "synch_weights_time_ms": 4.1}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 181, "trial_id": "2bb19_00000", "date": "2023-09-20_12-00-55", "timestamp": 1695204055, "time_this_iter_s": 27.254835605621338, "time_total_s": 3176.6055784225464, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F3B50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3176.6055784225464, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 4.621052631578947, "ram_util_percent": 47.610526315789464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.726513166711945}, "policy_0": {"total_loss": 5.726513166711945, "policy_loss": -0.0030497499136254193, "vf_loss": 5.7273785662435, "vf_loss_unclipped": 1024.3600783489012, "vf_explained_var": 0.0021701205253601076, "entropy": 4.675225470685959, "mean_kl_loss": 0.012770167720198879, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.17105230689048767}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.90312421017165, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 728000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 27214.533, "sample_time_ms": 6219.804, "synch_weights_time_ms": 4.1}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 182, "trial_id": "2bb19_00000", "date": "2023-09-20_12-01-23", "timestamp": 1695204083, "time_this_iter_s": 27.231420755386353, "time_total_s": 3203.8369991779327, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D69C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3203.8369991779327, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 4.989473684210527, "ram_util_percent": 47.65789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.600169755209516}, "policy_0": {"total_loss": 5.600169755209516, "policy_loss": -0.0032968349331989884, "vf_loss": 5.599705466073751, "vf_loss_unclipped": 2353.337786733526, "vf_explained_var": 0.021426050758361816, "entropy": 4.4341501257896425, "mean_kl_loss": 0.02198819414364989, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2565784454345703}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.98536477584057, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 732000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 27243.542, "sample_time_ms": 6211.225, "synch_weights_time_ms": 4.1}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 183, "trial_id": "2bb19_00000", "date": "2023-09-20_12-01-50", "timestamp": 1695204110, "time_this_iter_s": 27.215593814849854, "time_total_s": 3231.0525929927826, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D68EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3231.0525929927826, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 3.973684210526316, "ram_util_percent": 47.17894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.0357939556848255}, "policy_0": {"total_loss": 6.0357939556848255, "policy_loss": 0.013644782903790474, "vf_loss": 6.014107471793145, "vf_loss_unclipped": 1664.1666362504416, "vf_explained_var": -0.03300125961303711, "entropy": 4.1438985859744255, "mean_kl_loss": 0.03134210154611501, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.9056622040305, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 736000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 27207.854, "sample_time_ms": 6184.922, "synch_weights_time_ms": 4.1}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 184, "trial_id": "2bb19_00000", "date": "2023-09-20_12-02-17", "timestamp": 1695204137, "time_this_iter_s": 26.86464548110962, "time_total_s": 3257.917238473892, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6A3B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3257.917238473892, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 4.844736842105263, "ram_util_percent": 47.03157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.943936165090697}, "policy_0": {"total_loss": 2.943936165090697, "policy_loss": -0.001099814412742853, "vf_loss": 2.9422836336139766, "vf_loss_unclipped": 1407.0815938464646, "vf_explained_var": -0.042116004133224486, "entropy": 3.6951735026717185, "mean_kl_loss": 0.007151411796857428, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.39783045288954, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 740000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 27166.114, "sample_time_ms": 6164.612, "synch_weights_time_ms": 3.9}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 185, "trial_id": "2bb19_00000", "date": "2023-09-20_12-02-44", "timestamp": 1695204164, "time_this_iter_s": 26.95657205581665, "time_total_s": 3284.873810529709, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F3D90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3284.873810529709, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 4.721052631578946, "ram_util_percent": 47.01315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.5767107258852222}, "policy_0": {"total_loss": 0.5767107258852222, "policy_loss": -0.0035298396774451246, "vf_loss": 0.5775239205413715, "vf_loss_unclipped": 0.6055636374526874, "vf_explained_var": 0.05582390203475952, "entropy": 3.2889120943546297, "mean_kl_loss": 0.007058647149481021, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.91637990989744, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 744000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 27129.297, "sample_time_ms": 6141.305, "synch_weights_time_ms": 3.905}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 186, "trial_id": "2bb19_00000", "date": "2023-09-20_12-03-11", "timestamp": 1695204191, "time_this_iter_s": 27.044254064559937, "time_total_s": 3311.918064594269, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6A0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3311.918064594269, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 4.723684210526316, "ram_util_percent": 47.007894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.5061143976863474}, "policy_0": {"total_loss": 0.5061143976863474, "policy_loss": -0.00334389807600528, "vf_loss": 0.5041976256912929, "vf_loss_unclipped": 0.5353308126038295, "vf_explained_var": 0.06479485886096954, "entropy": 3.584107872533798, "mean_kl_loss": 0.013668767089109678, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.8976657593517, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 748000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 27097.321, "sample_time_ms": 6119.659, "synch_weights_time_ms": 3.805}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 187, "trial_id": "2bb19_00000", "date": "2023-09-20_12-03-38", "timestamp": 1695204218, "time_this_iter_s": 27.047727346420288, "time_total_s": 3338.965791940689, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D68CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3338.965791940689, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 4.66578947368421, "ram_util_percent": 47.02105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.42154498469890095}, "policy_0": {"total_loss": 0.42154498469890095, "policy_loss": -0.003085548473719973, "vf_loss": 0.4215311855167354, "vf_loss_unclipped": 0.4215311855167354, "vf_explained_var": 0.02625011169910431, "entropy": 3.955879059076309, "mean_kl_loss": 0.008053015748501275, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 147.923571095833, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 752000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 27091.403, "sample_time_ms": 6099.376, "synch_weights_time_ms": 3.805}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 188, "trial_id": "2bb19_00000", "date": "2023-09-20_12-04-05", "timestamp": 1695204245, "time_this_iter_s": 27.042991399765015, "time_total_s": 3366.008783340454, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6B130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3366.008783340454, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 4.671052631578947, "ram_util_percent": 47.063157894736825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.35515121193509547}, "policy_0": {"total_loss": 0.35515121193509547, "policy_loss": -0.0018722316350787878, "vf_loss": 0.35002129670261295, "vf_loss_unclipped": 0.35012373963474186, "vf_explained_var": 0.05182020993232727, "entropy": 4.358116518115997, "mean_kl_loss": 0.01819365734124094, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.36537805606238, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 756000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 27068.133, "sample_time_ms": 6097.295, "synch_weights_time_ms": 3.805}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 189, "trial_id": "2bb19_00000", "date": "2023-09-20_12-04-32", "timestamp": 1695204272, "time_this_iter_s": 26.962468147277832, "time_total_s": 3392.971251487732, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F3BE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3392.971251487732, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 4.6657894736842085, "ram_util_percent": 46.899999999999984}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.21950126008875667}, "policy_0": {"total_loss": 0.21950126008875667, "policy_loss": -0.005823273957893252, "vf_loss": 0.22228296547820484, "vf_loss_unclipped": 0.22228296547820484, "vf_explained_var": 0.013979853463172912, "entropy": 4.5591187878608705, "mean_kl_loss": 0.007902896858070744, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 142.1374878209981, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 760000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 27174.173, "sample_time_ms": 6176.47, "synch_weights_time_ms": 3.758}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 190, "trial_id": "2bb19_00000", "date": "2023-09-20_12-05-00", "timestamp": 1695204300, "time_this_iter_s": 28.1437726020813, "time_total_s": 3421.1150240898132, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D68F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3421.1150240898132, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 3.0717948717948715, "ram_util_percent": 47.102564102564095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.453050345164584}, "policy_0": {"total_loss": 0.453050345164584, "policy_loss": -0.004345634091086686, "vf_loss": 0.4549735859050206, "vf_loss_unclipped": 1.0350798037661961, "vf_explained_var": -0.005841134595870972, "entropy": 4.532605068969726, "mean_kl_loss": 0.006294093033862646, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 149.24667870368586, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 764000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 27129.217, "sample_time_ms": 6160.16, "synch_weights_time_ms": 3.758}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 191, "trial_id": "2bb19_00000", "date": "2023-09-20_12-05-27", "timestamp": 1695204327, "time_this_iter_s": 26.803266048431396, "time_total_s": 3447.9182901382446, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D68040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3447.9182901382446, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 5.384210526315789, "ram_util_percent": 47.097368421052636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.3736830043099355}, "policy_0": {"total_loss": 0.3736830043099355, "policy_loss": -0.00717093417942524, "vf_loss": 0.3772506409096701, "vf_loss_unclipped": 0.37725536712884733, "vf_explained_var": 0.017805591320991517, "entropy": 4.454362963104248, "mean_kl_loss": 0.009362421338852801, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.45181273017943, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 768000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 27100.811, "sample_time_ms": 6173.652, "synch_weights_time_ms": 3.758}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 192, "trial_id": "2bb19_00000", "date": "2023-09-20_12-05-54", "timestamp": 1695204354, "time_this_iter_s": 26.947770595550537, "time_total_s": 3474.866060733795, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6BBE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3474.866060733795, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 5.207894736842105, "ram_util_percent": 47.2157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.4938359506607987}, "policy_0": {"total_loss": 0.4938359506607987, "policy_loss": -0.003917922936379909, "vf_loss": 0.49536650685902095, "vf_loss_unclipped": 0.49536650685902095, "vf_explained_var": 0.019773899602890013, "entropy": 4.630731241989135, "mean_kl_loss": 0.006203086959626398, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.22970011910616, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 772000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 27077.966, "sample_time_ms": 6182.528, "synch_weights_time_ms": 3.758}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 193, "trial_id": "2bb19_00000", "date": "2023-09-20_12-06-21", "timestamp": 1695204381, "time_this_iter_s": 26.98714518547058, "time_total_s": 3501.8532059192657, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F1480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3501.8532059192657, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 5.9263157894736835, "ram_util_percent": 47.21315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.8287009777507744}, "policy_0": {"total_loss": 0.8287009777507744, "policy_loss": -0.003308778078854084, "vf_loss": 0.8298000741628974, "vf_loss_unclipped": 0.8393100196508735, "vf_explained_var": 0.03487621245384216, "entropy": 4.822293880939483, "mean_kl_loss": 0.005741415059340943, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 150.73249641533144, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 776000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 27045.409, "sample_time_ms": 6191.383, "synch_weights_time_ms": 3.658}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 194, "trial_id": "2bb19_00000", "date": "2023-09-20_12-06-48", "timestamp": 1695204408, "time_this_iter_s": 26.53907799720764, "time_total_s": 3528.3922839164734, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6B910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3528.3922839164734, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 5.21081081081081, "ram_util_percent": 47.2972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.5861148843817413}, "policy_0": {"total_loss": 0.5861148843817413, "policy_loss": -0.002904313075169921, "vf_loss": 0.5857542442365505, "vf_loss_unclipped": 0.5866452268644192, "vf_explained_var": 0.027146452569961548, "entropy": 4.946911705684662, "mean_kl_loss": 0.008483318866880472, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 150.0470723364251, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 780000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 27015.782, "sample_time_ms": 6200.288, "synch_weights_time_ms": 3.758}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 195, "trial_id": "2bb19_00000", "date": "2023-09-20_12-07-14", "timestamp": 1695204434, "time_this_iter_s": 26.660302877426147, "time_total_s": 3555.0525867938995, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6B1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3555.0525867938995, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 4.764864864864864, "ram_util_percent": 47.44864864864864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.8773716429304331}, "policy_0": {"total_loss": 0.8773716429304331, "policy_loss": -0.00321609380338341, "vf_loss": 0.8781536153609133, "vf_loss_unclipped": 0.881439695721326, "vf_explained_var": 0.03283647723197937, "entropy": 4.968080886650085, "mean_kl_loss": 0.006324552400792891, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.4380465464825, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 784000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 27006.178, "sample_time_ms": 6205.668, "synch_weights_time_ms": 3.753}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 196, "trial_id": "2bb19_00000", "date": "2023-09-20_12-07-41", "timestamp": 1695204461, "time_this_iter_s": 26.94926929473877, "time_total_s": 3582.0018560886383, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D8C0D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3582.0018560886383, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 4.815789473684212, "ram_util_percent": 47.58947368421051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.418122467829706}, "policy_0": {"total_loss": 2.418122467829706, "policy_loss": -0.0034525182593613864, "vf_loss": 2.4189634966512417, "vf_loss_unclipped": 241.53060025221305, "vf_explained_var": -0.08646270728111267, "entropy": 4.442856519460678, "mean_kl_loss": 0.0067854128294558905, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 148.8935638694668, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 788000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 26988.088, "sample_time_ms": 6218.219, "synch_weights_time_ms": 3.753}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 197, "trial_id": "2bb19_00000", "date": "2023-09-20_12-08-08", "timestamp": 1695204488, "time_this_iter_s": 26.866827726364136, "time_total_s": 3608.8686838150024, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6AD40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3608.8686838150024, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 4.9684210526315775, "ram_util_percent": 47.73947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.6539457375735043}, "policy_0": {"total_loss": 3.6539457375735043, "policy_loss": -0.0031503155779093505, "vf_loss": 3.651721917901584, "vf_loss_unclipped": 427.3744335154157, "vf_explained_var": -0.1953217675447464, "entropy": 4.289663115549088, "mean_kl_loss": 0.013963604197853965, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -109203.7308908614, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -27300.932722715417}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8545534785258424, "mean_inference_ms": 0.8118120410330208, "mean_action_processing_ms": 0.25261007233920857, "mean_env_wait_ms": 1.2426655752662754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.47690391540527344}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 149.61759138487727, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 792000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 26957.472, "sample_time_ms": 6218.976, "synch_weights_time_ms": 3.753}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 198, "trial_id": "2bb19_00000", "date": "2023-09-20_12-08-35", "timestamp": 1695204515, "time_this_iter_s": 26.736825227737427, "time_total_s": 3635.60550904274, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6B7F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3635.60550904274, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 4.902702702702701, "ram_util_percent": 47.902702702702705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.829223459944129}, "policy_0": {"total_loss": 7.829223459944129, "policy_loss": 0.002141804263368249, "vf_loss": 7.825913832700253, "vf_loss_unclipped": 161.66768031114339, "vf_explained_var": -0.026040076375007628, "entropy": 5.779716903114319, "mean_kl_loss": 0.0030342957740769633, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.19243383407592773}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -105099.79783606817, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -26274.949459017113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626, -65284.42181896898, -62836.51275730258], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845, -1726.9604404362365, -1207.7036972647327, -30863.95665775164, -31485.801023517084, -629.7064850834748, -182.87334734734594, -30637.7564103756, -31386.17651449658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8542696937436176, "mean_inference_ms": 0.8113359144515738, "mean_action_processing_ms": 0.25248881338527096, "mean_env_wait_ms": 1.2419658471707467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004544041373512961, "ViewRequirementAgentConnector_ms": 0.48810026862404565}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -105099.79783606817, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -26274.949459017113}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626, -65284.42181896898, -62836.51275730258], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845, -1726.9604404362365, -1207.7036972647327, -30863.95665775164, -31485.801023517084, -629.7064850834748, -182.87334734734594, -30637.7564103756, -31386.17651449658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8542696937436176, "mean_inference_ms": 0.8113359144515738, "mean_action_processing_ms": 0.25248881338527096, "mean_env_wait_ms": 1.2419658471707467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004544041373512961, "ViewRequirementAgentConnector_ms": 0.48810026862404565}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 141.4219105988166, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 796000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 27089.841, "sample_time_ms": 6243.228, "synch_weights_time_ms": 3.853}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 199, "trial_id": "2bb19_00000", "date": "2023-09-20_12-09-03", "timestamp": 1695204543, "time_this_iter_s": 28.286159992218018, "time_total_s": 3663.891669034958, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000017306D6BF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3663.891669034958, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 4.715, "ram_util_percent": 48.0875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.948806241117046}, "policy_0": {"total_loss": 5.948806241117046, "policy_loss": -0.002856615536659956, "vf_loss": 5.950082906544209, "vf_loss_unclipped": 98.6794080855012, "vf_explained_var": -0.0038562325954437254, "entropy": 5.881976652145386, "mean_kl_loss": 0.008210392274261721, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.19243383407592773}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -105099.79783606817, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -26274.949459017113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626, -65284.42181896898, -62836.51275730258], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845, -1726.9604404362365, -1207.7036972647327, -30863.95665775164, -31485.801023517084, -629.7064850834748, -182.87334734734594, -30637.7564103756, -31386.17651449658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8542696937436176, "mean_inference_ms": 0.8113359144515738, "mean_action_processing_ms": 0.25248881338527096, "mean_env_wait_ms": 1.2419658471707467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004544041373512961, "ViewRequirementAgentConnector_ms": 0.48810026862404565}}, "episode_reward_max": -5583.358065896639, "episode_reward_min": -299999.02925356146, "episode_reward_mean": -105099.79783606817, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -76467.98429356728}, "policy_reward_max": {"policy_0": 702.1051794774843}, "policy_reward_mean": {"policy_0": -26274.949459017113}, "hist_stats": {"episode_reward": [-299999.02925356146, -265537.08436641085, -208030.59953681752, -171973.9260044769, -11255.959064445136, -5583.358065896639, -99189.639528071, -146401.20294204753, -50812.191438059446, -61117.11385237205, -104610.27860514949, -128242.6987547644, -97796.37466223758, -74814.34444805178, -56179.24320825815, -68717.16916464856, -98613.98460815537, -88526.03417364578, -73688.5477989825, -72985.83834117626, -65284.42181896898, -62836.51275730258], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-76467.98429356728, -74402.01506285545, -75427.7714969806, -73701.25840015839, -63732.11628323525, -67998.24070619872, -65567.37226200456, -68239.35511497073, -42195.7558541202, -47913.938712049654, -53122.37586897697, -64798.52910167237, -22038.525112171974, -41945.1531314095, -46340.904789142616, -61649.342971751554, -4116.162813060737, -5775.5837402822, -1772.0315783012202, 407.81906719911603, -3493.106512335984, -3236.8815385407515, 444.52480550263755, 702.1051794774843, -18042.16268684317, -18621.573705962088, -34291.38622206615, -28234.516913199415, -258.4550593849694, -45272.358124211474, -55782.71193365668, -45087.67782479324, 261.73210562804155, -25867.033535140738, 408.56237180247547, -25615.452380350598, 112.4679545457056, -30824.96310409506, 400.5836862003992, -30805.20238902314, -12.91450087548425, -49406.728746802044, -32949.983354293545, -22240.652003177798, -24.652485753994757, -47547.55976223276, -45793.38488205341, -34877.10162472443, -15888.34637094615, -33250.13911179217, -33042.45226714351, -15615.436912357858, -21003.179797459936, -16209.167497734448, -16274.452361062871, -21327.544791795626, -2402.8405618257766, -26191.048723284188, -25784.594217385526, -1800.7597057628823, -3538.5551182551303, -30890.478424772304, -31330.913017537034, -2957.22260408364, -27434.423805646344, -14285.123786250457, -23161.810413058225, -33732.62660320144, -26384.96545753572, -12684.511329246918, -18231.078494466932, -31225.478892397103, 134.09808831222523, -7670.88423641162, -32927.673397862425, -33224.08825302153, 149.8786051887564, -6965.136688158489, -32946.91822017822, -33223.66203802845, -1726.9604404362365, -1207.7036972647327, -30863.95665775164, -31485.801023517084, -629.7064850834748, -182.87334734734594, -30637.7564103756, -31386.17651449658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8542696937436176, "mean_inference_ms": 0.8113359144515738, "mean_action_processing_ms": 0.25248881338527096, "mean_env_wait_ms": 1.2419658471707467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.004544041373512961, "ViewRequirementAgentConnector_ms": 0.48810026862404565}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 145.72257546123006, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 27020.606, "sample_time_ms": 6152.588, "synch_weights_time_ms": 3.9}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 22, "training_iteration": 200, "trial_id": "2bb19_00000", "date": "2023-09-20_12-09-31", "timestamp": 1695204571, "time_this_iter_s": 27.451417446136475, "time_total_s": 3691.3430864810944, "pid": 2188, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x00000173165F1480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 3691.3430864810944, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 4.992307692307693, "ram_util_percent": 48.26410256410257}}
