{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.35357799141407}, "policy_0": {"total_loss": 4.35357799141407, "policy_loss": -0.0015089551866054535, "vf_loss": 4.353484719753266, "vf_loss_unclipped": 6.118186935901642, "vf_explained_var": 0.009303682518005372, "entropy": 5.192080377197265, "mean_kl_loss": 0.008011106818076224, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 440.9577825615414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 9071.163, "sample_time_ms": 6787.297, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "302a8_00000", "date": "2023-09-20_10-32-25", "timestamp": 1695198745, "time_this_iter_s": 9.072163343429565, "time_total_s": 9.072163343429565, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 9.072163343429565, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.192307692307692, "ram_util_percent": 42.97692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.9531311558812856}, "policy_0": {"total_loss": 2.9531311558812856, "policy_loss": -0.0009709496557712555, "vf_loss": 2.9527020756304263, "vf_loss_unclipped": 3.283028059440851, "vf_explained_var": 0.015058237075805664, "entropy": 5.207374475097656, "mean_kl_loss": 0.007000238917686511, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 399.5964501753681, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 9540.631, "sample_time_ms": 7131.645, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "302a8_00000", "date": "2023-09-20_10-32-35", "timestamp": 1695198755, "time_this_iter_s": 10.011098861694336, "time_total_s": 19.0832622051239, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA9E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 19.0832622051239, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 4.135714285714287, "ram_util_percent": 42.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.431867398118973}, "policy_0": {"total_loss": 3.431867398118973, "policy_loss": -0.001818051116168499, "vf_loss": 3.431515823084116, "vf_loss_unclipped": 4.735607818704843, "vf_explained_var": -0.01015961103439331, "entropy": 5.254185190582275, "mean_kl_loss": 0.010848127377737547, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 405.91348108003484, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 9645.193, "sample_time_ms": 7244.595, "synch_weights_time_ms": 1.667}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "302a8_00000", "date": "2023-09-20_10-32-44", "timestamp": 1695198764, "time_this_iter_s": 9.855821132659912, "time_total_s": 28.939083337783813, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104B9C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 28.939083337783813, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 3.0357142857142856, "ram_util_percent": 43.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.1708954840540886}, "policy_0": {"total_loss": 3.1708954840540886, "policy_loss": -0.0027788717448711396, "vf_loss": 3.17158110229671, "vf_loss_unclipped": 4.573125473710895, "vf_explained_var": -0.03338849992752075, "entropy": 5.231286782836914, "mean_kl_loss": 0.010466185535222758, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 428.9860645887136, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9564.973, "sample_time_ms": 7213.558, "synch_weights_time_ms": 1.751}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "302a8_00000", "date": "2023-09-20_10-32-54", "timestamp": 1695198774, "time_this_iter_s": 9.326312065124512, "time_total_s": 38.265395402908325, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BB640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 38.265395402908325, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 3.0846153846153848, "ram_util_percent": 43.92307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.202890398487821}, "policy_0": {"total_loss": 6.202890398487821, "policy_loss": -0.0010075608968734742, "vf_loss": 6.202294762837886, "vf_loss_unclipped": 2775.1761246494652, "vf_explained_var": 0.0067502182006835935, "entropy": 5.284785287475586, "mean_kl_loss": 0.008016073983802927, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.20000000298023224}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 442.0338565067023, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9461.794, "sample_time_ms": 7129.357, "synch_weights_time_ms": 1.8}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "302a8_00000", "date": "2023-09-20_10-33-03", "timestamp": 1695198783, "time_this_iter_s": 9.050080299377441, "time_total_s": 47.31547570228577, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 47.31547570228577, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 3.553846153846154, "ram_util_percent": 43.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.908169907903671}, "policy_0": {"total_loss": 9.908169907903671, "policy_loss": -0.000514973258972168, "vf_loss": 9.90794857635498, "vf_loss_unclipped": 8213.577508285522, "vf_explained_var": -0.03332207088470459, "entropy": 5.4435058662414555, "mean_kl_loss": 0.003681547715865236, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 456.50931950539047, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9345.186, "sample_time_ms": 7040.624, "synch_weights_time_ms": 1.834}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 6, "trial_id": "302a8_00000", "date": "2023-09-20_10-33-12", "timestamp": 1695198792, "time_this_iter_s": 8.763142347335815, "time_total_s": 56.07861804962158, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050C790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 56.07861804962158, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 6.016666666666667, "ram_util_percent": 43.908333333333324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.992634866333008}, "policy_0": {"total_loss": 9.992634866333008, "policy_loss": -0.00208631726205349, "vf_loss": 9.994172438049317, "vf_loss_unclipped": 10897.2241859375, "vf_explained_var": -0.029093936347961424, "entropy": 5.447057857513427, "mean_kl_loss": 0.005486988148583623, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.9447564434773, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9236.546, "sample_time_ms": 6957.667, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 7, "trial_id": "302a8_00000", "date": "2023-09-20_10-33-20", "timestamp": 1695198800, "time_this_iter_s": 8.585708379745483, "time_total_s": 64.66432642936707, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050D1B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 64.66432642936707, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 4.984615384615385, "ram_util_percent": 43.89230769230768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.995992645263671}, "policy_0": {"total_loss": 9.995992645263671, "policy_loss": 0.00033579463362693786, "vf_loss": 9.995226007080078, "vf_loss_unclipped": 23775.52644609375, "vf_explained_var": -0.007327176666259766, "entropy": 5.375462549591065, "mean_kl_loss": 0.004308216800335504, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.24283039085424, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9149.8, "sample_time_ms": 6882.801, "synch_weights_time_ms": 1.938}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 8, "trial_id": "302a8_00000", "date": "2023-09-20_10-33-29", "timestamp": 1695198809, "time_this_iter_s": 8.544579029083252, "time_total_s": 73.20890545845032, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 73.20890545845032, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 5.375, "ram_util_percent": 43.89166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.997432847595215}, "policy_0": {"total_loss": 9.997432847595215, "policy_loss": 0.0007628728836774826, "vf_loss": 9.996249061584473, "vf_loss_unclipped": 37707.65937148438, "vf_explained_var": 0.008466116046905517, "entropy": 5.28894139251709, "mean_kl_loss": 0.008418722435987729, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 448.086578496122, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 9125.027, "sample_time_ms": 6870.743, "synch_weights_time_ms": 1.945}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 9, "trial_id": "302a8_00000", "date": "2023-09-20_10-33-38", "timestamp": 1695198818, "time_this_iter_s": 8.928847312927246, "time_total_s": 82.13775277137756, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 82.13775277137756, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 5.3500000000000005, "ram_util_percent": 43.89166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.997806468963622}, "policy_0": {"total_loss": 9.997806468963622, "policy_loss": 0.00023682665824890136, "vf_loss": 9.997219883728027, "vf_loss_unclipped": 51881.71193125, "vf_explained_var": -0.05582336912155152, "entropy": 5.321466760253906, "mean_kl_loss": 0.006994654010926024, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 451.0403205014637, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 9099.363, "sample_time_ms": 6855.378, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 10, "trial_id": "302a8_00000", "date": "2023-09-20_10-33-47", "timestamp": 1695198827, "time_this_iter_s": 8.870386123657227, "time_total_s": 91.00813889503479, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BB520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 91.00813889503479, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 5.776923076923078, "ram_util_percent": 43.43076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.99657783355713}, "policy_0": {"total_loss": 9.99657783355713, "policy_loss": 9.822938069701194e-05, "vf_loss": 9.996167456054687, "vf_loss_unclipped": 44329.94325820312, "vf_explained_var": -0.03242890777587891, "entropy": 5.2592620849609375, "mean_kl_loss": 0.006242459244571365, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 452.5174217773545, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 9076.191, "sample_time_ms": 6845.684, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 11, "trial_id": "302a8_00000", "date": "2023-09-20_10-33-55", "timestamp": 1695198835, "time_this_iter_s": 8.841438293457031, "time_total_s": 99.84957718849182, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10136440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 99.84957718849182, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 5.091666666666667, "ram_util_percent": 43.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.996017714691162}, "policy_0": {"total_loss": 9.996017714691162, "policy_loss": -0.00046513254344463347, "vf_loss": 9.996085182189942, "vf_loss_unclipped": 41619.53281796875, "vf_explained_var": -0.0860518219947815, "entropy": 5.259848766326904, "mean_kl_loss": 0.00795306290955632, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 439.1530373793552, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 8986.025, "sample_time_ms": 6781.635, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 12, "trial_id": "302a8_00000", "date": "2023-09-20_10-34-05", "timestamp": 1695198845, "time_this_iter_s": 9.110442638397217, "time_total_s": 108.96001982688904, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050C790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 108.96001982688904, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 7.207692307692307, "ram_util_percent": 42.56153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.995306430053711}, "policy_0": {"total_loss": 9.995306430053711, "policy_loss": 4.6821749210357664e-05, "vf_loss": 9.994987680053711, "vf_loss_unclipped": 31847.928080859376, "vf_explained_var": -0.00820269136428833, "entropy": 5.197759851074219, "mean_kl_loss": 0.005438864688157628, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 433.74534085890036, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 8922.794, "sample_time_ms": 6728.972, "synch_weights_time_ms": 2.05}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 13, "trial_id": "302a8_00000", "date": "2023-09-20_10-34-14", "timestamp": 1695198854, "time_this_iter_s": 9.22300124168396, "time_total_s": 118.183021068573, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050C040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 118.183021068573, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 7.938461538461537, "ram_util_percent": 40.79230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.992713102722169}, "policy_0": {"total_loss": 9.992713102722169, "policy_loss": -0.0014271633863449096, "vf_loss": 9.99371404876709, "vf_loss_unclipped": 32276.421938671876, "vf_explained_var": -0.07568746175765992, "entropy": 5.09455212020874, "mean_kl_loss": 0.008524681470583892, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 442.36014940332507, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 8894.603, "sample_time_ms": 6703.206, "synch_weights_time_ms": 2.068}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 14, "trial_id": "302a8_00000", "date": "2023-09-20_10-34-23", "timestamp": 1695198863, "time_this_iter_s": 9.0445396900177, "time_total_s": 127.2275607585907, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 127.2275607585907, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 7.153846153846154, "ram_util_percent": 40.815384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.176822727429867}, "policy_0": {"total_loss": 9.176822727429867, "policy_loss": 0.00032380270659923554, "vf_loss": 9.175877311873435, "vf_loss_unclipped": 11845.495378969168, "vf_explained_var": -0.009464982795715332, "entropy": 5.13860835723877, "mean_kl_loss": 0.012431921865651384, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 473.97653166933, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 8833.618, "sample_time_ms": 6656.522, "synch_weights_time_ms": 2.168}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 15, "trial_id": "302a8_00000", "date": "2023-09-20_10-34-31", "timestamp": 1695198871, "time_this_iter_s": 8.440236806869507, "time_total_s": 135.6677975654602, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050EDD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 135.6677975654602, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 7.625, "ram_util_percent": 40.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.844523726797103}, "policy_0": {"total_loss": 8.844523726797103, "policy_loss": -0.0003211636155843735, "vf_loss": 8.844433024942875, "vf_loss_unclipped": 11047.20111044079, "vf_explained_var": -0.035146517086029054, "entropy": 5.164528852081299, "mean_kl_loss": 0.008237326429085806, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 478.96734633552444, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 64000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 8792.534, "sample_time_ms": 6619.262, "synch_weights_time_ms": 2.168}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 16, "trial_id": "302a8_00000", "date": "2023-09-20_10-34-40", "timestamp": 1695198880, "time_this_iter_s": 8.353299617767334, "time_total_s": 144.02109718322754, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 144.02109718322754, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 7.054545454545456, "ram_util_percent": 39.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.610629248593748}, "policy_0": {"total_loss": 6.610629248593748, "policy_loss": 0.00032840509414672854, "vf_loss": 6.609835458594561, "vf_loss_unclipped": 9068.801368199569, "vf_explained_var": -0.10531609210968018, "entropy": 4.995751094818115, "mean_kl_loss": 0.009307569389508717, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 481.0477731892248, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 68000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 8765.582, "sample_time_ms": 6593.919, "synch_weights_time_ms": 2.068}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 17, "trial_id": "302a8_00000", "date": "2023-09-20_10-34-48", "timestamp": 1695198888, "time_this_iter_s": 8.317182064056396, "time_total_s": 152.33827924728394, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BB880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 152.33827924728394, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 6.633333333333333, "ram_util_percent": 39.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.52367634113282}, "policy_0": {"total_loss": 6.52367634113282, "policy_loss": -0.0008425867021083831, "vf_loss": 6.523717167973518, "vf_loss_unclipped": 9048.65010333817, "vf_explained_var": -0.04397865810394287, "entropy": 4.981423969268799, "mean_kl_loss": 0.01603584462374347, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 481.8477118329872, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 72000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 8741.462, "sample_time_ms": 6577.517, "synch_weights_time_ms": 2.018}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 0, "training_iteration": 18, "trial_id": "302a8_00000", "date": "2023-09-20_10-34-56", "timestamp": 1695198896, "time_this_iter_s": 8.303883790969849, "time_total_s": 160.64216303825378, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050C8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 160.64216303825378, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 6.441666666666667, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.00259890190307}, "policy_0": {"total_loss": 5.00259890190307, "policy_loss": 0.0006479879923164845, "vf_loss": 5.001273285409808, "vf_loss_unclipped": 13.405630463334917, "vf_explained_var": -0.02624905786514282, "entropy": 4.333381786346435, "mean_kl_loss": 0.013552549583336805, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 464.00329933986654, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 76000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 8710.84, "sample_time_ms": 6552.132, "synch_weights_time_ms": 2.018}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 19, "trial_id": "302a8_00000", "date": "2023-09-20_10-35-05", "timestamp": 1695198905, "time_this_iter_s": 8.623630046844482, "time_total_s": 169.26579308509827, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050C5E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 169.26579308509827, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 6.300000000000001, "ram_util_percent": 39.19166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.10095726222992}, "policy_0": {"total_loss": 4.10095726222992, "policy_loss": -0.0010243769370019435, "vf_loss": 4.101468662011623, "vf_loss_unclipped": 10.748690341317653, "vf_explained_var": -0.022892962646484376, "entropy": 4.3421868904113765, "mean_kl_loss": 0.0102594620246673, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 475.902744851533, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 80000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 8664.509, "sample_time_ms": 6507.884, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 20, "trial_id": "302a8_00000", "date": "2023-09-20_10-35-13", "timestamp": 1695198913, "time_this_iter_s": 8.40707802772522, "time_total_s": 177.6728711128235, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050D120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 177.6728711128235, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 6.749999999999999, "ram_util_percent": 39.208333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.4549327438056467}, "policy_0": {"total_loss": 3.4549327438056467, "policy_loss": -0.0025047293096780777, "vf_loss": 3.456669740672782, "vf_loss_unclipped": 5.424714087672904, "vf_explained_var": -0.0030845088005065917, "entropy": 4.287753856658935, "mean_kl_loss": 0.015354672497467255, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.7129844402026, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 84000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 8617.888, "sample_time_ms": 6459.727, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 21, "trial_id": "302a8_00000", "date": "2023-09-20_10-35-22", "timestamp": 1695198922, "time_this_iter_s": 8.375228643417358, "time_total_s": 186.04809975624084, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 186.04809975624084, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 6.983333333333333, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.845224004472792}, "policy_0": {"total_loss": 4.845224004472792, "policy_loss": -0.002752149264514446, "vf_loss": 4.847263981541992, "vf_loss_unclipped": 2189.5250254729362, "vf_explained_var": 0.005212775993347168, "entropy": 4.582319341278076, "mean_kl_loss": 0.014243349541083444, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 474.9636081550006, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 88000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 8549.214, "sample_time_ms": 6403.232, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 22, "trial_id": "302a8_00000", "date": "2023-09-20_10-35-30", "timestamp": 1695198930, "time_this_iter_s": 8.42369818687439, "time_total_s": 194.47179794311523, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BB880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 194.47179794311523, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 7.454545454545453, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.800425033614971}, "policy_0": {"total_loss": 5.800425033614971, "policy_loss": -0.0002231223702430725, "vf_loss": 5.8000910072565075, "vf_loss_unclipped": 4465.565402229333, "vf_explained_var": -0.05555817527770996, "entropy": 4.9078364761352535, "mean_kl_loss": 0.011143009429314406, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.9297136731245, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 92000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 8474.597, "sample_time_ms": 6336.559, "synch_weights_time_ms": 2.118}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 23, "trial_id": "302a8_00000", "date": "2023-09-20_10-35-39", "timestamp": 1695198939, "time_this_iter_s": 8.47783875465393, "time_total_s": 202.94963669776917, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BBD90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 202.94963669776917, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 7.341666666666666, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.291166114079952}, "policy_0": {"total_loss": 7.291166114079952, "policy_loss": -0.00018054486364126206, "vf_loss": 7.290642488095164, "vf_loss_unclipped": 12888.149576787946, "vf_explained_var": -0.01517219123840332, "entropy": 4.990090200805664, "mean_kl_loss": 0.014083312352769281, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.400330079944, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 96000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 8418.893, "sample_time_ms": 6282.153, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 24, "trial_id": "302a8_00000", "date": "2023-09-20_10-35-47", "timestamp": 1695198947, "time_this_iter_s": 8.486357688903809, "time_total_s": 211.43599438667297, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050F250>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 211.43599438667297, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 7.166666666666667, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.912885052895547}, "policy_0": {"total_loss": 8.912885052895547, "policy_loss": 0.002331235684454441, "vf_loss": 8.910261487650871, "vf_loss_unclipped": 34531.26085583503, "vf_explained_var": -0.016926316261291503, "entropy": 5.345753705596924, "mean_kl_loss": 0.005846855731945834, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 473.64244901923087, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 100000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 8419.488, "sample_time_ms": 6277.318, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 25, "trial_id": "302a8_00000", "date": "2023-09-20_10-35-56", "timestamp": 1695198956, "time_this_iter_s": 8.447189569473267, "time_total_s": 219.88318395614624, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 219.88318395614624, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 7.108333333333333, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.874238325965404}, "policy_0": {"total_loss": 8.874238325965404, "policy_loss": 0.0004479500845074654, "vf_loss": 8.873384132432937, "vf_loss_unclipped": 34751.31072542577, "vf_explained_var": -0.02418268508911133, "entropy": 5.289365119552612, "mean_kl_loss": 0.008124933972477447, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.7839623126574, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 104000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 8443.125, "sample_time_ms": 6297.417, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 26, "trial_id": "302a8_00000", "date": "2023-09-20_10-36-04", "timestamp": 1695198964, "time_this_iter_s": 8.589672088623047, "time_total_s": 228.4728560447693, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050F5B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 228.4728560447693, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 8.874999999999998, "ram_util_percent": 39.208333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.817490082120896}, "policy_0": {"total_loss": 8.817490082120896, "policy_loss": -0.00035721497535705566, "vf_loss": 8.817485334575176, "vf_loss_unclipped": 26511.958897085176, "vf_explained_var": -0.002235530662536621, "entropy": 5.244137113189697, "mean_kl_loss": 0.007239027312231701, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.18695218719597, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 108000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 8462.332, "sample_time_ms": 6312.63, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 27, "trial_id": "302a8_00000", "date": "2023-09-20_10-36-13", "timestamp": 1695198973, "time_this_iter_s": 8.508254289627075, "time_total_s": 236.98111033439636, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050FE20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 236.98111033439636, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 9.374999999999998, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.881836476665736}, "policy_0": {"total_loss": 8.881836476665736, "policy_loss": 0.00608888132572174, "vf_loss": 8.875411135578155, "vf_loss_unclipped": 18525.775731837177, "vf_explained_var": 0.00022691011428833008, "entropy": 5.312111894607544, "mean_kl_loss": 0.006730070530090598, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.7573857848306, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 112000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 8487.339, "sample_time_ms": 6332.437, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 28, "trial_id": "302a8_00000", "date": "2023-09-20_10-36-21", "timestamp": 1695198981, "time_this_iter_s": 8.552441596984863, "time_total_s": 245.53355193138123, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10590700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 245.53355193138123, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 9.415384615384616, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.854901053242385}, "policy_0": {"total_loss": 8.854901053242385, "policy_loss": -0.00010483908653259277, "vf_loss": 8.854743281784653, "vf_loss_unclipped": 17729.500515896263, "vf_explained_var": 0.0015746434211730957, "entropy": 5.336481893157959, "mean_kl_loss": 0.005252494500533066, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 466.28624587512775, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 116000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 8483.018, "sample_time_ms": 6317.508, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 29, "trial_id": "302a8_00000", "date": "2023-09-20_10-36-30", "timestamp": 1695198990, "time_this_iter_s": 8.580421209335327, "time_total_s": 254.11397314071655, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050F5B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 254.11397314071655, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 8.08333333333333, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.538532662193477}, "policy_0": {"total_loss": 8.538532662193477, "policy_loss": 0.001755915802717209, "vf_loss": 8.53629228709936, "vf_loss_unclipped": 12889.823991865574, "vf_explained_var": 0.007775196743011474, "entropy": 5.043679497909546, "mean_kl_loss": 0.009688717592670582, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.348144890162, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 120000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 8494.756, "sample_time_ms": 6325.169, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 30, "trial_id": "302a8_00000", "date": "2023-09-20_10-36-38", "timestamp": 1695198998, "time_this_iter_s": 8.523458480834961, "time_total_s": 262.6374316215515, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050C790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 262.6374316215515, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 7.641666666666665, "ram_util_percent": 39.208333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.029780343443155}, "policy_0": {"total_loss": 9.029780343443155, "policy_loss": 0.0008409153446555138, "vf_loss": 9.028322426229716, "vf_loss_unclipped": 12732.895631866842, "vf_explained_var": 0.004923055458068848, "entropy": 4.949974934768677, "mean_kl_loss": 0.012340085660654585, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.7161267012931, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 124000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 8512.653, "sample_time_ms": 6342.468, "synch_weights_time_ms": 2.601}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 31, "trial_id": "302a8_00000", "date": "2023-09-20_10-36-47", "timestamp": 1695199007, "time_this_iter_s": 8.553698062896729, "time_total_s": 271.19112968444824, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 271.19112968444824, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 7.224999999999999, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.571633569309489}, "policy_0": {"total_loss": 8.571633569309489, "policy_loss": 0.0008425499707460404, "vf_loss": 8.570149408614636, "vf_loss_unclipped": 14551.259217178618, "vf_explained_var": 0.0042326133728027345, "entropy": 5.070067347335815, "mean_kl_loss": 0.012831702008683351, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.79141724575834, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 128000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 8523.741, "sample_time_ms": 6350.24, "synch_weights_time_ms": 2.601}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 32, "trial_id": "302a8_00000", "date": "2023-09-20_10-36-56", "timestamp": 1695199016, "time_this_iter_s": 8.533578634262085, "time_total_s": 279.7247083187103, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA8C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 279.7247083187103, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 7.633333333333334, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.9726343549147245}, "policy_0": {"total_loss": 7.9726343549147245, "policy_loss": 0.0045094677954912185, "vf_loss": 7.967557728147507, "vf_loss_unclipped": 13386.21937711978, "vf_explained_var": 0.0007707141876220703, "entropy": 5.036250854873657, "mean_kl_loss": 0.011343168131410494, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.8610611366092, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 132000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 8531.112, "sample_time_ms": 6361.063, "synch_weights_time_ms": 2.601}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 33, "trial_id": "302a8_00000", "date": "2023-09-20_10-37-04", "timestamp": 1695199024, "time_this_iter_s": 8.551546812057495, "time_total_s": 288.2762551307678, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BBBE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 288.2762551307678, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 7.683333333333333, "ram_util_percent": 39.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.974080315744877}, "policy_0": {"total_loss": 7.974080315744877, "policy_loss": 0.0007094939097762108, "vf_loss": 7.972794351959228, "vf_loss_unclipped": 13524.101446300889, "vf_explained_var": 0.003014871597290039, "entropy": 4.914416121292114, "mean_kl_loss": 0.011529316965158796, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 463.32288842766775, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 136000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 8545.905, "sample_time_ms": 6373.369, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 34, "trial_id": "302a8_00000", "date": "2023-09-20_10-37-13", "timestamp": 1695199033, "time_this_iter_s": 8.63528823852539, "time_total_s": 296.9115433692932, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10590C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 296.9115433692932, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 7.883333333333334, "ram_util_percent": 39.24166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.69205978999138}, "policy_0": {"total_loss": 8.69205978999138, "policy_loss": 0.0019458938598632812, "vf_loss": 8.689570639783144, "vf_loss_unclipped": 15576.782623001462, "vf_explained_var": 0.0059271605491638185, "entropy": 5.1270486385345455, "mean_kl_loss": 0.010865167838329217, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.33164403045186, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 140000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 8560.988, "sample_time_ms": 6388.481, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 35, "trial_id": "302a8_00000", "date": "2023-09-20_10-37-21", "timestamp": 1695199041, "time_this_iter_s": 8.598019123077393, "time_total_s": 305.5095624923706, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105911B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 305.5095624923706, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 7.433333333333333, "ram_util_percent": 39.25833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.879410181045532}, "policy_0": {"total_loss": 9.879410181045532, "policy_loss": 0.0028988753743469714, "vf_loss": 9.876229288494587, "vf_loss_unclipped": 19598.12523850404, "vf_explained_var": 0.010612298965454101, "entropy": 5.517376315689087, "mean_kl_loss": 0.005639802342595067, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}}, "episode_reward_max": -139999.85136127225, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -151723.26057908143, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -53964.01236045717}, "policy_reward_max": {"policy_0": -22022.829813976216}, "policy_reward_mean": {"policy_0": -37930.815144770604}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064], "episode_lengths": [36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8733294605628454, "mean_inference_ms": 0.8384408751543169, "mean_action_processing_ms": 0.2622989656950234, "mean_env_wait_ms": 1.2865648913115584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.5000114440917969}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.67325612995563, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 144000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 8561.192, "sample_time_ms": 6385.314, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 36, "trial_id": "302a8_00000", "date": "2023-09-20_10-37-30", "timestamp": 1695199050, "time_this_iter_s": 8.591713905334473, "time_total_s": 314.1012763977051, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BBBE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 314.1012763977051, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 7.375000000000001, "ram_util_percent": 39.25833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.380156700706482}, "policy_0": {"total_loss": 7.380156700706482, "policy_loss": 0.002326468677818775, "vf_loss": 7.37710114992112, "vf_loss_unclipped": 39.94409057252854, "vf_explained_var": 0.02491243782043457, "entropy": 2.389116982650757, "mean_kl_loss": 0.014582104751840234, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 455.024732446895, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 148000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 8589.54, "sample_time_ms": 6411.717, "synch_weights_time_ms": 2.501}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 37, "trial_id": "302a8_00000", "date": "2023-09-20_10-37-39", "timestamp": 1695199059, "time_this_iter_s": 8.79273009300232, "time_total_s": 322.8940064907074, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050F1C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 322.8940064907074, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 6.653846153846155, "ram_util_percent": 39.26923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.12484984126985}, "policy_0": {"total_loss": 5.12484984126985, "policy_loss": 0.0005171070456504821, "vf_loss": 5.123642663937807, "vf_loss_unclipped": 8.758646555310488, "vf_explained_var": -0.009876119995117187, "entropy": 2.316248892211914, "mean_kl_loss": 0.013801332072447985, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.32924397051335, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 152000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 8572.392, "sample_time_ms": 6394.223, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 38, "trial_id": "302a8_00000", "date": "2023-09-20_10-37-47", "timestamp": 1695199067, "time_this_iter_s": 8.380961894989014, "time_total_s": 331.2749683856964, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050FD00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 331.2749683856964, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 7.009090909090909, "ram_util_percent": 39.22727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.298009122754261}, "policy_0": {"total_loss": 3.298009122754261, "policy_loss": -0.0006176631242036819, "vf_loss": 3.297984747751057, "vf_loss_unclipped": 5.741668529184163, "vf_explained_var": 0.002186758327484131, "entropy": 2.2642054603576662, "mean_kl_loss": 0.012840715948794969, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 474.6317450230861, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 156000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 8557.408, "sample_time_ms": 6381.276, "synch_weights_time_ms": 2.202}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 39, "trial_id": "302a8_00000", "date": "2023-09-20_10-37-56", "timestamp": 1695199076, "time_this_iter_s": 8.429586172103882, "time_total_s": 339.7045545578003, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 339.7045545578003, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 6.858333333333333, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.50405574220866}, "policy_0": {"total_loss": 6.50405574220866, "policy_loss": -0.003037198407948017, "vf_loss": 6.5061124316394325, "vf_loss_unclipped": 3472.1496485179127, "vf_explained_var": 0.010562504959106446, "entropy": 3.645750359344482, "mean_kl_loss": 0.019610459742386593, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.5514007175741, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 160000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 8553.426, "sample_time_ms": 6377.992, "synch_weights_time_ms": 2.102}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 40, "trial_id": "302a8_00000", "date": "2023-09-20_10-38-04", "timestamp": 1695199084, "time_this_iter_s": 8.484637975692749, "time_total_s": 348.18919253349304, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10590820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 348.18919253349304, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 7.583333333333332, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.38794601908326}, "policy_0": {"total_loss": 9.38794601908326, "policy_loss": 0.016261799679230898, "vf_loss": 9.370696023488044, "vf_loss_unclipped": 11979.561591962743, "vf_explained_var": 0.007826624488830567, "entropy": 5.3582238698959355, "mean_kl_loss": 0.01976412603436038, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.9516340083851, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 164000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 8549.358, "sample_time_ms": 6375.332, "synch_weights_time_ms": 2.002}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 41, "trial_id": "302a8_00000", "date": "2023-09-20_10-38-13", "timestamp": 1695199093, "time_this_iter_s": 8.51351284980774, "time_total_s": 356.7027053833008, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591630>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 356.7027053833008, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 6.633333333333333, "ram_util_percent": 39.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.807326812686027}, "policy_0": {"total_loss": 8.807326812686027, "policy_loss": -0.0005448267698287964, "vf_loss": 8.807523730283975, "vf_loss_unclipped": 17515.088340020375, "vf_explained_var": 0.0007589549064636231, "entropy": 5.3517754249572755, "mean_kl_loss": 0.006959250631917166, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.4592786884769, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 168000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 8548.144, "sample_time_ms": 6376.259, "synch_weights_time_ms": 2.002}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 42, "trial_id": "302a8_00000", "date": "2023-09-20_10-38-21", "timestamp": 1695199101, "time_this_iter_s": 8.521440029144287, "time_total_s": 365.22414541244507, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050FF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 365.22414541244507, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 6.75, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.242535302215815}, "policy_0": {"total_loss": 8.242535302215815, "policy_loss": 0.0015880368184298277, "vf_loss": 8.240116558408737, "vf_loss_unclipped": 13090.619029004622, "vf_explained_var": -0.0022701004028320313, "entropy": 5.009689150238037, "mean_kl_loss": 0.016613713965830175, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.63772423937013, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 172000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 8546.627, "sample_time_ms": 6375.381, "synch_weights_time_ms": 2.002}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 43, "trial_id": "302a8_00000", "date": "2023-09-20_10-38-30", "timestamp": 1695199110, "time_this_iter_s": 8.537378311157227, "time_total_s": 373.7615237236023, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10592170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 373.7615237236023, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 6.533333333333332, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.063833239331842}, "policy_0": {"total_loss": 8.063833239331842, "policy_loss": 0.0031170735981315375, "vf_loss": 8.059770520687103, "vf_loss_unclipped": 12843.358203360653, "vf_explained_var": -0.002407456684112549, "entropy": 5.032720341110229, "mean_kl_loss": 0.01891329531132724, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.3233751856971, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 176000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 8533.777, "sample_time_ms": 6366.258, "synch_weights_time_ms": 1.901}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 44, "trial_id": "302a8_00000", "date": "2023-09-20_10-38-38", "timestamp": 1695199118, "time_this_iter_s": 8.506786346435547, "time_total_s": 382.26831007003784, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050F0A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 382.26831007003784, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 6.541666666666667, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.99655246759057}, "policy_0": {"total_loss": 7.99655246759057, "policy_loss": -0.000830258908867836, "vf_loss": 7.9968075164943935, "vf_loss_unclipped": 8629.795087055794, "vf_explained_var": 0.0002706950187683105, "entropy": 4.522439171028137, "mean_kl_loss": 0.01150434603779504, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.77699990030106, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 180000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 8523.834, "sample_time_ms": 6353.82, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 45, "trial_id": "302a8_00000", "date": "2023-09-20_10-38-47", "timestamp": 1695199127, "time_this_iter_s": 8.498591423034668, "time_total_s": 390.7669014930725, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 390.7669014930725, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 7.025000000000001, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.9759122134122995}, "policy_0": {"total_loss": 7.9759122134122995, "policy_loss": -0.003070784741640091, "vf_loss": 7.97771317782402, "vf_loss_unclipped": 8679.35761863017, "vf_explained_var": 0.004218241596221924, "entropy": 4.555374663734436, "mean_kl_loss": 0.025396740177915125, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 466.55264912258116, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 184000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 8522.215, "sample_time_ms": 6351.604, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 46, "trial_id": "302a8_00000", "date": "2023-09-20_10-38-55", "timestamp": 1695199135, "time_this_iter_s": 8.574522733688354, "time_total_s": 399.34142422676086, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 399.34142422676086, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 7.0, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.37764506636262}, "policy_0": {"total_loss": 8.37764506636262, "policy_loss": 0.0007414188981056213, "vf_loss": 8.37610539855957, "vf_loss_unclipped": 8589.38825832882, "vf_explained_var": 0.005299068450927734, "entropy": 4.553411346244812, "mean_kl_loss": 0.010643586763913117, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 464.2180661815862, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 188000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 8504.806, "sample_time_ms": 6332.371, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 47, "trial_id": "302a8_00000", "date": "2023-09-20_10-39-04", "timestamp": 1695199144, "time_this_iter_s": 8.617640256881714, "time_total_s": 407.9590644836426, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105917E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 407.9590644836426, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 6.6923076923076925, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.369226604890823}, "policy_0": {"total_loss": 8.369226604890823, "policy_loss": 0.0007312982261180878, "vf_loss": 8.367858937728405, "vf_loss_unclipped": 8399.699956055725, "vf_explained_var": 0.0009324771881103515, "entropy": 4.560827911376953, "mean_kl_loss": 0.008484507700929499, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.07500000298023224}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.29122468220993, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 192000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 8526.487, "sample_time_ms": 6351.533, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 48, "trial_id": "302a8_00000", "date": "2023-09-20_10-39-13", "timestamp": 1695199153, "time_this_iter_s": 8.598766565322876, "time_total_s": 416.55783104896545, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105901F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 416.55783104896545, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 7.383333333333333, "ram_util_percent": 39.291666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.209636627161503}, "policy_0": {"total_loss": 9.209636627161503, "policy_loss": 0.002341516272723675, "vf_loss": 9.205460223197937, "vf_loss_unclipped": 8345.055884118081, "vf_explained_var": -0.00037908658981323243, "entropy": 4.538309260177613, "mean_kl_loss": 0.024465299129084087, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.47844546066614, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 196000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 8535.737, "sample_time_ms": 6360.154, "synch_weights_time_ms": 2.151}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 49, "trial_id": "302a8_00000", "date": "2023-09-20_10-39-21", "timestamp": 1695199161, "time_this_iter_s": 8.522095680236816, "time_total_s": 425.07992672920227, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 425.07992672920227, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 6.741666666666666, "ram_util_percent": 39.28333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.854210545730592}, "policy_0": {"total_loss": 9.854210545730592, "policy_loss": -0.00032810575664043426, "vf_loss": 9.853155852127076, "vf_loss_unclipped": 8379.454791222, "vf_explained_var": 0.0009186440467834473, "entropy": 4.514114621543884, "mean_kl_loss": 0.012291391784245206, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 464.5228140976332, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 200000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 8548.572, "sample_time_ms": 6369.893, "synch_weights_time_ms": 2.151}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 50, "trial_id": "302a8_00000", "date": "2023-09-20_10-39-30", "timestamp": 1695199170, "time_this_iter_s": 8.612988233566284, "time_total_s": 433.69291496276855, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10592C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 433.69291496276855, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 7.050000000000001, "ram_util_percent": 39.166666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.528734750837833}, "policy_0": {"total_loss": 7.528734750837833, "policy_loss": 0.0030388027027249335, "vf_loss": 7.524381020057201, "vf_loss_unclipped": 8656.257726407706, "vf_explained_var": 0.006295333480834961, "entropy": 4.514866402816772, "mean_kl_loss": 0.011688072528404519, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 466.52447080797623, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 204000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 8554.825, "sample_time_ms": 6374.883, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 51, "trial_id": "302a8_00000", "date": "2023-09-20_10-39-38", "timestamp": 1695199178, "time_this_iter_s": 8.575040817260742, "time_total_s": 442.2679557800293, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050D480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 442.2679557800293, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 7.016666666666666, "ram_util_percent": 39.03333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.786299150665105}, "policy_0": {"total_loss": 8.786299150665105, "policy_loss": 0.0005787503182888031, "vf_loss": 8.784396698474884, "vf_loss_unclipped": 8666.391434022617, "vf_explained_var": 0.004709298610687256, "entropy": 4.48634490737915, "mean_kl_loss": 0.011766170435717503, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.51762677877065, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 208000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 8558.363, "sample_time_ms": 6375.783, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 52, "trial_id": "302a8_00000", "date": "2023-09-20_10-39-47", "timestamp": 1695199187, "time_this_iter_s": 8.557830572128296, "time_total_s": 450.8257863521576, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050FEB0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 450.8257863521576, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 7.3, "ram_util_percent": 39.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.743417225837335}, "policy_0": {"total_loss": 7.743417225837335, "policy_loss": 0.0010328469574451447, "vf_loss": 7.7409999118208885, "vf_loss_unclipped": 8675.918156705035, "vf_explained_var": 0.006363426971435547, "entropy": 4.469503768920898, "mean_kl_loss": 0.012306290346619607, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.64688674302397, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 212000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 8560.272, "sample_time_ms": 6374.49, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 53, "trial_id": "302a8_00000", "date": "2023-09-20_10-39-55", "timestamp": 1695199195, "time_this_iter_s": 8.555461883544922, "time_total_s": 459.3812482357025, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10592D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 459.3812482357025, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 7.5, "ram_util_percent": 39.091666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.145346027859673}, "policy_0": {"total_loss": 7.145346027859673, "policy_loss": -0.0006161950498819351, "vf_loss": 7.144636606606841, "vf_loss_unclipped": 8726.555938239679, "vf_explained_var": 0.006953721618652344, "entropy": 4.541090328788758, "mean_kl_loss": 0.011783272181754364, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}}, "episode_reward_max": -118134.14083965652, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -142197.87237480527, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -10477.135401793774}, "policy_reward_mean": {"policy_0": -35549.46809370133}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652], "episode_lengths": [36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8668364172695978, "mean_inference_ms": 0.8308693197195831, "mean_action_processing_ms": 0.2604585728959614, "mean_env_wait_ms": 1.2757941735414948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.3000020980834961}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.7246216697568, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 216000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 8563.173, "sample_time_ms": 6375.542, "synch_weights_time_ms": 2.351}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 4, "training_iteration": 54, "trial_id": "302a8_00000", "date": "2023-09-20_10-40-04", "timestamp": 1695199204, "time_this_iter_s": 8.535794734954834, "time_total_s": 467.91704297065735, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10592200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 467.91704297065735, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 6.841666666666668, "ram_util_percent": 39.091666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.7572903705596925}, "policy_0": {"total_loss": 5.7572903705596925, "policy_loss": 0.0004382989704608917, "vf_loss": 5.754985010566562, "vf_loss_unclipped": 26.974699579467625, "vf_explained_var": 0.01475950698852539, "entropy": 0.5004978244781494, "mean_kl_loss": 0.016596188973542304, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 459.13358664125377, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 220000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 8584.72, "sample_time_ms": 6400.957, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 55, "trial_id": "302a8_00000", "date": "2023-09-20_10-40-13", "timestamp": 1695199213, "time_this_iter_s": 8.71506142616272, "time_total_s": 476.63210439682007, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10590670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 476.63210439682007, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 7.033333333333334, "ram_util_percent": 39.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.735281723976136}, "policy_0": {"total_loss": 6.735281723976136, "policy_loss": 0.0011947221994400025, "vf_loss": 6.732203415875137, "vf_loss_unclipped": 14.961658505444229, "vf_explained_var": -0.025348859119415285, "entropy": 0.6043123809337616, "mean_kl_loss": 0.01674263390430715, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.42807624545173, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 224000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 8565.19, "sample_time_ms": 6385.146, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 56, "trial_id": "302a8_00000", "date": "2023-09-20_10-40-21", "timestamp": 1695199221, "time_this_iter_s": 8.38022494316101, "time_total_s": 485.0123293399811, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10592DD0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 485.0123293399811, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 7.099999999999998, "ram_util_percent": 39.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.385957752840594}, "policy_0": {"total_loss": 4.385957752840594, "policy_loss": 0.0008334354996681213, "vf_loss": 4.383932555881143, "vf_loss_unclipped": 6.083344919505715, "vf_explained_var": -0.024892171382904053, "entropy": 0.5372238914966583, "mean_kl_loss": 0.01059316439643735, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.2987169287769, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 228000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 8541.576, "sample_time_ms": 6363.883, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 57, "trial_id": "302a8_00000", "date": "2023-09-20_10-40-30", "timestamp": 1695199230, "time_this_iter_s": 8.382495880126953, "time_total_s": 493.39482522010803, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 493.39482522010803, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 7.183333333333334, "ram_util_percent": 39.041666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.2408669137703254}, "policy_0": {"total_loss": 1.2408669137703254, "policy_loss": 0.0010749936521053313, "vf_loss": 1.2380288855284451, "vf_loss_unclipped": 1.2929064741820098, "vf_explained_var": 0.02034420680999756, "entropy": 0.5051210997581482, "mean_kl_loss": 0.015671463377482722, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 482.1717584799217, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 232000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 8511.479, "sample_time_ms": 6337.274, "synch_weights_time_ms": 2.251}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 58, "trial_id": "302a8_00000", "date": "2023-09-20_10-40-38", "timestamp": 1695199238, "time_this_iter_s": 8.297797441482544, "time_total_s": 501.6926226615906, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 501.6926226615906, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 7.425000000000001, "ram_util_percent": 39.08333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 0.6258502840571105}, "policy_0": {"total_loss": 0.6258502840571105, "policy_loss": -0.0014491129517555236, "vf_loss": 0.6255583974167704, "vf_loss_unclipped": 0.6255583974167704, "vf_explained_var": 0.007615210819244385, "entropy": 0.418558247590065, "mean_kl_loss": 0.015475515079125762, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 478.69754856198136, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 236000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 8495.07, "sample_time_ms": 6324.636, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 59, "trial_id": "302a8_00000", "date": "2023-09-20_10-40-46", "timestamp": 1695199246, "time_this_iter_s": 8.358006238937378, "time_total_s": 510.05062890052795, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104B9CF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 510.05062890052795, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 7.291666666666665, "ram_util_percent": 39.091666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.5363054898070172}, "policy_0": {"total_loss": 1.5363054898070172, "policy_loss": 0.00023772245049476625, "vf_loss": 1.534769897557795, "vf_loss_unclipped": 1.6152239579215646, "vf_explained_var": 0.008275981998443604, "entropy": 0.3801012830018997, "mean_kl_loss": 0.011536595024866984, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.11250000447034836}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.2246697714363, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 240000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 8472.151, "sample_time_ms": 6305.002, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 60, "trial_id": "302a8_00000", "date": "2023-09-20_10-40-55", "timestamp": 1695199255, "time_this_iter_s": 8.38379693031311, "time_total_s": 518.4344258308411, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593370>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 518.4344258308411, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 7.709090909090909, "ram_util_percent": 39.07272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 1.8616713851086795}, "policy_0": {"total_loss": 1.8616713851086795, "policy_loss": -0.0020020585000514986, "vf_loss": 1.8631600849024952, "vf_loss_unclipped": 415.9054003364436, "vf_explained_var": -0.019403716468811037, "entropy": 0.6384983358383178, "mean_kl_loss": 0.004563227419077885, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05625000223517418}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.70738033451784, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 244000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 8452.08, "sample_time_ms": 6286.069, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 61, "trial_id": "302a8_00000", "date": "2023-09-20_10-41-03", "timestamp": 1695199263, "time_this_iter_s": 8.375327348709106, "time_total_s": 526.8097531795502, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 526.8097531795502, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 7.441666666666667, "ram_util_percent": 39.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.270175662317313}, "policy_0": {"total_loss": 3.270175662317313, "policy_loss": -0.0065376567602157595, "vf_loss": 3.275430368410051, "vf_loss_unclipped": 2022.8478188407764, "vf_explained_var": -0.003923361301422119, "entropy": 1.6152046523034573, "mean_kl_loss": 0.022807687126123348, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08437500149011612}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 474.42510594683665, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 248000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 8439.623, "sample_time_ms": 6277.644, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 62, "trial_id": "302a8_00000", "date": "2023-09-20_10-41-11", "timestamp": 1695199271, "time_this_iter_s": 8.432255983352661, "time_total_s": 535.2420091629028, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B104BA050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 535.2420091629028, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 7.608333333333333, "ram_util_percent": 39.05833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.079482578378823}, "policy_0": {"total_loss": 4.079482578378823, "policy_loss": -0.005949589599668979, "vf_loss": 4.083469880425185, "vf_loss_unclipped": 1228.474631201493, "vf_explained_var": 0.008375060558319092, "entropy": 1.4430945612162351, "mean_kl_loss": 0.023256867344328202, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 474.4745079359414, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 252000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 8427.314, "sample_time_ms": 6267.416, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 63, "trial_id": "302a8_00000", "date": "2023-09-20_10-41-20", "timestamp": 1695199280, "time_this_iter_s": 8.43237829208374, "time_total_s": 543.6743874549866, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10592C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 543.6743874549866, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 7.1499999999999995, "ram_util_percent": 39.05833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.509606738990545}, "policy_0": {"total_loss": 7.509606738990545, "policy_loss": -0.0005715444415807724, "vf_loss": 7.509115098164975, "vf_loss_unclipped": 4817.615829967092, "vf_explained_var": 0.022235576725006104, "entropy": 4.299000252425671, "mean_kl_loss": 0.00840060950126499, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 475.1300905694985, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 256000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 8415.809, "sample_time_ms": 6256.955, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 64, "trial_id": "302a8_00000", "date": "2023-09-20_10-41-28", "timestamp": 1695199288, "time_this_iter_s": 8.420746326446533, "time_total_s": 552.0951337814331, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 552.0951337814331, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 7.366666666666667, "ram_util_percent": 39.07500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.7451419184744354}, "policy_0": {"total_loss": 7.7451419184744354, "policy_loss": 0.0022945093870162963, "vf_loss": 7.741997420392931, "vf_loss_unclipped": 6286.246414557539, "vf_explained_var": 0.008867457008361817, "entropy": 5.002227208638192, "mean_kl_loss": 0.006715802259795601, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.58845696341217, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 260000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 8398.231, "sample_time_ms": 6236.189, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 65, "trial_id": "302a8_00000", "date": "2023-09-20_10-41-37", "timestamp": 1695199297, "time_this_iter_s": 8.537274837493896, "time_total_s": 560.632408618927, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105937F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 560.632408618927, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 6.925000000000001, "ram_util_percent": 39.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.662033551859856}, "policy_0": {"total_loss": 7.662033551859856, "policy_loss": 0.000653906261920929, "vf_loss": 7.660643248832225, "vf_loss_unclipped": 7150.6412027817605, "vf_explained_var": -0.006761952972412109, "entropy": 5.5071074739575385, "mean_kl_loss": 0.005818262743216474, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.9452039511393, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 264000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 8415.209, "sample_time_ms": 6254.379, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 66, "trial_id": "302a8_00000", "date": "2023-09-20_10-41-45", "timestamp": 1695199305, "time_this_iter_s": 8.550010442733765, "time_total_s": 569.1824190616608, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 569.1824190616608, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 6.891666666666667, "ram_util_percent": 39.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.388569538172335}, "policy_0": {"total_loss": 7.388569538172335, "policy_loss": 0.0007117806561291218, "vf_loss": 7.386419749636948, "vf_loss_unclipped": 5830.105813967319, "vf_explained_var": 0.00559883451461792, "entropy": 4.945796963585168, "mean_kl_loss": 0.011361848440940958, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.02919845182225, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 268000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 8437.321, "sample_time_ms": 6275.068, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 67, "trial_id": "302a8_00000", "date": "2023-09-20_10-41-54", "timestamp": 1695199314, "time_this_iter_s": 8.603610754013062, "time_total_s": 577.7860298156738, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 577.7860298156738, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 6.841666666666666, "ram_util_percent": 39.00833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.629396551477909}, "policy_0": {"total_loss": 9.629396551477909, "policy_loss": 0.007065738834813237, "vf_loss": 9.620898225212096, "vf_loss_unclipped": 7082.973359065438, "vf_explained_var": 0.010469342994689941, "entropy": 6.060285449850559, "mean_kl_loss": 0.011319205544056604, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 466.62108522201373, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 272000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 8464.967, "sample_time_ms": 6302.76, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 68, "trial_id": "302a8_00000", "date": "2023-09-20_10-42-03", "timestamp": 1695199323, "time_this_iter_s": 8.573265790939331, "time_total_s": 586.3592956066132, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105901F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 586.3592956066132, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 8.174999999999999, "ram_util_percent": 39.01666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.989760638427734}, "policy_0": {"total_loss": 9.989760638427734, "policy_loss": -0.0022925281278789044, "vf_loss": 9.991213104248047, "vf_loss_unclipped": 8962.74153203125, "vf_explained_var": 0.0005433106422424316, "entropy": 7.37370008392334, "mean_kl_loss": 0.006637448280332683, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 459.942654988289, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 276000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 8499.04, "sample_time_ms": 6334.315, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 69, "trial_id": "302a8_00000", "date": "2023-09-20_10-42-11", "timestamp": 1695199331, "time_this_iter_s": 8.698736429214478, "time_total_s": 595.0580320358276, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10480C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 595.0580320358276, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 9.449999999999998, "ram_util_percent": 39.025000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.991232572174072}, "policy_0": {"total_loss": 9.991232572174072, "policy_loss": -0.0018848381221294402, "vf_loss": 9.992405589294433, "vf_loss_unclipped": 9312.674707421875, "vf_explained_var": 0.0001535944938659668, "entropy": 7.317354290771484, "mean_kl_loss": 0.005624347132490948, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 461.4378440334864, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 280000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 8527.716, "sample_time_ms": 6360.278, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 70, "trial_id": "302a8_00000", "date": "2023-09-20_10-42-20", "timestamp": 1695199340, "time_this_iter_s": 8.67055630683899, "time_total_s": 603.7285883426666, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 603.7285883426666, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 9.092307692307692, "ram_util_percent": 39.04615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.425062211167813}, "policy_0": {"total_loss": 9.425062211167813, "policy_loss": 0.0011381332330405712, "vf_loss": 9.42305607061386, "vf_loss_unclipped": 14093.961503257657, "vf_explained_var": 0.009844098949432374, "entropy": 6.28986771659851, "mean_kl_loss": 0.006858172925468534, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 463.60329884994866, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 284000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 8553.19, "sample_time_ms": 6382.592, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 71, "trial_id": "302a8_00000", "date": "2023-09-20_10-42-29", "timestamp": 1695199349, "time_this_iter_s": 8.630065679550171, "time_total_s": 612.3586540222168, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 612.3586540222168, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 9.083333333333334, "ram_util_percent": 39.083333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.693009950232506}, "policy_0": {"total_loss": 8.693009950232506, "policy_loss": 0.004247334250994027, "vf_loss": 8.687519073162973, "vf_loss_unclipped": 13823.291592435133, "vf_explained_var": 0.007311012363433838, "entropy": 6.041375238704681, "mean_kl_loss": 0.009825431208492955, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}}, "episode_reward_max": -75296.10598564536, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -127520.22837524327, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -31880.057093810847}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8634307233376894, "mean_inference_ms": 0.8268822494488131, "mean_action_processing_ms": 0.25931345005869627, "mean_env_wait_ms": 1.2700831626040543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.34995873769124347}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.12039759699667, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 288000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 8570.057, "sample_time_ms": 6395.675, "synch_weights_time_ms": 2.1}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 72, "trial_id": "302a8_00000", "date": "2023-09-20_10-42-37", "timestamp": 1695199357, "time_this_iter_s": 8.600923538208008, "time_total_s": 620.9595775604248, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 620.9595775604248, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 6.8, "ram_util_percent": 38.99166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.723918414020538}, "policy_0": {"total_loss": 5.723918414020538, "policy_loss": 0.0016916721753776074, "vf_loss": 5.720163667092286, "vf_loss_unclipped": 43.44642758654114, "vf_explained_var": -0.012515818977355956, "entropy": -0.1871221071459353, "mean_kl_loss": 0.016300990595063194, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 454.70656978707393, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 292000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 8606.707, "sample_time_ms": 6432.742, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 73, "trial_id": "302a8_00000", "date": "2023-09-20_10-42-46", "timestamp": 1695199366, "time_this_iter_s": 8.798882484436035, "time_total_s": 629.7584600448608, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 629.7584600448608, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 7.0249999999999995, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.980157469140366}, "policy_0": {"total_loss": 6.980157469140366, "policy_loss": 0.001073767101764679, "vf_loss": 6.977622414779663, "vf_loss_unclipped": 1818.5856427345275, "vf_explained_var": -0.0814656346321106, "entropy": 1.380227807790041, "mean_kl_loss": 0.011545785712392535, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12656250596046448}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 475.28080144393755, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 296000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 8606.44, "sample_time_ms": 6432.275, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 74, "trial_id": "302a8_00000", "date": "2023-09-20_10-42-55", "timestamp": 1695199375, "time_this_iter_s": 8.418077945709229, "time_total_s": 638.1765379905701, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 638.1765379905701, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 6.858333333333334, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.12731047552824}, "policy_0": {"total_loss": 9.12731047552824, "policy_loss": 0.05631206647753716, "vf_loss": 9.064246506524086, "vf_loss_unclipped": 6100.593665800881, "vf_explained_var": -0.005816720771789551, "entropy": 4.920164663752914, "mean_kl_loss": 0.053348047831869735, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18984375894069672}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 472.15787526794765, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 300000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 8599.987, "sample_time_ms": 6426.397, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 75, "trial_id": "302a8_00000", "date": "2023-09-20_10-43-03", "timestamp": 1695199383, "time_this_iter_s": 8.473743200302124, "time_total_s": 646.6502811908722, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 646.6502811908722, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 7.25, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.99077134475708}, "policy_0": {"total_loss": 9.99077134475708, "policy_loss": -0.0012611649252474307, "vf_loss": 9.991547674560547, "vf_loss_unclipped": 8985.151991796874, "vf_explained_var": 0.0009564523696899414, "entropy": 6.916693089294434, "mean_kl_loss": 0.0025537205586872915, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.09492187947034836}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.58883536985155, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 304000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 8600.639, "sample_time_ms": 6423.732, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 76, "trial_id": "302a8_00000", "date": "2023-09-20_10-43-12", "timestamp": 1695199392, "time_this_iter_s": 8.55652379989624, "time_total_s": 655.2068049907684, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050FE20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 655.2068049907684, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 7.074999999999999, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.99064457321167}, "policy_0": {"total_loss": 9.99064457321167, "policy_loss": -0.0011658004891127347, "vf_loss": 9.991442272949218, "vf_loss_unclipped": 9361.371271875, "vf_explained_var": 0.0005020172119140625, "entropy": 7.063473666381836, "mean_kl_loss": 0.003877993623680959, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.40633188170005, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 308000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 8592.618, "sample_time_ms": 6415.325, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 77, "trial_id": "302a8_00000", "date": "2023-09-20_10-43-20", "timestamp": 1695199400, "time_this_iter_s": 8.522904872894287, "time_total_s": 663.7297098636627, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 663.7297098636627, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 6.658333333333334, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.98984397277832}, "policy_0": {"total_loss": 9.98984397277832, "policy_loss": -0.0015927241504192352, "vf_loss": 9.991187710571289, "vf_loss_unclipped": 9403.400818359374, "vf_explained_var": 0.0014869709968566894, "entropy": 7.150924040222168, "mean_kl_loss": 0.005245238002738915, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.81172965078713, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 312000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 8586.796, "sample_time_ms": 6407.216, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 78, "trial_id": "302a8_00000", "date": "2023-09-20_10-43-29", "timestamp": 1695199409, "time_this_iter_s": 8.516049861907959, "time_total_s": 672.2457597255707, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F48B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 672.2457597255707, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.990206003570556}, "policy_0": {"total_loss": 9.990206003570556, "policy_loss": -0.001371881601214409, "vf_loss": 9.991248765563965, "vf_loss_unclipped": 9464.274263671876, "vf_explained_var": -0.0006891908645629883, "entropy": 7.234338397979736, "mean_kl_loss": 0.006934571494964621, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.0677416485351, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 316000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 8577.212, "sample_time_ms": 6395.768, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 79, "trial_id": "302a8_00000", "date": "2023-09-20_10-43-37", "timestamp": 1695199417, "time_this_iter_s": 8.60289740562439, "time_total_s": 680.8486571311951, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F51B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 680.8486571311951, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 6.708333333333333, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.975522014617919}, "policy_0": {"total_loss": 9.975522014617919, "policy_loss": -0.00020942622125148772, "vf_loss": 9.975257855224609, "vf_loss_unclipped": 7505.434781445312, "vf_explained_var": 0.014035913276672363, "entropy": 6.487364699047804, "mean_kl_loss": 0.009979279193421826, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.1823576525035, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 320000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 8564.724, "sample_time_ms": 6383.198, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 80, "trial_id": "302a8_00000", "date": "2023-09-20_10-43-46", "timestamp": 1695199426, "time_this_iter_s": 8.545182704925537, "time_total_s": 689.3938398361206, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 689.3938398361206, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 6.33846153846154, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.9920570854187}, "policy_0": {"total_loss": 9.9920570854187, "policy_loss": 0.001477632026001811, "vf_loss": 9.990311947631836, "vf_loss_unclipped": 8301.258904589844, "vf_explained_var": 0.007844914436340332, "entropy": 7.1075763660907745, "mean_kl_loss": 0.005636554768513452, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 466.447996555608, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 324000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 8559.462, "sample_time_ms": 6380.992, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 81, "trial_id": "302a8_00000", "date": "2023-09-20_10-43-54", "timestamp": 1695199434, "time_this_iter_s": 8.577447652816772, "time_total_s": 697.9712874889374, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 697.9712874889374, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 6.75, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.801901997327805}, "policy_0": {"total_loss": 9.801901997327805, "policy_loss": 0.00355119988322258, "vf_loss": 9.79794846763611, "vf_loss_unclipped": 8309.05703502388, "vf_explained_var": 0.010353522205352784, "entropy": 6.660986113500595, "mean_kl_loss": 0.008477436349936762, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.04746093973517418}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.5538305746079, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 328000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 8558.662, "sample_time_ms": 6379.559, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 82, "trial_id": "302a8_00000", "date": "2023-09-20_10-44-03", "timestamp": 1695199443, "time_this_iter_s": 8.592917203903198, "time_total_s": 706.5642046928406, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 706.5642046928406, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 8.541666666666666, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.78950019235462}, "policy_0": {"total_loss": 9.78950019235462, "policy_loss": 0.001212392880767584, "vf_loss": 9.788115616750718, "vf_loss_unclipped": 7946.055825633001, "vf_explained_var": 0.006596511173248291, "entropy": 6.802170695501566, "mean_kl_loss": 0.0036276226118181513, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.8416957185765, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 332000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 8537.634, "sample_time_ms": 6355.842, "synch_weights_time_ms": 2.1}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 83, "trial_id": "302a8_00000", "date": "2023-09-20_10-44-12", "timestamp": 1695199452, "time_this_iter_s": 8.588607549667358, "time_total_s": 715.1528122425079, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 715.1528122425079, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 9.0, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.01341771770157}, "policy_0": {"total_loss": 9.01341771770157, "policy_loss": 0.00011813082545995712, "vf_loss": 9.013124018669128, "vf_loss_unclipped": 7812.638801564217, "vf_explained_var": 0.004852524185180664, "entropy": 6.041535269570351, "mean_kl_loss": 0.007398706326234969, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.98457146392514, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 336000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 8550.756, "sample_time_ms": 6366.666, "synch_weights_time_ms": 2.1}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 84, "trial_id": "302a8_00000", "date": "2023-09-20_10-44-20", "timestamp": 1695199460, "time_this_iter_s": 8.54928994178772, "time_total_s": 723.7021021842957, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F43A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 723.7021021842957, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 8.95, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.067006795108318}, "policy_0": {"total_loss": 9.067006795108318, "policy_loss": 0.0009992516323924065, "vf_loss": 9.06576637020111, "vf_loss_unclipped": 8014.781998428154, "vf_explained_var": 0.035715970706939694, "entropy": 5.685115762907267, "mean_kl_loss": 0.010162836600888478, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.88079627483455, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 340000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 8554.861, "sample_time_ms": 6369.865, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 85, "trial_id": "302a8_00000", "date": "2023-09-20_10-44-29", "timestamp": 1695199469, "time_this_iter_s": 8.513797283172607, "time_total_s": 732.2158994674683, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 732.2158994674683, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 8.166666666666666, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.895504738950729}, "policy_0": {"total_loss": 8.895504738950729, "policy_loss": 0.0006388933062553406, "vf_loss": 8.894603324264288, "vf_loss_unclipped": 6523.0815217465815, "vf_explained_var": 0.05576439332962036, "entropy": 5.1617216370917856, "mean_kl_loss": 0.011062568582598032, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.7978503545798, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 344000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 8550.839, "sample_time_ms": 6366.395, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 86, "trial_id": "302a8_00000", "date": "2023-09-20_10-44-37", "timestamp": 1695199477, "time_this_iter_s": 8.516300678253174, "time_total_s": 740.7322001457214, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F63B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 740.7322001457214, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 7.141666666666667, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.633374227195977}, "policy_0": {"total_loss": 8.633374227195977, "policy_loss": 0.0007218675032258034, "vf_loss": 8.63240542191267, "vf_loss_unclipped": 3785.465845118034, "vf_explained_var": 0.05252166213989258, "entropy": 3.59233164922595, "mean_kl_loss": 0.010404858417408833, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.37833076116044, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 348000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 8547.274, "sample_time_ms": 6362.011, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 87, "trial_id": "302a8_00000", "date": "2023-09-20_10-44-46", "timestamp": 1695199486, "time_this_iter_s": 8.487752199172974, "time_total_s": 749.2199523448944, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591B40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 749.2199523448944, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 7.05, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.53564912917614}, "policy_0": {"total_loss": 7.53564912917614, "policy_loss": 0.005910129979252815, "vf_loss": 7.529297068625689, "vf_loss_unclipped": 5758.562676813727, "vf_explained_var": 0.028257048511505126, "entropy": 4.347299798941612, "mean_kl_loss": 0.018622132936283016, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.5551939113159, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 352000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 8547.739, "sample_time_ms": 6362.641, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 88, "trial_id": "302a8_00000", "date": "2023-09-20_10-44-54", "timestamp": 1695199494, "time_this_iter_s": 8.520700216293335, "time_total_s": 757.7406525611877, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 757.7406525611877, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 7.1000000000000005, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.162259402831271}, "policy_0": {"total_loss": 7.162259402831271, "policy_loss": 0.0010575362414121628, "vf_loss": 7.160919196252525, "vf_loss_unclipped": 3388.6814357760713, "vf_explained_var": 0.027350419521331788, "entropy": 2.796547373735905, "mean_kl_loss": 0.01191222567447694, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.0293900930526, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 356000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 8542.296, "sample_time_ms": 6359.166, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 89, "trial_id": "302a8_00000", "date": "2023-09-20_10-45-03", "timestamp": 1695199503, "time_this_iter_s": 8.548470735549927, "time_total_s": 766.2891232967377, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 766.2891232967377, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 7.383333333333333, "ram_util_percent": 39.03333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.506764608868211}, "policy_0": {"total_loss": 7.506764608868211, "policy_loss": 0.0005132141083478927, "vf_loss": 7.5059855775341395, "vf_loss_unclipped": 11141.658479944943, "vf_explained_var": 0.026318061256408693, "entropy": 4.7914821354448796, "mean_kl_loss": 0.011201077632291709, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.02373046986758709}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111686.5965346435, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27921.649133660896}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.861131303655644, "mean_inference_ms": 0.8243767673835571, "mean_action_processing_ms": 0.25845059708477514, "mean_env_wait_ms": 1.265187364127269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.42497217655181885}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 464.57981073510854, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 360000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 8548.922, "sample_time_ms": 6365.748, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 8, "training_iteration": 90, "trial_id": "302a8_00000", "date": "2023-09-20_10-45-12", "timestamp": 1695199512, "time_this_iter_s": 8.612930297851562, "time_total_s": 774.9020535945892, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 774.9020535945892, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 6.908333333333335, "ram_util_percent": 39.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.571571975517273}, "policy_0": {"total_loss": 5.571571975517273, "policy_loss": 0.014606149172782898, "vf_loss": 5.556097246595472, "vf_loss_unclipped": 60.46733231529817, "vf_explained_var": 0.0007468956947326661, "entropy": -1.7771959108352662, "mean_kl_loss": 0.0366013306290959, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03559570387005806}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 456.8726436723014, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 364000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 8566.894, "sample_time_ms": 6382.004, "synch_weights_time_ms": 1.901}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 91, "trial_id": "302a8_00000", "date": "2023-09-20_10-45-20", "timestamp": 1695199520, "time_this_iter_s": 8.757178783416748, "time_total_s": 783.659232378006, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F4700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 783.659232378006, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 7.066666666666666, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.104592169475556}, "policy_0": {"total_loss": 6.104592169475556, "policy_loss": 0.007182622936367989, "vf_loss": 6.096700771238282, "vf_loss_unclipped": 32.66839715852924, "vf_explained_var": -0.007879984474182129, "entropy": -1.827056018447876, "mean_kl_loss": 0.01991247353013605, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03559570387005806}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 478.6109284721368, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 368000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 8543.455, "sample_time_ms": 6359.422, "synch_weights_time_ms": 1.901}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 92, "trial_id": "302a8_00000", "date": "2023-09-20_10-45-29", "timestamp": 1695199529, "time_this_iter_s": 8.359518051147461, "time_total_s": 792.0187504291534, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F6950>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 792.0187504291534, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 7.183333333333334, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.287474925850332}, "policy_0": {"total_loss": 7.287474925850332, "policy_loss": 0.0003724071264266968, "vf_loss": 7.28661845549345, "vf_loss_unclipped": 2568.030743430889, "vf_explained_var": -0.15833160467147828, "entropy": 0.7198865453720092, "mean_kl_loss": 0.013598186433746013, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03559570387005806}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.04532219110234, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 372000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 8523.289, "sample_time_ms": 6341.292, "synch_weights_time_ms": 1.901}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 93, "trial_id": "302a8_00000", "date": "2023-09-20_10-45-37", "timestamp": 1695199537, "time_this_iter_s": 8.386948347091675, "time_total_s": 800.4056987762451, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F72E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 800.4056987762451, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 6.716666666666666, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.323811041159928}, "policy_0": {"total_loss": 7.323811041159928, "policy_loss": 0.002046413391828537, "vf_loss": 7.321229340612889, "vf_loss_unclipped": 4219.785289778006, "vf_explained_var": -0.0874785400390625, "entropy": 2.3123832301855085, "mean_kl_loss": 0.015037988863850478, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.03559570387005806}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.7594184798135, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 376000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 8521.876, "sample_time_ms": 6341.731, "synch_weights_time_ms": 1.901}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 94, "trial_id": "302a8_00000", "date": "2023-09-20_10-45-46", "timestamp": 1695199546, "time_this_iter_s": 8.535162925720215, "time_total_s": 808.9408617019653, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 808.9408617019653, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 7.016666666666666, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.485773344497383}, "policy_0": {"total_loss": 7.485773344497383, "policy_loss": 0.0007722996562719345, "vf_loss": 7.484101993578673, "vf_loss_unclipped": 4246.644989812105, "vf_explained_var": 0.008177133560180664, "entropy": 2.474399601364136, "mean_kl_loss": 0.025258236589515582, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05339355766773224}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 473.3740873163477, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 380000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 8515.594, "sample_time_ms": 6338.853, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 95, "trial_id": "302a8_00000", "date": "2023-09-20_10-45-54", "timestamp": 1695199554, "time_this_iter_s": 8.45197868347168, "time_total_s": 817.392840385437, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050C8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 817.392840385437, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 6.758333333333333, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.766710440663248}, "policy_0": {"total_loss": 6.766710440663248, "policy_loss": 0.003700005507469177, "vf_loss": 6.762077648165822, "vf_loss_unclipped": 4111.917330786518, "vf_explained_var": 0.00969478635787964, "entropy": 2.596758683526516, "mean_kl_loss": 0.0174698862567544, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05339355766773224}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 467.53905873897617, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 384000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 8519.707, "sample_time_ms": 6341.393, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 96, "trial_id": "302a8_00000", "date": "2023-09-20_10-46-03", "timestamp": 1695199563, "time_this_iter_s": 8.557435512542725, "time_total_s": 825.9502758979797, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F4790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 825.9502758979797, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 8.358333333333334, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.238218069882691}, "policy_0": {"total_loss": 6.238218069882691, "policy_loss": 0.0012263555198907853, "vf_loss": 6.235159858986735, "vf_loss_unclipped": 3857.514126681802, "vf_explained_var": 0.0046696402549743655, "entropy": 2.610983210873604, "mean_kl_loss": 0.0343087712532375, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08009033650159836}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.5800967934006, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 388000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 8519.244, "sample_time_ms": 6341.379, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 97, "trial_id": "302a8_00000", "date": "2023-09-20_10-46-11", "timestamp": 1695199571, "time_this_iter_s": 8.483121633529663, "time_total_s": 834.4333975315094, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F6B90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 834.4333975315094, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 7.658333333333334, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.940156632992625}, "policy_0": {"total_loss": 6.940156632992625, "policy_loss": 0.00017703169286251068, "vf_loss": 6.938753238081932, "vf_loss_unclipped": 2803.606715224242, "vf_explained_var": -0.0028047667503356935, "entropy": 2.067593112230301, "mean_kl_loss": 0.015311557846603683, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08009033650159836}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.6909167769074, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 392000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 8520.815, "sample_time_ms": 6341.774, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 98, "trial_id": "302a8_00000", "date": "2023-09-20_10-46-20", "timestamp": 1695199580, "time_this_iter_s": 8.536409378051758, "time_total_s": 842.9698069095612, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 842.9698069095612, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 6.691666666666667, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.867064088884741}, "policy_0": {"total_loss": 6.867064088884741, "policy_loss": 0.0009024431137368083, "vf_loss": 6.864981699460745, "vf_loss_unclipped": 2204.66647390756, "vf_explained_var": 0.01608225927352905, "entropy": 1.5709622133612633, "mean_kl_loss": 0.01473238697759807, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.08009033650159836}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 473.21865664156667, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 396000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 8511.443, "sample_time_ms": 6331.764, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 99, "trial_id": "302a8_00000", "date": "2023-09-20_10-46-28", "timestamp": 1695199588, "time_this_iter_s": 8.454751253128052, "time_total_s": 851.4245581626892, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F7760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 851.4245581626892, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 6.716666666666666, "ram_util_percent": 39.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.408057020810619}, "policy_0": {"total_loss": 7.408057020810619, "policy_loss": -0.000758994334936142, "vf_loss": 7.407003681272268, "vf_loss_unclipped": 2137.8095598736704, "vf_explained_var": 0.008501096725463867, "entropy": 1.328592316055298, "mean_kl_loss": 0.022628915252257138, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12013550102710724}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 458.4353393708557, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 400000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 8522.983, "sample_time_ms": 6318.534, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 100, "trial_id": "302a8_00000", "date": "2023-09-20_10-46-37", "timestamp": 1695199597, "time_this_iter_s": 8.727331161499023, "time_total_s": 860.1518893241882, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 860.1518893241882, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 7.391666666666667, "ram_util_percent": 39.074999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.547322030381113}, "policy_0": {"total_loss": 7.547322030381113, "policy_loss": 0.002145342203974724, "vf_loss": 7.542826155984402, "vf_loss_unclipped": 1707.9473558461548, "vf_explained_var": 0.002569120025634766, "entropy": 1.2639102132081985, "mean_kl_loss": 0.019565808007889426, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12013550102710724}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 452.81852081367555, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 404000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 8530.822, "sample_time_ms": 6313.265, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 101, "trial_id": "302a8_00000", "date": "2023-09-20_10-46-46", "timestamp": 1695199606, "time_this_iter_s": 8.83556056022644, "time_total_s": 868.9874498844147, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F7880>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 868.9874498844147, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 3.8923076923076922, "ram_util_percent": 39.51538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.774434319221228}, "policy_0": {"total_loss": 7.774434319221228, "policy_loss": -0.0003751273453235626, "vf_loss": 7.772844988507033, "vf_loss_unclipped": 829.4145264517487, "vf_explained_var": 0.0025797301292419432, "entropy": -0.3705407037854195, "mean_kl_loss": 0.016351825160859153, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12013550102710724}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 468.0644232709808, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 408000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 8549.653, "sample_time_ms": 6333.241, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 102, "trial_id": "302a8_00000", "date": "2023-09-20_10-46-54", "timestamp": 1695199614, "time_this_iter_s": 8.547831296920776, "time_total_s": 877.5352811813354, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10136560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 877.5352811813354, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 6.75, "ram_util_percent": 39.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.474815180897712}, "policy_0": {"total_loss": 7.474815180897712, "policy_loss": 0.0028570470049977302, "vf_loss": 7.469851076102257, "vf_loss_unclipped": 301.48308832204344, "vf_explained_var": 0.0011888486862182616, "entropy": -1.3975400028824807, "mean_kl_loss": 0.017539029227197172, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.12013550102710724}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.4857755671809, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 412000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 8561.343, "sample_time_ms": 6342.37, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 103, "trial_id": "302a8_00000", "date": "2023-09-20_10-47-03", "timestamp": 1695199623, "time_this_iter_s": 8.50385046005249, "time_total_s": 886.0391316413879, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F6830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 886.0391316413879, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 6.716666666666666, "ram_util_percent": 39.449999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.048399320651405}, "policy_0": {"total_loss": 7.048399320651405, "policy_loss": -0.002798730301856995, "vf_loss": 7.048624895393848, "vf_loss_unclipped": 1494.1678341261984, "vf_explained_var": 0.0010143823623657226, "entropy": 0.532675817489624, "mean_kl_loss": 0.021418732320517303, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.18020325899124146}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.3249502231411, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 416000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 8556.698, "sample_time_ms": 6335.939, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 104, "trial_id": "302a8_00000", "date": "2023-09-20_10-47-11", "timestamp": 1695199631, "time_this_iter_s": 8.488712787628174, "time_total_s": 894.5278444290161, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10591900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 894.5278444290161, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 6.566666666666666, "ram_util_percent": 39.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.112835272789}, "policy_0": {"total_loss": 8.112835272789, "policy_loss": 0.005106986218690872, "vf_loss": 8.103348303890229, "vf_loss_unclipped": 337.6770536410332, "vf_explained_var": 0.000888865852355957, "entropy": -1.6352267522394657, "mean_kl_loss": 0.024305871702637524, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 474.61890872438016, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 420000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 8554.482, "sample_time_ms": 6332.092, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 105, "trial_id": "302a8_00000", "date": "2023-09-20_10-47-20", "timestamp": 1695199640, "time_this_iter_s": 8.42981505393982, "time_total_s": 902.9576594829559, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 902.9576594829559, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 6.45, "ram_util_percent": 39.324999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.195745223236084}, "policy_0": {"total_loss": 8.195745223236084, "policy_loss": 0.0028757743321359158, "vf_loss": 8.18839171655178, "vf_loss_unclipped": 297.5259789621115, "vf_explained_var": 0.0003061276435852051, "entropy": -1.9254714306354523, "mean_kl_loss": 0.016565614827349782, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 472.56218498313774, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 424000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 8545.388, "sample_time_ms": 6323.662, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 106, "trial_id": "302a8_00000", "date": "2023-09-20_10-47-28", "timestamp": 1695199648, "time_this_iter_s": 8.466496229171753, "time_total_s": 911.4241557121277, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 911.4241557121277, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.119376837825776}, "policy_0": {"total_loss": 8.119376837825776, "policy_loss": -0.00021070952117443085, "vf_loss": 8.114486143493652, "vf_loss_unclipped": 354.2615513187408, "vf_explained_var": 0.0007409966468811035, "entropy": -2.2405010967254637, "mean_kl_loss": 0.018872888460289686, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 473.2695432388518, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 428000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 8542.46, "sample_time_ms": 6317.816, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 107, "trial_id": "302a8_00000", "date": "2023-09-20_10-47-37", "timestamp": 1695199657, "time_this_iter_s": 8.452842712402344, "time_total_s": 919.87699842453, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061CF70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 919.87699842453, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 6.958333333333333, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.459302130508423}, "policy_0": {"total_loss": 7.459302130508423, "policy_loss": 0.001780799984931946, "vf_loss": 7.45391783362031, "vf_loss_unclipped": 338.8241759486258, "vf_explained_var": 0.0006489830017089844, "entropy": -2.220682285499573, "mean_kl_loss": 0.01333123218677938, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2703048884868622}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}}, "episode_reward_max": -62187.609675298045, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -111178.98030127864, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4983.4530281246825}, "policy_reward_mean": {"policy_0": -27794.74507531974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8594500542017363, "mean_inference_ms": 0.82274950091463, "mean_action_processing_ms": 0.2577568378253814, "mean_env_wait_ms": 1.2618923171055663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009996891021728516, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.4399442672729492}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.20286006370833, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 432000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 8537.911, "sample_time_ms": 6314.09, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 108, "trial_id": "302a8_00000", "date": "2023-09-20_10-47-45", "timestamp": 1695199665, "time_this_iter_s": 8.49091386795044, "time_total_s": 928.3679122924805, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105909D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 928.3679122924805, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 6.474999999999999, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.986526098632812}, "policy_0": {"total_loss": 9.986526098632812, "policy_loss": 0.014147334006428718, "vf_loss": 9.958593783569336, "vf_loss_unclipped": 1088.437911669922, "vf_explained_var": 0.025835302925109865, "entropy": -3.018862523651123, "mean_kl_loss": 0.05099788063820451, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 441.4325922665647, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 436000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 8598.776, "sample_time_ms": 6376.381, "synch_weights_time_ms": 2.151}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 109, "trial_id": "302a8_00000", "date": "2023-09-20_10-47-54", "timestamp": 1695199674, "time_this_iter_s": 9.063409328460693, "time_total_s": 937.4313216209412, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050FF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 937.4313216209412, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 6.716666666666666, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.875490252685546}, "policy_0": {"total_loss": 9.875490252685546, "policy_loss": -0.0009168780356645584, "vf_loss": 9.873174559020995, "vf_loss_unclipped": 661.1186153808594, "vf_explained_var": -0.14631869735717773, "entropy": -2.5315717429161073, "mean_kl_loss": 0.007972874305024743, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 471.5346751011368, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 440000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 8574.537, "sample_time_ms": 6378.572, "synch_weights_time_ms": 2.051}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 110, "trial_id": "302a8_00000", "date": "2023-09-20_10-48-03", "timestamp": 1695199683, "time_this_iter_s": 8.48444128036499, "time_total_s": 945.9157629013062, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F7130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 945.9157629013062, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 8.233333333333334, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.900894409942627}, "policy_0": {"total_loss": 9.900894409942627, "policy_loss": 0.0003120987117290497, "vf_loss": 9.89821113128662, "vf_loss_unclipped": 2461.1651743255616, "vf_explained_var": -0.10170691452026367, "entropy": 2.4570245370030404, "mean_kl_loss": 0.005848171713587362, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.01227934209635, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 444000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 8544.037, "sample_time_ms": 6357.775, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 111, "trial_id": "302a8_00000", "date": "2023-09-20_10-48-11", "timestamp": 1695199691, "time_this_iter_s": 8.530561447143555, "time_total_s": 954.4463243484497, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 954.4463243484497, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 8.425, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.733026385879517}, "policy_0": {"total_loss": 9.733026385879517, "policy_loss": 0.010089089307188989, "vf_loss": 9.71658701031208, "vf_loss_unclipped": 2902.254568325925, "vf_explained_var": -0.1087532283782959, "entropy": 4.047996939301491, "mean_kl_loss": 0.015662105307621823, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 449.98707614704125, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 448000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 8578.368, "sample_time_ms": 6388.504, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 112, "trial_id": "302a8_00000", "date": "2023-09-20_10-48-20", "timestamp": 1695199700, "time_this_iter_s": 8.891144514083862, "time_total_s": 963.3374688625336, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 963.3374688625336, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 7.230769230769231, "ram_util_percent": 39.246153846153845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.270593495160341}, "policy_0": {"total_loss": 9.270593495160341, "policy_loss": 0.00347229468524456, "vf_loss": 9.264287021136283, "vf_loss_unclipped": 3544.1021151842833, "vf_explained_var": -0.005959110641479492, "entropy": 5.234806953239441, "mean_kl_loss": 0.006990201524295844, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.4425563301231, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 452000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 8578.446, "sample_time_ms": 6390.832, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 113, "trial_id": "302a8_00000", "date": "2023-09-20_10-48-29", "timestamp": 1695199709, "time_this_iter_s": 8.504631996154785, "time_total_s": 971.8421008586884, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061D750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 971.8421008586884, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 6.508333333333333, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.887962940216065}, "policy_0": {"total_loss": 9.887962940216065, "policy_loss": 0.002786668011546135, "vf_loss": 9.88212938079834, "vf_loss_unclipped": 3110.904450656128, "vf_explained_var": -0.003189051342010498, "entropy": 4.516123000752926, "mean_kl_loss": 0.0075145986002171416, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 457.64621590617776, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 456000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 8603.812, "sample_time_ms": 6418.737, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 114, "trial_id": "302a8_00000", "date": "2023-09-20_10-48-38", "timestamp": 1695199718, "time_this_iter_s": 8.742376327514648, "time_total_s": 980.584477186203, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061E050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 980.584477186203, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 5.608333333333333, "ram_util_percent": 39.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.603732719524205}, "policy_0": {"total_loss": 9.603732719524205, "policy_loss": 0.004351320481300354, "vf_loss": 9.596974258828164, "vf_loss_unclipped": 3973.6446680267572, "vf_explained_var": -0.01664161729812622, "entropy": 5.921497403335572, "mean_kl_loss": 0.005936889999103733, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.4054573178291321}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 437.1159245323093, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 460000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 8676.12, "sample_time_ms": 6491.768, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 115, "trial_id": "302a8_00000", "date": "2023-09-20_10-48-47", "timestamp": 1695199727, "time_this_iter_s": 9.15289044380188, "time_total_s": 989.7373676300049, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 989.7373676300049, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 6.115384615384615, "ram_util_percent": 39.49230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.992079693621397}, "policy_0": {"total_loss": 8.992079693621397, "policy_loss": 0.02941880059838295, "vf_loss": 8.947886428678036, "vf_loss_unclipped": 3559.7373271414162, "vf_explained_var": -0.05485968236923218, "entropy": 5.06024703707695, "mean_kl_loss": 0.0364391018682858, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6081860065460205}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 460.21201903498206, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 464000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 8698.835, "sample_time_ms": 6510.265, "synch_weights_time_ms": 1.951}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 116, "trial_id": "302a8_00000", "date": "2023-09-20_10-48-55", "timestamp": 1695199735, "time_this_iter_s": 8.69364619255066, "time_total_s": 998.4310138225555, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F7130>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 998.4310138225555, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 3.8333333333333326, "ram_util_percent": 39.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.861828892499581}, "policy_0": {"total_loss": 7.861828892499581, "policy_loss": 0.002515659981966019, "vf_loss": 7.856680276620388, "vf_loss_unclipped": 3882.8948350438477, "vf_explained_var": -0.013549759006500245, "entropy": 5.595485598278046, "mean_kl_loss": 0.004329164299042895, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.30409300327301025}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 453.06235096825066, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 468000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 8736.532, "sample_time_ms": 6554.152, "synch_weights_time_ms": 2.051}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 117, "trial_id": "302a8_00000", "date": "2023-09-20_10-49-04", "timestamp": 1695199744, "time_this_iter_s": 8.82980751991272, "time_total_s": 1007.2608213424683, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10593F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1007.2608213424683, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 4.315384615384615, "ram_util_percent": 39.48461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.056535455107689}, "policy_0": {"total_loss": 8.056535455107689, "policy_loss": 0.000400117227435112, "vf_loss": 8.05484514952898, "vf_loss_unclipped": 3521.911881828606, "vf_explained_var": -0.02156881914138794, "entropy": 4.831456467437744, "mean_kl_loss": 0.004242776373028755, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15204650163650513}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 454.1337945875106, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 472000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 8768.438, "sample_time_ms": 6586.751, "synch_weights_time_ms": 2.051}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 118, "trial_id": "302a8_00000", "date": "2023-09-20_10-49-13", "timestamp": 1695199753, "time_this_iter_s": 8.808977127075195, "time_total_s": 1016.0697984695435, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061D7E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1016.0697984695435, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 5.133333333333333, "ram_util_percent": 39.41666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.769521870587021}, "policy_0": {"total_loss": 7.769521870587021, "policy_loss": -0.0011317069709300995, "vf_loss": 7.769339750695228, "vf_loss_unclipped": 7563.26623293879, "vf_explained_var": 0.007243654537200927, "entropy": 4.938300281143189, "mean_kl_loss": 0.008640855934980936, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.15204650163650513}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 450.9796510988714, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 476000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 8749.255, "sample_time_ms": 6564.116, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 119, "trial_id": "302a8_00000", "date": "2023-09-20_10-49-22", "timestamp": 1695199762, "time_this_iter_s": 8.871578216552734, "time_total_s": 1024.9413766860962, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1024.9413766860962, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 4.7846153846153845, "ram_util_percent": 39.44615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.010162387213111}, "policy_0": {"total_loss": 7.010162387213111, "policy_loss": -0.0005663264527916908, "vf_loss": 7.006325407344103, "vf_loss_unclipped": 5821.216575467616, "vf_explained_var": -0.0491518669128418, "entropy": 3.871709384071827, "mean_kl_loss": 0.028960331275640055, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2280697524547577}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 460.40048371477405, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 480000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 8769.77, "sample_time_ms": 6583.781, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 120, "trial_id": "302a8_00000", "date": "2023-09-20_10-49-31", "timestamp": 1695199771, "time_this_iter_s": 8.690088033676147, "time_total_s": 1033.6314647197723, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061E7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1033.6314647197723, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 4.816666666666666, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.789860545562953}, "policy_0": {"total_loss": 6.789860545562953, "policy_loss": 0.0023630587935447693, "vf_loss": 6.784089941847324, "vf_loss_unclipped": 6396.7725421307205, "vf_explained_var": -0.006115971755981445, "entropy": 4.299427012634277, "mean_kl_loss": 0.01494090922793839, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2280697524547577}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 454.07563291880103, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 484000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 8797.825, "sample_time_ms": 6612.798, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 121, "trial_id": "302a8_00000", "date": "2023-09-20_10-49-39", "timestamp": 1695199779, "time_this_iter_s": 8.811105489730835, "time_total_s": 1042.4425702095032, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061F0A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1042.4425702095032, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 4.776923076923077, "ram_util_percent": 39.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.015159237421304}, "policy_0": {"total_loss": 7.015159237421304, "policy_loss": 0.002055023831129074, "vf_loss": 7.009809044635296, "vf_loss_unclipped": 3406.3076771865726, "vf_explained_var": -0.011965111255645752, "entropy": 3.579356480026245, "mean_kl_loss": 0.014447990072635003, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2280697524547577}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 450.13900683447474, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 488000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 8797.525, "sample_time_ms": 6611.353, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 122, "trial_id": "302a8_00000", "date": "2023-09-20_10-49-48", "timestamp": 1695199788, "time_this_iter_s": 8.888143539428711, "time_total_s": 1051.3307137489319, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1051.3307137489319, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 4.416666666666667, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.732801299714297}, "policy_0": {"total_loss": 6.732801299714297, "policy_loss": 0.003020575162768364, "vf_loss": 6.726983187231421, "vf_loss_unclipped": 3066.146696684393, "vf_explained_var": -0.016591389179229737, "entropy": 3.384543561553955, "mean_kl_loss": 0.012266068649082444, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2280697524547577}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 446.2616235133039, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 492000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 8843.597, "sample_time_ms": 6648.278, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 123, "trial_id": "302a8_00000", "date": "2023-09-20_10-49-57", "timestamp": 1695199797, "time_this_iter_s": 8.965352296829224, "time_total_s": 1060.296066045761, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F7640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1060.296066045761, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 4.061538461538461, "ram_util_percent": 39.74615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.901131909428537}, "policy_0": {"total_loss": 6.901131909428537, "policy_loss": 0.0013950718641281127, "vf_loss": 6.897737302581221, "vf_loss_unclipped": 2908.6279316003715, "vf_explained_var": -0.04590051364898682, "entropy": 3.4289340465545655, "mean_kl_loss": 0.008767172799215768, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.2280697524547577}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 460.8410717854627, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 496000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 8837.537, "sample_time_ms": 6639.622, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 124, "trial_id": "302a8_00000", "date": "2023-09-20_10-50-06", "timestamp": 1695199806, "time_this_iter_s": 8.681781768798828, "time_total_s": 1068.97784781456, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061DEA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1068.97784781456, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 5.758333333333334, "ram_util_percent": 39.76666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.765981771606673}, "policy_0": {"total_loss": 6.765981771606673, "policy_loss": 0.00787112334817648, "vf_loss": 6.752258126622438, "vf_loss_unclipped": 2642.601782475072, "vf_explained_var": -0.04549265661239624, "entropy": 2.944722874546051, "mean_kl_loss": 0.02566121030972281, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.34210461378097534}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 474.99329930310773, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 500000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 8764.465, "sample_time_ms": 6565.334, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 125, "trial_id": "302a8_00000", "date": "2023-09-20_10-50-15", "timestamp": 1695199815, "time_this_iter_s": 8.423171043395996, "time_total_s": 1077.401018857956, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1077.401018857956, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 7.983333333333333, "ram_util_percent": 39.758333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.111457190653681}, "policy_0": {"total_loss": 8.111457190653681, "policy_loss": 0.011434711253643036, "vf_loss": 8.09232909463644, "vf_loss_unclipped": 2960.587965126741, "vf_explained_var": -0.01030862741470337, "entropy": 3.4252992263793947, "mean_kl_loss": 0.02248843332111137, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.5131568908691406}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -100259.30655437514, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -4552.026845568417}, "policy_reward_mean": {"policy_0": -25064.826638593862}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8584303793041692, "mean_inference_ms": 0.8216313348822389, "mean_action_processing_ms": 0.25724048188611026, "mean_env_wait_ms": 1.258662565879677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330742518107096, "StateBufferConnector_ms": 0.00833272933959961, "ViewRequirementAgentConnector_ms": 0.43326616287231445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 466.36222633017707, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 504000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 8753.003, "sample_time_ms": 6555.197, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 12, "training_iteration": 126, "trial_id": "302a8_00000", "date": "2023-09-20_10-50-23", "timestamp": 1695199823, "time_this_iter_s": 8.579023599624634, "time_total_s": 1085.9800424575806, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061DFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1085.9800424575806, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 5.9333333333333345, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.621640128034353}, "policy_0": {"total_loss": 7.621640128034353, "policy_loss": 0.010365070521831513, "vf_loss": 7.5942937831290065, "vf_loss_unclipped": 53.74652423852756, "vf_explained_var": -0.18306628885269166, "entropy": -4.130623361206054, "mean_kl_loss": 0.033091780340950935, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7697353363037109}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 463.84924112260745, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 508000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 8732.471, "sample_time_ms": 6538.638, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 127, "trial_id": "302a8_00000", "date": "2023-09-20_10-50-32", "timestamp": 1695199832, "time_this_iter_s": 8.62549090385437, "time_total_s": 1094.605533361435, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061F9A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1094.605533361435, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 6.625000000000001, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.540372827300057}, "policy_0": {"total_loss": 3.540372827300057, "policy_loss": 0.00509790326282382, "vf_loss": 3.5231727839916944, "vf_loss_unclipped": 6.233695249792934, "vf_explained_var": -0.25887835912704465, "entropy": -4.066557956314087, "mean_kl_loss": 0.015722484086523762, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7697353363037109}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 486.93864913226366, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 512000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 8673.132, "sample_time_ms": 6485.91, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 128, "trial_id": "302a8_00000", "date": "2023-09-20_10-50-40", "timestamp": 1695199840, "time_this_iter_s": 8.216586828231812, "time_total_s": 1102.8221201896667, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10698430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1102.8221201896667, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 5.558333333333334, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.8646653335750103}, "policy_0": {"total_loss": 3.8646653335750103, "policy_loss": -0.0002714769959449768, "vf_loss": 3.8614798056043687, "vf_loss_unclipped": 299.3353553697981, "vf_explained_var": -0.19036905794143677, "entropy": -3.1499234000205996, "mean_kl_loss": 0.004491143168565031, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 486.79986208336925, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 516000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 8607.867, "sample_time_ms": 6430.268, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 129, "trial_id": "302a8_00000", "date": "2023-09-20_10-50-48", "timestamp": 1695199848, "time_this_iter_s": 8.218929052352905, "time_total_s": 1111.0410492420197, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1111.0410492420197, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 5.236363636363636, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.21535205618143}, "policy_0": {"total_loss": 5.21535205618143, "policy_loss": 0.0047415441334247585, "vf_loss": 5.206527211388573, "vf_loss_unclipped": 2556.1933503467644, "vf_explained_var": 0.04033152027130127, "entropy": 2.0202738311767576, "mean_kl_loss": 0.01060970219169394, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.38486766815185547}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 482.1206160190494, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 520000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 8568.727, "sample_time_ms": 6395.507, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 130, "trial_id": "302a8_00000", "date": "2023-09-20_10-50-57", "timestamp": 1695199857, "time_this_iter_s": 8.298678874969482, "time_total_s": 1119.3397281169891, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061E8C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1119.3397281169891, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 5.016666666666667, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.482394304361939}, "policy_0": {"total_loss": 5.482394304361939, "policy_loss": 0.032841823026537896, "vf_loss": 5.4280002906113864, "vf_loss_unclipped": 2887.6434871650013, "vf_explained_var": -0.08955151529312133, "entropy": 2.3754798976898193, "mean_kl_loss": 0.05599894972464536, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.5773015022277832}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 480.15181496880984, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 524000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 8520.886, "sample_time_ms": 6358.46, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 131, "trial_id": "302a8_00000", "date": "2023-09-20_10-51-05", "timestamp": 1695199865, "time_this_iter_s": 8.331698894500732, "time_total_s": 1127.6714270114899, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C9D0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1127.6714270114899, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 5.525000000000001, "ram_util_percent": 39.68333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.6173970463935285}, "policy_0": {"total_loss": 5.6173970463935285, "policy_loss": 0.01783504694700241, "vf_loss": 5.581111458410323, "vf_loss_unclipped": 2980.1512649797573, "vf_explained_var": -0.03346325397491455, "entropy": 2.3647001773834226, "mean_kl_loss": 0.031959991392469966, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8659522533416748}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.39966015228225, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 528000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 8456.335, "sample_time_ms": 6304.65, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 132, "trial_id": "302a8_00000", "date": "2023-09-20_10-51-13", "timestamp": 1695199873, "time_this_iter_s": 8.242632389068604, "time_total_s": 1135.9140594005585, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F5C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1135.9140594005585, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 5.572727272727271, "ram_util_percent": 39.68181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.58738127777651}, "policy_0": {"total_loss": 5.58738127777651, "policy_loss": 0.002885951380431652, "vf_loss": 5.576101217484474, "vf_loss_unclipped": 3134.4265027521374, "vf_explained_var": 0.0070478133201599125, "entropy": 2.4579701246261596, "mean_kl_loss": 0.009693509822030318, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8659522533416748}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.0215075374095, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 532000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 8384.705, "sample_time_ms": 6248.304, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 133, "trial_id": "302a8_00000", "date": "2023-09-20_10-51-21", "timestamp": 1695199881, "time_this_iter_s": 8.248057126998901, "time_total_s": 1144.1621165275574, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106981F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1144.1621165275574, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 5.041666666666666, "ram_util_percent": 39.675000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.372559672919661}, "policy_0": {"total_loss": 5.372559672919661, "policy_loss": 0.0021277755096554755, "vf_loss": 5.362653185766935, "vf_loss_unclipped": 3307.3861803788363, "vf_explained_var": 0.01697294464111328, "entropy": 2.525164938545227, "mean_kl_loss": 0.008982827931293286, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8659522533416748}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.1227937346433, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 536000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 8341.26, "sample_time_ms": 6212.246, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 134, "trial_id": "302a8_00000", "date": "2023-09-20_10-51-30", "timestamp": 1695199890, "time_this_iter_s": 8.247334957122803, "time_total_s": 1152.4094514846802, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10698DC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1152.4094514846802, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 5.216666666666667, "ram_util_percent": 39.65833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.291313452842831}, "policy_0": {"total_loss": 5.291313452842831, "policy_loss": 0.018398742005228997, "vf_loss": 5.246562777742744, "vf_loss_unclipped": 3292.3829398628563, "vf_explained_var": 0.017645121955871583, "entropy": 2.632256429195404, "mean_kl_loss": 0.030431141759219463, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2989283800125122}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.2501697500495, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 540000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 8323.56, "sample_time_ms": 6202.232, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 135, "trial_id": "302a8_00000", "date": "2023-09-20_10-51-38", "timestamp": 1695199898, "time_this_iter_s": 8.24517011642456, "time_total_s": 1160.6546216011047, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106996C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1160.6546216011047, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 5.618181818181818, "ram_util_percent": 39.69090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.976548960569687}, "policy_0": {"total_loss": 5.976548960569687, "policy_loss": 0.0010087228000164033, "vf_loss": 5.968998396712542, "vf_loss_unclipped": 3324.2890228145898, "vf_explained_var": -0.016862983798980713, "entropy": 2.814571843624115, "mean_kl_loss": 0.005036346561205573, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2989283800125122}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 488.0612850697351, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 544000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 8285.427, "sample_time_ms": 6177.097, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 136, "trial_id": "302a8_00000", "date": "2023-09-20_10-51-46", "timestamp": 1695199906, "time_this_iter_s": 8.196692705154419, "time_total_s": 1168.8513143062592, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F6A70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1168.8513143062592, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 5.766666666666666, "ram_util_percent": 39.69166666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 6.959962657916546}, "policy_0": {"total_loss": 6.959962657916546, "policy_loss": 0.002148707091808319, "vf_loss": 6.9484482166290285, "vf_loss_unclipped": 3597.58255780859, "vf_explained_var": -0.030189855670928956, "entropy": 3.6892438071250915, "mean_kl_loss": 0.0072103371126118875, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2989283800125122}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 484.40779606731877, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 548000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 8248.829, "sample_time_ms": 6140.587, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 137, "trial_id": "302a8_00000", "date": "2023-09-20_10-51-54", "timestamp": 1695199914, "time_this_iter_s": 8.259506464004517, "time_total_s": 1177.1108207702637, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061EB90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1177.1108207702637, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 5.041666666666666, "ram_util_percent": 39.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.451011491301657}, "policy_0": {"total_loss": 8.451011491301657, "policy_loss": 0.12398452000319958, "vf_loss": 8.084045668798685, "vf_loss_unclipped": 4604.385713322836, "vf_explained_var": 0.010863367557525636, "entropy": 5.559828442621231, "mean_kl_loss": 0.18706289790806477, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.948392629623413}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 483.7626300154801, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 552000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 8254.222, "sample_time_ms": 6141.903, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 138, "trial_id": "302a8_00000", "date": "2023-09-20_10-52-03", "timestamp": 1695199923, "time_this_iter_s": 8.270517826080322, "time_total_s": 1185.381338596344, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061F9A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1185.381338596344, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 7.236363636363635, "ram_util_percent": 39.63636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.96017681798935}, "policy_0": {"total_loss": 7.96017681798935, "policy_loss": 0.00035882296562194825, "vf_loss": 7.953820439267158, "vf_loss_unclipped": 4737.627974989056, "vf_explained_var": -0.006147110843658448, "entropy": 6.092107339763642, "mean_kl_loss": 0.0030782065691140814, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.9741963148117065}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.8915957448627, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 556000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 8269.539, "sample_time_ms": 6153.392, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 139, "trial_id": "302a8_00000", "date": "2023-09-20_10-52-11", "timestamp": 1695199931, "time_this_iter_s": 8.372098684310913, "time_total_s": 1193.753437280655, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1193.753437280655, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 8.025, "ram_util_percent": 39.616666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.10543665649891}, "policy_0": {"total_loss": 8.10543665649891, "policy_loss": 0.011619844055175781, "vf_loss": 8.08343422871828, "vf_loss_unclipped": 4701.849043114674, "vf_explained_var": 0.0007656331062316894, "entropy": 6.1732988101005555, "mean_kl_loss": 0.010657614771744192, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.9741963148117065}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 480.7601006749181, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 560000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 8271.887, "sample_time_ms": 6156.471, "synch_weights_time_ms": 2.14}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 140, "trial_id": "302a8_00000", "date": "2023-09-20_10-52-19", "timestamp": 1695199939, "time_this_iter_s": 8.322165727615356, "time_total_s": 1202.0756030082703, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10590C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1202.0756030082703, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 6.675, "ram_util_percent": 39.60833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.736050462192297}, "policy_0": {"total_loss": 7.736050462192297, "policy_loss": 0.0015641303896903993, "vf_loss": 7.731166407161951, "vf_loss_unclipped": 4818.470262758404, "vf_explained_var": 0.002305191516876221, "entropy": 6.248107205295563, "mean_kl_loss": 0.003407860799077025, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.48709815740585327}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 481.36334161073285, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 564000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 8269.79, "sample_time_ms": 6149.807, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 141, "trial_id": "302a8_00000", "date": "2023-09-20_10-52-28", "timestamp": 1695199948, "time_this_iter_s": 8.310730457305908, "time_total_s": 1210.3863334655762, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061D000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1210.3863334655762, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 6.7, "ram_util_percent": 39.618181818181824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.014712610818446}, "policy_0": {"total_loss": 8.014712610818446, "policy_loss": 0.008801336497068405, "vf_loss": 8.001580671221017, "vf_loss_unclipped": 4798.075528028398, "vf_explained_var": -0.0052181365013122556, "entropy": 6.301601448154449, "mean_kl_loss": 0.00889060092897489, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.48709815740585327}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 482.6842665252859, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 568000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 8274.426, "sample_time_ms": 6153.22, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 142, "trial_id": "302a8_00000", "date": "2023-09-20_10-52-36", "timestamp": 1695199956, "time_this_iter_s": 8.288990259170532, "time_total_s": 1218.6753237247467, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1050E710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1218.6753237247467, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 5.625, "ram_util_percent": 39.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.965069955264032}, "policy_0": {"total_loss": 7.965069955264032, "policy_loss": 0.0005858618259429932, "vf_loss": 7.961718865346908, "vf_loss_unclipped": 4341.138626847983, "vf_explained_var": 0.010223233413696289, "entropy": 5.788413400936126, "mean_kl_loss": 0.005676917802780372, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.48709815740585327}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.628622918875, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 572000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 8273.395, "sample_time_ms": 6152.091, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 143, "trial_id": "302a8_00000", "date": "2023-09-20_10-52-44", "timestamp": 1695199964, "time_this_iter_s": 8.238747596740723, "time_total_s": 1226.9140713214874, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061FAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1226.9140713214874, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 5.483333333333333, "ram_util_percent": 39.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.857317589777708}, "policy_0": {"total_loss": 7.857317589777708, "policy_loss": 0.009545011669397354, "vf_loss": 7.842014992159605, "vf_loss_unclipped": 4536.314208159274, "vf_explained_var": -0.005315834140777588, "entropy": 6.239446891212463, "mean_kl_loss": 0.011820199636978942, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.48709815740585327}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -97889.98358513547, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2962.22945608809}, "policy_reward_mean": {"policy_0": -24472.495896283945}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8577108152445441, "mean_inference_ms": 0.8208285912480556, "mean_action_processing_ms": 0.2568524385229091, "mean_env_wait_ms": 1.2561865656119235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007140636444091797, "StateBufferConnector_ms": 0.007142339433942523, "ViewRequirementAgentConnector_ms": 0.46423162732805523}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.1485918683411, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 576000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 8273.351, "sample_time_ms": 6151.639, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 144, "trial_id": "302a8_00000", "date": "2023-09-20_10-52-53", "timestamp": 1695199973, "time_this_iter_s": 8.246896982192993, "time_total_s": 1235.1609683036804, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061D000>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1235.1609683036804, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 5.881818181818182, "ram_util_percent": 39.62727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.123864287471772}, "policy_0": {"total_loss": 8.123864287471772, "policy_loss": 0.01998029307462275, "vf_loss": 8.079499704492651, "vf_loss_unclipped": 51.81440107969102, "vf_explained_var": -0.03911252851486206, "entropy": -4.6956701772689815, "mean_kl_loss": 0.05006039218041697, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7306472063064575}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 469.6384485531098, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 580000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 8300.753, "sample_time_ms": 6178.138, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 145, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-01", "timestamp": 1695199981, "time_this_iter_s": 8.519191026687622, "time_total_s": 1243.680159330368, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1243.680159330368, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 5.391666666666667, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.621687863729149}, "policy_0": {"total_loss": 4.621687863729149, "policy_loss": 0.002144711124897003, "vf_loss": 4.596237647468411, "vf_loss_unclipped": 49.759965832168426, "vf_explained_var": -0.08846373653411865, "entropy": -4.549754185247421, "mean_kl_loss": 0.03189707264238968, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.095970869064331}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 488.7591646261664, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 584000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 8299.583, "sample_time_ms": 6174.34, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 146, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-09", "timestamp": 1695199989, "time_this_iter_s": 8.185989379882812, "time_total_s": 1251.8661487102509, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10698550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1251.8661487102509, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 5.791666666666667, "ram_util_percent": 39.708333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.573180774706602}, "policy_0": {"total_loss": 8.573180774706602, "policy_loss": 0.03446948876976967, "vf_loss": 8.493591298222542, "vf_loss_unclipped": 3664.0600210557222, "vf_explained_var": 0.0303836067199707, "entropy": 3.271156274306774, "mean_kl_loss": 0.04116894005404738, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.6439563035964966}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 488.78275926886477, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 588000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 8292.192, "sample_time_ms": 6168.71, "synch_weights_time_ms": 2.04}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 147, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-17", "timestamp": 1695199997, "time_this_iter_s": 8.18559455871582, "time_total_s": 1260.0517432689667, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10698790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1260.0517432689667, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 5.866666666666666, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.887368026523292}, "policy_0": {"total_loss": 7.887368026523292, "policy_loss": 0.0006684422910213471, "vf_loss": 7.882969954010845, "vf_loss_unclipped": 3977.062736987397, "vf_explained_var": -0.0190508207321167, "entropy": 4.141938264417648, "mean_kl_loss": 0.002268687202534056, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8219781517982483}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 490.02774110722237, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 592000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 8281.62, "sample_time_ms": 6162.347, "synch_weights_time_ms": 1.94}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 148, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-26", "timestamp": 1695200006, "time_this_iter_s": 8.164802551269531, "time_total_s": 1268.2165458202362, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1268.2165458202362, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 5.909090909090909, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.637284093236923}, "policy_0": {"total_loss": 7.637284093236923, "policy_loss": 0.0015877097427845002, "vf_loss": 7.631151362621784, "vf_loss_unclipped": 4538.2511239418145, "vf_explained_var": -0.01047806634902954, "entropy": 5.194662303543091, "mean_kl_loss": 0.005529387111052711, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8219781517982483}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.09546950316303, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 596000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 8269.19, "sample_time_ms": 6153.698, "synch_weights_time_ms": 1.94}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 149, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-34", "timestamp": 1695200014, "time_this_iter_s": 8.247799158096313, "time_total_s": 1276.4643449783325, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10699E10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1276.4643449783325, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 4.866666666666666, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.614147403752804}, "policy_0": {"total_loss": 7.614147403752804, "policy_loss": 0.006394998627156019, "vf_loss": 7.59975800075233, "vf_loss_unclipped": 4762.4166595266315, "vf_explained_var": 0.035061391735076906, "entropy": 5.468769883728028, "mean_kl_loss": 0.009725804510223406, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8219781517982483}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 483.8073408636206, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 600000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 8263.95, "sample_time_ms": 6150.469, "synch_weights_time_ms": 1.9}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 150, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-42", "timestamp": 1695200022, "time_this_iter_s": 8.269754648208618, "time_total_s": 1284.7340996265411, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069A7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1284.7340996265411, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 5.5, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.7700789472699165}, "policy_0": {"total_loss": 7.7700789472699165, "policy_loss": 0.00508498860001564, "vf_loss": 7.75943133366704, "vf_loss_unclipped": 4974.542965857821, "vf_explained_var": 0.012369308567047118, "entropy": 5.583195330238342, "mean_kl_loss": 0.006767389830654065, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8219781517982483}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 483.4110348147701, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 604000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 8260.43, "sample_time_ms": 6149.735, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 151, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-50", "timestamp": 1695200030, "time_this_iter_s": 8.27653169631958, "time_total_s": 1293.0106313228607, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C8B0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1293.0106313228607, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 5.5249999999999995, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.655830883930996}, "policy_0": {"total_loss": 7.655830883930996, "policy_loss": 0.01068661632090807, "vf_loss": 7.635618227301538, "vf_loss_unclipped": 5037.252113024055, "vf_explained_var": 0.021423533153533937, "entropy": 5.681783440971374, "mean_kl_loss": 0.011589193760521447, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8219781517982483}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 487.15639176846673, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 608000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 8252.822, "sample_time_ms": 6144.871, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 152, "trial_id": "302a8_00000", "date": "2023-09-20_10-53-59", "timestamp": 1695200039, "time_this_iter_s": 8.211915493011475, "time_total_s": 1301.2225468158722, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069A830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1301.2225468158722, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 5.8500000000000005, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.658241708111763}, "policy_0": {"total_loss": 7.658241708111763, "policy_loss": 0.005085864327102899, "vf_loss": 7.649389803934097, "vf_loss_unclipped": 5148.87829262681, "vf_explained_var": 0.013847295761108398, "entropy": 5.761536094093323, "mean_kl_loss": 0.004581691797501117, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.41098907589912415}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 484.3462921988888, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 612000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 8255.003, "sample_time_ms": 6150.011, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 153, "trial_id": "302a8_00000", "date": "2023-09-20_10-54-07", "timestamp": 1695200047, "time_this_iter_s": 8.260554313659668, "time_total_s": 1309.4831011295319, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B105F7520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1309.4831011295319, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 7.745454545454544, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.653769914102554}, "policy_0": {"total_loss": 7.653769914102554, "policy_loss": 0.029535865956544876, "vf_loss": 7.61158297662288, "vf_loss_unclipped": 5121.124310640044, "vf_explained_var": 0.03487283124923706, "entropy": 5.871715320396423, "mean_kl_loss": 0.03078206865859711, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6164836287498474}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 484.45333969060067, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 616000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 8256.186, "sample_time_ms": 6153.594, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 154, "trial_id": "302a8_00000", "date": "2023-09-20_10-54-15", "timestamp": 1695200055, "time_this_iter_s": 8.258727550506592, "time_total_s": 1317.7418286800385, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10698550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1317.7418286800385, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 6.425, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.66968895611763}, "policy_0": {"total_loss": 7.66968895611763, "policy_loss": 0.017288921949267386, "vf_loss": 7.642121542173624, "vf_loss_unclipped": 5053.812853656966, "vf_explained_var": -0.0035577009201049805, "entropy": 5.87968864326477, "mean_kl_loss": 0.016672785176213255, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6164836287498474}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.58940741604755, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 620000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 8228.208, "sample_time_ms": 6127.228, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 155, "trial_id": "302a8_00000", "date": "2023-09-20_10-54-24", "timestamp": 1695200064, "time_this_iter_s": 8.239411354064941, "time_total_s": 1325.9812400341034, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106984C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1325.9812400341034, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 5.316666666666666, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.760057569539547}, "policy_0": {"total_loss": 7.760057569539547, "policy_loss": 0.02524046636223793, "vf_loss": 7.718786982005835, "vf_loss_unclipped": 5174.888070708888, "vf_explained_var": -0.005453769683837891, "entropy": 5.9784057933807375, "mean_kl_loss": 0.026002494148722143, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.9247254133224487}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.31313879672933, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 624000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 8234.019, "sample_time_ms": 6132.426, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 156, "trial_id": "302a8_00000", "date": "2023-09-20_10-54-32", "timestamp": 1695200072, "time_this_iter_s": 8.243100881576538, "time_total_s": 1334.22434091568, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069AF80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1334.22434091568, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 5.8090909090909095, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.704539001238346}, "policy_0": {"total_loss": 7.704539001238346, "policy_loss": 0.004366392856836319, "vf_loss": 7.694921770116687, "vf_loss_unclipped": 5105.424664487859, "vf_explained_var": -0.008326606845855712, "entropy": 6.098773324775696, "mean_kl_loss": 0.005678282548002244, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.9247254133224487}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 454.65524719924645, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 628000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 8295.448, "sample_time_ms": 6181.461, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 157, "trial_id": "302a8_00000", "date": "2023-09-20_10-54-41", "timestamp": 1695200081, "time_this_iter_s": 8.799875497817993, "time_total_s": 1343.024216413498, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069B910>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1343.024216413498, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 5.8538461538461535, "ram_util_percent": 39.83076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.770666137906909}, "policy_0": {"total_loss": 7.770666137906909, "policy_loss": 0.005388446705043316, "vf_loss": 7.759429028815031, "vf_loss_unclipped": 5148.611855447501, "vf_explained_var": 0.009768692302703857, "entropy": 6.177604660797119, "mean_kl_loss": 0.006324728294048692, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.9247254133224487}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 482.7874407242668, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 632000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 8307.689, "sample_time_ms": 6192.864, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 158, "trial_id": "302a8_00000", "date": "2023-09-20_10-54-49", "timestamp": 1695200089, "time_this_iter_s": 8.287219285964966, "time_total_s": 1351.311435699463, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061E050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1351.311435699463, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 5.4363636363636365, "ram_util_percent": 39.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.851954800081253}, "policy_0": {"total_loss": 7.851954800081253, "policy_loss": 0.02844879683852196, "vf_loss": 7.799581480446458, "vf_loss_unclipped": 4950.294914149514, "vf_explained_var": -0.0057663333892822265, "entropy": 6.236432724952698, "mean_kl_loss": 0.02587203388329617, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.3870880603790283}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 485.05935518322633, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 636000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 8307.651, "sample_time_ms": 6190.626, "synch_weights_time_ms": 2.0}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 159, "trial_id": "302a8_00000", "date": "2023-09-20_10-54-57", "timestamp": 1695200097, "time_this_iter_s": 8.247413635253906, "time_total_s": 1359.5588493347168, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10590C10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1359.5588493347168, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 4.916666666666666, "ram_util_percent": 39.80833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.776782021582127}, "policy_0": {"total_loss": 7.776782021582127, "policy_loss": 0.009599420857429505, "vf_loss": 7.752786379492282, "vf_loss_unclipped": 7243.456064647544, "vf_explained_var": -0.007022389030456543, "entropy": 6.256802911567688, "mean_kl_loss": 0.010378735768039042, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.3870880603790283}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 472.93534960880515, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 640000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 8326.657, "sample_time_ms": 6207.612, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 160, "trial_id": "302a8_00000", "date": "2023-09-20_10-55-06", "timestamp": 1695200106, "time_this_iter_s": 8.459816217422485, "time_total_s": 1368.0186655521393, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069B490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1368.0186655521393, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 4.183333333333333, "ram_util_percent": 39.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.722931266760826}, "policy_0": {"total_loss": 9.722931266760826, "policy_loss": 0.019910273975133896, "vf_loss": 9.679227531659603, "vf_loss_unclipped": 11471.57189392494, "vf_explained_var": -0.005262243461608886, "entropy": 7.827235514473915, "mean_kl_loss": 0.017153519029980815, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.3870880603790283}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 470.01281487714704, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 644000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 8350.244, "sample_time_ms": 6227.738, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 161, "trial_id": "302a8_00000", "date": "2023-09-20_10-55-14", "timestamp": 1695200114, "time_this_iter_s": 8.512408256530762, "time_total_s": 1376.53107380867, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10698F70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1376.53107380867, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 6.2250000000000005, "ram_util_percent": 40.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 8.435726742124558}, "policy_0": {"total_loss": 8.435726742124558, "policy_loss": 0.03368705907408148, "vf_loss": 8.342622032791375, "vf_loss_unclipped": 10496.86236440683, "vf_explained_var": -0.01777583703994751, "entropy": 5.64077548160553, "mean_kl_loss": 0.04283622396293358, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.080632209777832}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -95370.08956543129, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23842.522391357867}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8566850051760858, "mean_inference_ms": 0.8196431184074978, "mean_action_processing_ms": 0.2564056524014082, "mean_env_wait_ms": 1.253265728269176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496113777160645, "StateBufferConnector_ms": 0.006249547004699707, "ViewRequirementAgentConnector_ms": 0.4624471068382263}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 482.9408111654639, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 648000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 8357.412, "sample_time_ms": 6228.078, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 16, "training_iteration": 162, "trial_id": "302a8_00000", "date": "2023-09-20_10-55-22", "timestamp": 1695200122, "time_this_iter_s": 8.284587621688843, "time_total_s": 1384.815661430359, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10699D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1384.815661430359, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 5.966666666666668, "ram_util_percent": 40.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.423829444026947}, "policy_0": {"total_loss": 7.423829444026947, "policy_loss": 0.024517618491500616, "vf_loss": 7.291264786467794, "vf_loss_unclipped": 47.42830088952566, "vf_explained_var": 0.1388256844520569, "entropy": -5.755860956192016, "mean_kl_loss": 0.05192989627119387, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 3.120948314666748}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 465.2619598821067, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 652000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 8391.287, "sample_time_ms": 6261.47, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 163, "trial_id": "302a8_00000", "date": "2023-09-20_10-55-31", "timestamp": 1695200131, "time_this_iter_s": 8.599306583404541, "time_total_s": 1393.4149680137634, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069BD90>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1393.4149680137634, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 4.725, "ram_util_percent": 39.85833333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.173233885586634}, "policy_0": {"total_loss": 4.173233885586634, "policy_loss": -0.000488603606633842, "vf_loss": 4.167335179676115, "vf_loss_unclipped": 68.7327411500588, "vf_explained_var": -0.09986232442855834, "entropy": -5.6404728138446805, "mean_kl_loss": 0.0020465895477682354, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.560474157333374}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 502.80026502390524, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 656000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 8361.158, "sample_time_ms": 6234.313, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 164, "trial_id": "302a8_00000", "date": "2023-09-20_10-55-39", "timestamp": 1695200139, "time_this_iter_s": 7.956441879272461, "time_total_s": 1401.371409893036, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1401.371409893036, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 4.718181818181818, "ram_util_percent": 39.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 7.332925491684676}, "policy_0": {"total_loss": 7.332925491684676, "policy_loss": 0.02311103128194809, "vf_loss": 7.258994832015038, "vf_loss_unclipped": 2994.001642664504, "vf_explained_var": -0.06995869388580322, "entropy": 1.313875511741638, "mean_kl_loss": 0.03256677250665962, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.3407111167907715}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 498.3002113642469, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 660000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 8340.146, "sample_time_ms": 6215.117, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 165, "trial_id": "302a8_00000", "date": "2023-09-20_10-55-47", "timestamp": 1695200147, "time_this_iter_s": 8.02928900718689, "time_total_s": 1409.4006989002228, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10699D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1409.4006989002228, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 4.59090909090909, "ram_util_percent": 39.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.3699100768644366}, "policy_0": {"total_loss": 5.3699100768644366, "policy_loss": 0.020872706908732653, "vf_loss": 5.280795104198158, "vf_loss_unclipped": 3017.7263333583637, "vf_explained_var": -0.017988708686828614, "entropy": 1.5737266410827637, "mean_kl_loss": 0.02915450586277293, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 3.5110666751861572}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 495.9444052799471, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 664000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 8322.478, "sample_time_ms": 6199.962, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 166, "trial_id": "302a8_00000", "date": "2023-09-20_10-55-55", "timestamp": 1695200155, "time_this_iter_s": 8.06641960144043, "time_total_s": 1417.4671185016632, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10699750>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1417.4671185016632, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 4.425, "ram_util_percent": 39.80833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.653253092683852}, "policy_0": {"total_loss": 5.653253092683852, "policy_loss": 0.04096091175377369, "vf_loss": 5.422526406139135, "vf_loss_unclipped": 3178.242142616695, "vf_explained_var": 0.02128842306137085, "entropy": 1.6984076669692993, "mean_kl_loss": 0.05404790102768602, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 5.266600131988525}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 491.39351895528216, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 668000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 8256.702, "sample_time_ms": 6142.18, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 167, "trial_id": "302a8_00000", "date": "2023-09-20_10-56-03", "timestamp": 1695200163, "time_this_iter_s": 8.142115592956543, "time_total_s": 1425.6092340946198, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069BB50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1425.6092340946198, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 6.118181818181818, "ram_util_percent": 39.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.577444472849369}, "policy_0": {"total_loss": 5.577444472849369, "policy_loss": 0.013602453529834748, "vf_loss": 5.4739458925426, "vf_loss_unclipped": 3377.125050197047, "vf_explained_var": 0.06149465246200562, "entropy": 1.8761005521774292, "mean_kl_loss": 0.017069097633555064, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 5.266600131988525}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 496.0404348909114, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 672000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 8234.466, "sample_time_ms": 6122.631, "synch_weights_time_ms": 2.201}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 168, "trial_id": "302a8_00000", "date": "2023-09-20_10-56-11", "timestamp": 1695200171, "time_this_iter_s": 8.065860033035278, "time_total_s": 1433.675094127655, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1433.675094127655, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 6.833333333333333, "ram_util_percent": 39.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.291964280040562}, "policy_0": {"total_loss": 5.291964280040562, "policy_loss": -0.0001026286631822586, "vf_loss": 5.288998643109203, "vf_loss_unclipped": 3311.6566575328798, "vf_explained_var": 0.07020783443450927, "entropy": 1.9926363300323486, "mean_kl_loss": 0.0005825800676422659, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 2.6333000659942627}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 495.66148892170804, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 676000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 8216.927, "sample_time_ms": 6108.871, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 169, "trial_id": "302a8_00000", "date": "2023-09-20_10-56-19", "timestamp": 1695200179, "time_this_iter_s": 8.07102346420288, "time_total_s": 1441.746117591858, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A4A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1441.746117591858, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 6.627272727272728, "ram_util_percent": 39.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.358796733031422}, "policy_0": {"total_loss": 5.358796733031422, "policy_loss": -4.6763098239898685e-05, "vf_loss": 5.350468485398591, "vf_loss_unclipped": 3389.116749660249, "vf_explained_var": 0.05808519458770752, "entropy": 2.086095235443115, "mean_kl_loss": 0.0031804233280563494, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.3166500329971313}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 493.83312593609855, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 680000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 8181.136, "sample_time_ms": 6079.479, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 170, "trial_id": "302a8_00000", "date": "2023-09-20_10-56-28", "timestamp": 1695200188, "time_this_iter_s": 8.10190224647522, "time_total_s": 1449.8480198383331, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069BB50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1449.8480198383331, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 6.3, "ram_util_percent": 39.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.320714578766003}, "policy_0": {"total_loss": 5.320714578766003, "policy_loss": 0.0002868963614106178, "vf_loss": 5.316740481947362, "vf_loss_unclipped": 3289.08597852516, "vf_explained_var": 0.011012855625152588, "entropy": 2.177709957122803, "mean_kl_loss": 0.0028004265954790753, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6583250164985657}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 498.7925463270989, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 684000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 8132.032, "sample_time_ms": 6033.457, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 171, "trial_id": "302a8_00000", "date": "2023-09-20_10-56-36", "timestamp": 1695200196, "time_this_iter_s": 8.020365715026855, "time_total_s": 1457.86838555336, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A5360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1457.86838555336, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 4.5249999999999995, "ram_util_percent": 39.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.224009920527041}, "policy_0": {"total_loss": 5.224009920527041, "policy_loss": 0.003852999848127365, "vf_loss": 5.213663115859032, "vf_loss_unclipped": 3303.799008585906, "vf_explained_var": 0.015586769008636474, "entropy": 2.268900622367859, "mean_kl_loss": 0.009864120729983552, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.6583250164985657}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 494.7756381947012, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 688000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 8112.22, "sample_time_ms": 6016.996, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 172, "trial_id": "302a8_00000", "date": "2023-09-20_10-56-44", "timestamp": 1695200204, "time_this_iter_s": 8.086471557617188, "time_total_s": 1465.9548571109772, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A5C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1465.9548571109772, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 4.381818181818182, "ram_util_percent": 39.71818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.60483893854171}, "policy_0": {"total_loss": 5.60483893854171, "policy_loss": -0.0002916437149047852, "vf_loss": 5.602563899821043, "vf_loss_unclipped": 3260.8534686872663, "vf_explained_var": 0.009867961025238037, "entropy": 2.352430735397339, "mean_kl_loss": 0.0038987957671823095, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 499.3120968457167, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 692000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 8053.591, "sample_time_ms": 5960.069, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 173, "trial_id": "302a8_00000", "date": "2023-09-20_10-56-52", "timestamp": 1695200212, "time_this_iter_s": 8.013020277023315, "time_total_s": 1473.9678773880005, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069AEF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1473.9678773880005, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 4.790909090909091, "ram_util_percent": 39.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.375747317935154}, "policy_0": {"total_loss": 5.375747317935154, "policy_loss": -0.00021050385236740112, "vf_loss": 5.3736807263463735, "vf_loss_unclipped": 1895.509197319898, "vf_explained_var": 0.023436842250823976, "entropy": -0.08350853469371795, "mean_kl_loss": 0.006917780695413239, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 494.70469043125416, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 696000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 8066.61, "sample_time_ms": 5964.963, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 174, "trial_id": "302a8_00000", "date": "2023-09-20_10-57-00", "timestamp": 1695200220, "time_this_iter_s": 8.086631536483765, "time_total_s": 1482.0545089244843, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106996C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1482.0545089244843, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 4.308333333333334, "ram_util_percent": 39.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.277683275102079}, "policy_0": {"total_loss": 5.277683275102079, "policy_loss": -0.00013361763954162597, "vf_loss": 5.275670796644688, "vf_loss_unclipped": 2197.5658990116717, "vf_explained_var": -0.0017776506423950195, "entropy": 0.36596630477905273, "mean_kl_loss": 0.0065198629694874395, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 489.653278167083, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 700000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 8080.786, "sample_time_ms": 5977.345, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 175, "trial_id": "302a8_00000", "date": "2023-09-20_10-57-08", "timestamp": 1695200228, "time_this_iter_s": 8.170551538467407, "time_total_s": 1490.2250604629517, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069B7F0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1490.2250604629517, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 4.59090909090909, "ram_util_percent": 39.809090909090905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.489532754365122}, "policy_0": {"total_loss": 5.489532754365122, "policy_loss": 0.002185496938228607, "vf_loss": 5.483709289062023, "vf_loss_unclipped": 1784.6772845137477, "vf_explained_var": 0.020537174606323243, "entropy": -0.565300718486309, "mean_kl_loss": 0.011052199266583193, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 180.27519674747631, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 704000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 9493.074, "sample_time_ms": 6996.512, "synch_weights_time_ms": 2.151}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 176, "trial_id": "302a8_00000", "date": "2023-09-20_10-57-30", "timestamp": 1695200250, "time_this_iter_s": 22.19029974937439, "time_total_s": 1512.415360212326, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A4040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1512.415360212326, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 5.909375000000001, "ram_util_percent": 39.796875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.645160364514589}, "policy_0": {"total_loss": 5.645160364514589, "policy_loss": -0.0002339117020368576, "vf_loss": 5.640815195061267, "vf_loss_unclipped": 1683.2762362933888, "vf_explained_var": 0.014007561016082764, "entropy": -1.063453610420227, "mean_kl_loss": 0.013911482667905511, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 178.6063212111944, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 708000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 10918.624, "sample_time_ms": 8040.865, "synch_weights_time_ms": 2.351}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 177, "trial_id": "302a8_00000", "date": "2023-09-20_10-57-53", "timestamp": 1695200273, "time_this_iter_s": 22.40462374687195, "time_total_s": 1534.819983959198, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A5900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1534.819983959198, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 5.845161290322581, "ram_util_percent": 39.79354838709676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.234481292639859}, "policy_0": {"total_loss": 5.234481292639859, "policy_loss": 0.0009873264316469432, "vf_loss": 5.23087335332334, "vf_loss_unclipped": 1009.1500247067779, "vf_explained_var": 0.019571813011169434, "entropy": -1.9904961770534515, "mean_kl_loss": 0.007961438704526518, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 175.28219029771606, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 712000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 12394.373, "sample_time_ms": 9061.794, "synch_weights_time_ms": 2.851}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 178, "trial_id": "302a8_00000", "date": "2023-09-20_10-58-16", "timestamp": 1695200296, "time_this_iter_s": 22.824344873428345, "time_total_s": 1557.6443288326263, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A6A70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1557.6443288326263, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 5.71875, "ram_util_percent": 39.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.1670690554913135}, "policy_0": {"total_loss": 5.1670690554913135, "policy_loss": -0.005078544998168945, "vf_loss": 5.165861836880445, "vf_loss_unclipped": 1600.1028848623932, "vf_explained_var": -0.01751924076080322, "entropy": -1.097998755455017, "mean_kl_loss": 0.019096228073444216, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 152.10456260306387, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 716000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 14217.141, "sample_time_ms": 10267.614, "synch_weights_time_ms": 3.351}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 179, "trial_id": "302a8_00000", "date": "2023-09-20_10-58-42", "timestamp": 1695200322, "time_this_iter_s": 26.30169987678528, "time_total_s": 1583.9460287094116, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1583.9460287094116, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 3.391891891891892, "ram_util_percent": 40.064864864864866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 4.597792329110205}, "policy_0": {"total_loss": 4.597792329110205, "policy_loss": 0.00019033276438713075, "vf_loss": 4.595344023431838, "vf_loss_unclipped": 1437.6189123267309, "vf_explained_var": -0.03029154977798462, "entropy": -0.7356637959480286, "mean_kl_loss": 0.00685976077420637, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.32916250824928284}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -96113.51554121688, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -24028.378885304257}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8556032373097312, "mean_inference_ms": 0.8184452162077631, "mean_action_processing_ms": 0.25596647916204796, "mean_env_wait_ms": 1.2504548060510843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016682677798800997, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.4721826977199978}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 154.44242574275108, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 720000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 15997.112, "sample_time_ms": 11485.274, "synch_weights_time_ms": 3.851}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 180, "trial_id": "302a8_00000", "date": "2023-09-20_10-59-08", "timestamp": 1695200348, "time_this_iter_s": 25.902619123458862, "time_total_s": 1609.8486478328705, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A56C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1609.8486478328705, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 3.1444444444444444, "ram_util_percent": 40.08611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.502901539051905}, "policy_0": {"total_loss": 5.502901539051905, "policy_loss": 0.02977500447407365, "vf_loss": 5.451874546125717, "vf_loss_unclipped": 39.49177946899254, "vf_explained_var": -0.019061167335510255, "entropy": -5.953652600479126, "mean_kl_loss": 0.06456377419345082, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.49374377727508545}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 146.96115152079534, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 724000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 17916.983, "sample_time_ms": 12789.292, "synch_weights_time_ms": 4.106}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 181, "trial_id": "302a8_00000", "date": "2023-09-20_10-59-35", "timestamp": 1695200375, "time_this_iter_s": 27.22210121154785, "time_total_s": 1637.0707490444183, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A4430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1637.0707490444183, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 2.953846153846154, "ram_util_percent": 40.087179487179476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.749246147403121}, "policy_0": {"total_loss": 2.749246147403121, "policy_loss": 0.0031866805247962476, "vf_loss": 2.738241002398357, "vf_loss_unclipped": 7.314076706820354, "vf_explained_var": -0.03058275890350342, "entropy": -5.904052700042724, "mean_kl_loss": 0.015835123912617564, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.49374377727508545}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 196.02776470806523, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 728000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 19149.064, "sample_time_ms": 14002.242, "synch_weights_time_ms": 4.106}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 182, "trial_id": "302a8_00000", "date": "2023-09-20_10-59-56", "timestamp": 1695200396, "time_this_iter_s": 20.407275915145874, "time_total_s": 1657.4780249595642, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A5CF0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1657.4780249595642, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 4.2178571428571425, "ram_util_percent": 40.09642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.470145545588061}, "policy_0": {"total_loss": 5.470145545588061, "policy_loss": 0.0014533370040357113, "vf_loss": 5.463821908086539, "vf_loss_unclipped": 2163.6660096177043, "vf_explained_var": -0.13488911237716675, "entropy": -0.32325915017127993, "mean_kl_loss": 0.009864043364406098, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.49374377727508545}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 498.2469813859023, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 732000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 19150.776, "sample_time_ms": 14002.146, "synch_weights_time_ms": 4.106}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 183, "trial_id": "302a8_00000", "date": "2023-09-20_11-00-04", "timestamp": 1695200404, "time_this_iter_s": 8.030147790908813, "time_total_s": 1665.508172750473, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069B490>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1665.508172750473, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 5.6499999999999995, "ram_util_percent": 40.091666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.279073468706012}, "policy_0": {"total_loss": 5.279073468706012, "policy_loss": 0.0057323777794837955, "vf_loss": 5.264446129091084, "vf_loss_unclipped": 2336.143246886499, "vf_explained_var": -0.09393132991790772, "entropy": 0.425897827911377, "mean_kl_loss": 0.018015312042552977, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.49374377727508545}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 501.68478035298875, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 736000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 19139.526, "sample_time_ms": 13999.089, "synch_weights_time_ms": 4.106}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 184, "trial_id": "302a8_00000", "date": "2023-09-20_11-00-12", "timestamp": 1695200412, "time_this_iter_s": 7.974133729934692, "time_total_s": 1673.4823064804077, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069BD00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1673.4823064804077, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 6.909090909090909, "ram_util_percent": 40.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.4255960154563185}, "policy_0": {"total_loss": 5.4255960154563185, "policy_loss": 0.0019654565304517745, "vf_loss": 5.417686062253266, "vf_loss_unclipped": 2757.703460877622, "vf_explained_var": -0.013346759700775146, "entropy": 0.9098583030700683, "mean_kl_loss": 0.012039630289183697, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.49374377727508545}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 498.3428094576328, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 740000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 19125.282, "sample_time_ms": 13986.072, "synch_weights_time_ms": 4.106}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 185, "trial_id": "302a8_00000", "date": "2023-09-20_11-00-20", "timestamp": 1695200420, "time_this_iter_s": 8.028603076934814, "time_total_s": 1681.5109095573425, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069BF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1681.5109095573425, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 6.245454545454546, "ram_util_percent": 40.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.318615522739291}, "policy_0": {"total_loss": 5.318615522739291, "policy_loss": 0.013170287001132965, "vf_loss": 5.294836772294715, "vf_loss_unclipped": 3324.0365239018874, "vf_explained_var": 0.04605848665237427, "entropy": 1.9022904228210449, "mean_kl_loss": 0.021485764258290872, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7406156659126282}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 490.7611605554911, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 744000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 17721.513, "sample_time_ms": 12978.478, "synch_weights_time_ms": 3.956}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 186, "trial_id": "302a8_00000", "date": "2023-09-20_11-00-28", "timestamp": 1695200428, "time_this_iter_s": 8.152110576629639, "time_total_s": 1689.6630201339722, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A6320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1689.6630201339722, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 6.333333333333333, "ram_util_percent": 40.091666666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.3421234227612615}, "policy_0": {"total_loss": 5.3421234227612615, "policy_loss": 0.008433485035598279, "vf_loss": 5.3209624380081895, "vf_loss_unclipped": 2969.623618239781, "vf_explained_var": 0.07422413291931153, "entropy": 1.5954736824035645, "mean_kl_loss": 0.017185050762892933, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7406156659126282}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 501.157423656847, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 748000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 16280.103, "sample_time_ms": 11926.136, "synch_weights_time_ms": 3.656}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 187, "trial_id": "302a8_00000", "date": "2023-09-20_11-00-36", "timestamp": 1695200436, "time_this_iter_s": 7.982500791549683, "time_total_s": 1697.6455209255219, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A4280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1697.6455209255219, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 4.954545454545454, "ram_util_percent": 40.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.267969544488191}, "policy_0": {"total_loss": 5.267969544488191, "policy_loss": 0.006815432746708393, "vf_loss": 5.24989097501114, "vf_loss_unclipped": 3320.631444978536, "vf_explained_var": 0.06428579092025757, "entropy": 2.028403161621094, "mean_kl_loss": 0.01520780057630036, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7406156659126282}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 498.23567684417065, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 752000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 14800.901, "sample_time_ms": 10903.955, "synch_weights_time_ms": 3.156}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 188, "trial_id": "302a8_00000", "date": "2023-09-20_11-00-44", "timestamp": 1695200444, "time_this_iter_s": 8.030329465866089, "time_total_s": 1705.675850391388, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A71C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1705.675850391388, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 4.5636363636363635, "ram_util_percent": 39.97272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.339843983244896}, "policy_0": {"total_loss": 5.339843983244896, "policy_loss": 0.006050520578026772, "vf_loss": 5.324035469651222, "vf_loss_unclipped": 3235.1379731817483, "vf_explained_var": 0.014477666854858398, "entropy": 2.1242109798431397, "mean_kl_loss": 0.013175558865687343, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7406156659126282}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 484.94154068427065, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 756000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 12995.973, "sample_time_ms": 9717.977, "synch_weights_time_ms": 2.756}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 189, "trial_id": "302a8_00000", "date": "2023-09-20_11-00-52", "timestamp": 1695200452, "time_this_iter_s": 8.250416994094849, "time_total_s": 1713.9262673854828, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A7AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1713.9262673854828, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 6.133333333333334, "ram_util_percent": 40.025000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.32442124452591}, "policy_0": {"total_loss": 5.32442124452591, "policy_loss": 0.006739138901233673, "vf_loss": 5.307382723650337, "vf_loss_unclipped": 2909.0618626274436, "vf_explained_var": 0.0501368878364563, "entropy": 1.600099972009659, "mean_kl_loss": 0.013906510911340592, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.7406156659126282}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 500.8140324750898, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 760000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 11204.711, "sample_time_ms": 8488.443, "synch_weights_time_ms": 2.256}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 190, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-00", "timestamp": 1695200460, "time_this_iter_s": 7.989997625350952, "time_total_s": 1721.9162650108337, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1069A170>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1721.9162650108337, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 3.8636363636363638, "ram_util_percent": 40.127272727272725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.333712768256664}, "policy_0": {"total_loss": 5.333712768256664, "policy_loss": 0.016299083970487117, "vf_loss": 5.298006072235108, "vf_loss_unclipped": 3211.923149571991, "vf_explained_var": 0.009784336376190186, "entropy": 2.2854944034576414, "mean_kl_loss": 0.02620468600570457, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1109235286712646}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 497.89479897604207, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 764000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 9286.285, "sample_time_ms": 7190.317, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 191, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-08", "timestamp": 1695200468, "time_this_iter_s": 8.035825490951538, "time_total_s": 1729.9520905017853, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B1061C550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1729.9520905017853, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 3.4749999999999996, "ram_util_percent": 40.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.521638665661216}, "policy_0": {"total_loss": 5.521638665661216, "policy_loss": 0.005404083102196455, "vf_loss": 5.504761020827293, "vf_loss_unclipped": 3180.279031895995, "vf_explained_var": 0.009256872081756592, "entropy": 2.3204125156402586, "mean_kl_loss": 0.01032794612342259, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1109235286712646}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 496.71592016646, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 768000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 8051.047, "sample_time_ms": 5977.221, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 192, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-16", "timestamp": 1695200476, "time_this_iter_s": 8.054893493652344, "time_total_s": 1738.0069839954376, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A7BE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1738.0069839954376, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 3.6090909090909093, "ram_util_percent": 40.00909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.298830956661702}, "policy_0": {"total_loss": 5.298830956661702, "policy_loss": 0.004991869032382965, "vf_loss": 5.282770592913032, "vf_loss_unclipped": 3064.224851772341, "vf_explained_var": 0.0016125707626342774, "entropy": 2.2330768478393557, "mean_kl_loss": 0.009963300125580282, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1109235286712646}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 490.626441801595, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 772000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 8063.517, "sample_time_ms": 5982.227, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 193, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-24", "timestamp": 1695200484, "time_this_iter_s": 8.154841184616089, "time_total_s": 1746.1618251800537, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A70A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1746.1618251800537, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 3.149999999999999, "ram_util_percent": 40.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.197963392610848}, "policy_0": {"total_loss": 5.197963392610848, "policy_loss": 0.0008527603536844253, "vf_loss": 5.190898880147934, "vf_loss_unclipped": 1782.4610279954434, "vf_explained_var": 0.04638277988433838, "entropy": -0.390687089920044, "mean_kl_loss": 0.005591514814365655, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1109235286712646}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 491.0222405890201, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 776000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 8080.831, "sample_time_ms": 5994.06, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 194, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-33", "timestamp": 1695200493, "time_this_iter_s": 8.14827013015747, "time_total_s": 1754.3100953102112, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A5240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1754.3100953102112, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 3.5, "ram_util_percent": 40.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.4926974748604}, "policy_0": {"total_loss": 5.4926974748604, "policy_loss": 0.0011486155033111573, "vf_loss": 5.484696863675118, "vf_loss_unclipped": 1574.9392104764222, "vf_explained_var": 0.006626435470581055, "entropy": -1.0011718479156495, "mean_kl_loss": 0.006167893202275445, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1109235286712646}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 489.64823355625265, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 780000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 8095.083, "sample_time_ms": 6006.765, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 195, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-41", "timestamp": 1695200501, "time_this_iter_s": 8.171130418777466, "time_total_s": 1762.4812257289886, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10700040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1762.4812257289886, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 4.291666666666667, "ram_util_percent": 40.15833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.347891700471938}, "policy_0": {"total_loss": 5.347891700471938, "policy_loss": 0.0016832019805908204, "vf_loss": 5.3373109614491465, "vf_loss_unclipped": 1697.637284301293, "vf_explained_var": -0.04332599678039551, "entropy": -0.3405581347465515, "mean_kl_loss": 0.008009159619236015, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.1109235286712646}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 473.2031739094185, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 784000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 8125.326, "sample_time_ms": 6031.787, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 196, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-49", "timestamp": 1695200509, "time_this_iter_s": 8.455028057098389, "time_total_s": 1770.936253786087, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A6200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1770.936253786087, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 3.2000000000000006, "ram_util_percent": 40.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.611664349031448}, "policy_0": {"total_loss": 5.611664349031448, "policy_loss": 0.05043443615436554, "vf_loss": 5.469078472542763, "vf_loss_unclipped": 2660.4165231670618, "vf_explained_var": 0.005520810317993164, "entropy": 1.7488472859382629, "mean_kl_loss": 0.08295030799610541, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.666385293006897}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 496.7070966886225, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 788000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 8132.477, "sample_time_ms": 6034.269, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 197, "trial_id": "302a8_00000", "date": "2023-09-20_11-01-57", "timestamp": 1695200517, "time_this_iter_s": 8.054034948348999, "time_total_s": 1778.990288734436, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B10700CA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1778.990288734436, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 3.963636363636364, "ram_util_percent": 40.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 5.525407360176742}, "policy_0": {"total_loss": 5.525407360176742, "policy_loss": 0.0009671585202217102, "vf_loss": 5.516393576508761, "vf_loss_unclipped": 2009.575299854356, "vf_explained_var": 0.011132833957672119, "entropy": 0.8310719697475434, "mean_kl_loss": 0.004828793314687209, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.8331926465034485}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -92387.22195768623, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -23096.80548942157}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8587618742958041, "mean_inference_ms": 0.8200212294775916, "mean_action_processing_ms": 0.2564390635619621, "mean_env_wait_ms": 1.253221266814031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020018815994262695, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.6274950504302979}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 497.22213273570634, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 792000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 8134.113, "sample_time_ms": 6032.825, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 20, "training_iteration": 198, "trial_id": "302a8_00000", "date": "2023-09-20_11-02-05", "timestamp": 1695200525, "time_this_iter_s": 8.04669451713562, "time_total_s": 1787.0369832515717, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A79A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1787.0369832515717, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 6.5, "ram_util_percent": 40.20909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 3.4753149285554885}, "policy_0": {"total_loss": 3.4753149285554885, "policy_loss": 0.00995271843969822, "vf_loss": 3.443379244262539, "vf_loss_unclipped": 34.0309577184027, "vf_explained_var": 0.06522344408035279, "entropy": -6.421150389122963, "mean_kl_loss": 0.02638401425164193, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2497889995574951}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -89825.53555183188, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -22456.383887957974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358, -68740.4586917108, -59676.884294866046], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992, -4697.328382021694, -3501.976146154554, -30611.99451492683, -29929.159648607572, -4702.188848806753, -3593.1724768269814, -26165.695105647705, -25215.827863584112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8614344663096521, "mean_inference_ms": 0.8213466661007461, "mean_action_processing_ms": 0.2568594047901709, "mean_env_wait_ms": 1.25563909694035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018198923631147904, "StateBufferConnector_ms": 0.00909025018865412, "ViewRequirementAgentConnector_ms": 0.60681321404197}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -89825.53555183188, "episode_len_mean": 36002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -22456.383887957974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358, -68740.4586917108, -59676.884294866046], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992, -4697.328382021694, -3501.976146154554, -30611.99451492683, -29929.159648607572, -4702.188848806753, -3593.1724768269814, -26165.695105647705, -25215.827863584112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8614344663096521, "mean_inference_ms": 0.8213466661007461, "mean_action_processing_ms": 0.2568594047901709, "mean_env_wait_ms": 1.25563909694035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018198923631147904, "StateBufferConnector_ms": 0.00909025018865412, "ViewRequirementAgentConnector_ms": 0.60681321404197}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 477.7251996698764, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 796000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 8146.573, "sample_time_ms": 6045.408, "synch_weights_time_ms": 2.001}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 199, "trial_id": "302a8_00000", "date": "2023-09-20_11-02-14", "timestamp": 1695200534, "time_this_iter_s": 8.375013828277588, "time_total_s": 1795.4119970798492, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A7F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1795.4119970798492, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 6.383333333333334, "ram_util_percent": 40.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 2.7970312529087065}, "policy_0": {"total_loss": 2.7970312529087065, "policy_loss": 0.0030141257762908934, "vf_loss": 2.7781771659865977, "vf_loss_unclipped": 10.612554562188684, "vf_explained_var": -0.05199732637405396, "entropy": -6.573737754821777, "mean_kl_loss": 0.012674109989334829, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 1.2497889995574951}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -89825.53555183188, "episode_len_mean": 36002.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -22456.383887957974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358, -68740.4586917108, -59676.884294866046], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992, -4697.328382021694, -3501.976146154554, -30611.99451492683, -29929.159648607572, -4702.188848806753, -3593.1724768269814, -26165.695105647705, -25215.827863584112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8614344663096521, "mean_inference_ms": 0.8213466661007461, "mean_action_processing_ms": 0.2568594047901709, "mean_env_wait_ms": 1.25563909694035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018198923631147904, "StateBufferConnector_ms": 0.00909025018865412, "ViewRequirementAgentConnector_ms": 0.60681321404197}}, "episode_reward_max": -40601.81613665397, "episode_reward_min": -163446.66979689064, "episode_reward_mean": -89825.53555183188, "episode_len_mean": 36002.0, "episodes_this_iter": 0, "policy_reward_min": {"policy_0": -58629.870721362444}, "policy_reward_max": {"policy_0": -2192.95854522083}, "policy_reward_mean": {"policy_0": -22456.383887957974}, "hist_stats": {"episode_reward": [-139999.85136127225, -163446.66979689064, -147210.82750140177, -118134.14083965652, -121033.7747665932, -75296.10598564536, -62187.609675298045, -66183.79235039026, -95151.0588637274, -123145.97187191097, -40601.81613665397, -50720.05950306124, -59816.83049923386, -107531.2610401612, -89882.67424698168, -65578.98860802219, -135997.18748852066, -68124.65920648244, -47703.9530637471, -69997.20634807358, -68740.4586917108, -59676.884294866046], "episode_lengths": [36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002, 36002], "policy_policy_0_reward": [-41971.119061338824, -32755.77672862149, -42629.70736037733, -22643.248210935355, -53964.01236045717, -37242.00181882802, -50217.82580363038, -22022.829813976216, -58629.870721362444, -23828.181162163586, -40358.71658630429, -24394.05903156944, -45641.31700184656, -10477.135401793774, -38031.694683581714, -23983.99375243466, -28843.649874471703, -55774.354648539345, -5703.749429053508, -30712.02081452962, -26847.9173504795, -33632.99421118725, -4983.4530281246825, -9831.741395853445, -13501.678384497069, -9273.88124739551, -17951.339563488575, -21460.710479916805, -17740.388033646486, -17629.447616620982, -15879.591081978273, -14934.36561814469, -25962.407168960413, -33953.955831017454, -14290.756303934431, -20943.93955981613, -29923.032887646914, -33455.88168352854, -28972.860022713252, -30794.197278023785, -6262.732539211218, -4552.026845568417, -15371.379074880257, -14415.67767699425, -6256.3535581179685, -4673.30766209225, -20334.831666079237, -19455.566616772223, -3886.8004572672253, -2962.22945608809, -26937.45551668745, -26030.34506919042, -37942.34346272185, -32231.87319079398, -16247.650830303803, -21109.393556342522, -14861.047362530935, -14495.141175564839, -30513.62882690717, -30012.85688197799, -3111.283903267533, -2192.95854522083, -30516.333377518156, -29758.41278201524, -36848.62068878186, -32121.727341786205, -36173.63423882821, -30853.205219124076, -3976.306657353453, -3137.1646400963937, -30876.482493695454, -30134.70541533738, -3950.9800159740535, -2892.0591509613796, -20528.146878900294, -20332.7670179109, -3907.507806682635, -2776.9925953180564, -32103.876573794827, -31208.829372276992, -4697.328382021694, -3501.976146154554, -30611.99451492683, -29929.159648607572, -4702.188848806753, -3593.1724768269814, -26165.695105647705, -25215.827863584112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8614344663096521, "mean_inference_ms": 0.8213466661007461, "mean_action_processing_ms": 0.2568594047901709, "mean_env_wait_ms": 1.25563909694035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018198923631147904, "StateBufferConnector_ms": 0.00909025018865412, "ViewRequirementAgentConnector_ms": 0.60681321404197}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 500.9198689605478, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 800000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 8146.404, "sample_time_ms": 6043.764, "synch_weights_time_ms": 2.101}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 22, "training_iteration": 200, "trial_id": "302a8_00000", "date": "2023-09-20_11-02-22", "timestamp": 1695200542, "time_this_iter_s": 7.986308574676514, "time_total_s": 1803.3983056545258, "pid": 7272, "hostname": "DESKTOP-GEN7OBM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x0000016B106A7520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 1. 2. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 1803.3983056545258, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 6.00909090909091, "ram_util_percent": 40.154545454545456}}
