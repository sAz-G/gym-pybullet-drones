{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.989193451690674}, "policy_0": {"total_loss": 9.989193451690674, "policy_loss": -0.0010722682402779658, "vf_loss": 9.98982129389445, "vf_loss_unclipped": 78979.31362708333, "vf_explained_var": -0.00012704030672709148, "entropy": 5.988571393076579, "mean_kl_loss": 0.002222101583889647, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -12168.837283225597, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -12302.417165566625, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -3241.5027056378344}, "policy_reward_max": {"policy_0": -2948.37725960182}, "policy_reward_mean": {"policy_0": -3075.604291391661}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651], "episode_lengths": [1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3476695842828708, "mean_inference_ms": 2.199845633347114, "mean_action_processing_ms": 0.7580942299769915, "mean_env_wait_ms": 4.459740876079142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02104043960571289, "StateBufferConnector_ms": 0.01188516616821289, "ViewRequirementAgentConnector_ms": 1.5955686569213867}}, "episode_reward_max": -12168.837283225597, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -12302.417165566625, "episode_len_mean": 1002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -3241.5027056378344}, "policy_reward_max": {"policy_0": -2948.37725960182}, "policy_reward_mean": {"policy_0": -3075.604291391661}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651], "episode_lengths": [1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3476695842828708, "mean_inference_ms": 2.199845633347114, "mean_action_processing_ms": 0.7580942299769915, "mean_env_wait_ms": 4.459740876079142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02104043960571289, "StateBufferConnector_ms": 0.01188516616821289, "ViewRequirementAgentConnector_ms": 1.5955686569213867}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 99.99706992151896, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 40001.126, "sample_time_ms": 21940.106, "synch_weights_time_ms": 2.845}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 1, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-20-42", "timestamp": 1695990042, "time_this_iter_s": 40.003824949264526, "time_total_s": 40.003824949264526, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9944a2200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 40.003824949264526, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 54.90877192982457, "ram_util_percent": 49.02105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.979466708755494}, "policy_0": {"total_loss": 9.979466708755494, "policy_loss": -0.0031719505573312443, "vf_loss": 9.981986459350585, "vf_loss_unclipped": 73309.36897291667, "vf_explained_var": -0.00022725008328755697, "entropy": 5.957772337595622, "mean_kl_loss": 0.006522148181652483, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -11889.437344457443, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -12166.379395547128, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3336.707230505426}, "policy_reward_max": {"policy_0": -2815.7722605757317}, "policy_reward_mean": {"policy_0": -3041.594848886782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.927185979137596, "mean_inference_ms": 2.0338284312583412, "mean_action_processing_ms": 0.6976259381880302, "mean_env_wait_ms": 4.105170796079089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01914501190185547, "StateBufferConnector_ms": 0.010263919830322266, "ViewRequirementAgentConnector_ms": 1.7453670501708984}}, "episode_reward_max": -11889.437344457443, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -12166.379395547128, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3336.707230505426}, "policy_reward_max": {"policy_0": -2815.7722605757317}, "policy_reward_mean": {"policy_0": -3041.594848886782}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.927185979137596, "mean_inference_ms": 2.0338284312583412, "mean_action_processing_ms": 0.6976259381880302, "mean_env_wait_ms": 4.105170796079089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01914501190185547, "StateBufferConnector_ms": 0.010263919830322266, "ViewRequirementAgentConnector_ms": 1.7453670501708984}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.39109314860505, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 36613.071, "sample_time_ms": 18870.708, "synch_weights_time_ms": 2.572}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 2, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-21-15", "timestamp": 1695990075, "time_this_iter_s": 33.22854018211365, "time_total_s": 73.23236513137817, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9945b2050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 73.23236513137817, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.84166666666666, "ram_util_percent": 49.166666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.97826809908549}, "policy_0": {"total_loss": 9.97826809908549, "policy_loss": -0.0034753982357680797, "vf_loss": 9.981112468465168, "vf_loss_unclipped": 70924.1086953125, "vf_explained_var": -0.0002893476168314616, "entropy": 5.912960896809896, "mean_kl_loss": 0.006310126914254079, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -11785.908682822928, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -12061.023172793011, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3336.707230505426}, "policy_reward_max": {"policy_0": -2662.296523187233}, "policy_reward_mean": {"policy_0": -3015.255793198255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.761174448308549, "mean_inference_ms": 1.9691787549198616, "mean_action_processing_ms": 0.6737113726066656, "mean_env_wait_ms": 3.9648531932594873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015897750854492188, "StateBufferConnector_ms": 0.009670257568359375, "ViewRequirementAgentConnector_ms": 1.4994096755981445}}, "episode_reward_max": -11785.908682822928, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -12061.023172793011, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3336.707230505426}, "policy_reward_max": {"policy_0": -2662.296523187233}, "policy_reward_mean": {"policy_0": -3015.255793198255}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.761174448308549, "mean_inference_ms": 1.9691787549198616, "mean_action_processing_ms": 0.6737113726066656, "mean_env_wait_ms": 3.9648531932594873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015897750854492188, "StateBufferConnector_ms": 0.009670257568359375, "ViewRequirementAgentConnector_ms": 1.4994096755981445}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.18673957810921, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 35502.549, "sample_time_ms": 17820.021, "synch_weights_time_ms": 2.599}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 3, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-21-48", "timestamp": 1695990108, "time_this_iter_s": 33.284456729888916, "time_total_s": 106.51682186126709, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9944a27a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 106.51682186126709, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.65106382978724, "ram_util_percent": 49.12127659574467}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.9765056447347}, "policy_0": {"total_loss": 9.9765056447347, "policy_loss": -0.004201592503984769, "vf_loss": 9.97992817433675, "vf_loss_unclipped": 63450.64658854167, "vf_explained_var": -0.00028069950739542643, "entropy": 5.823707590357462, "mean_kl_loss": 0.007790674876909907, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -11327.024375583555, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11932.493309445588, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2561.536085699627}, "policy_reward_mean": {"policy_0": -2983.123327361397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6623302144613645, "mean_inference_ms": 1.934149162870072, "mean_action_processing_ms": 0.6593689483982571, "mean_env_wait_ms": 3.881088112381196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01448052270071847, "StateBufferConnector_ms": 0.00938006809779576, "ViewRequirementAgentConnector_ms": 1.4134407043457031}}, "episode_reward_max": -11327.024375583555, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11932.493309445588, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2561.536085699627}, "policy_reward_mean": {"policy_0": -2983.123327361397}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.6623302144613645, "mean_inference_ms": 1.934149162870072, "mean_action_processing_ms": 0.6593689483982571, "mean_env_wait_ms": 3.881088112381196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01448052270071847, "StateBufferConnector_ms": 0.00938006809779576, "ViewRequirementAgentConnector_ms": 1.4134407043457031}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.61507044072677, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 34987.054, "sample_time_ms": 17369.562, "synch_weights_time_ms": 2.644}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 4, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-22-22", "timestamp": 1695990142, "time_this_iter_s": 33.44371318817139, "time_total_s": 139.96053504943848, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa994318550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 139.96053504943848, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.18333333333333, "ram_util_percent": 49.10208333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.977059560394288}, "policy_0": {"total_loss": 9.977059560394288, "policy_loss": -0.0038111111293236415, "vf_loss": 9.979987719217936, "vf_loss_unclipped": 57777.070141796874, "vf_explained_var": -0.00017388815879821777, "entropy": 5.761378984324137, "mean_kl_loss": 0.008829759826810793, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10862.489500442129, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11737.09010831442, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2378.5729170335208}, "policy_reward_mean": {"policy_0": -2934.272527078605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.594712101094738, "mean_inference_ms": 1.907648384521607, "mean_action_processing_ms": 0.6490670546897586, "mean_env_wait_ms": 3.820346253685164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01436471939086914, "StateBufferConnector_ms": 0.009233421749538846, "ViewRequirementAgentConnector_ms": 1.348147127363417}}, "episode_reward_max": -10862.489500442129, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11737.09010831442, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2378.5729170335208}, "policy_reward_mean": {"policy_0": -2934.272527078605}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.594712101094738, "mean_inference_ms": 1.907648384521607, "mean_action_processing_ms": 0.6490670546897586, "mean_env_wait_ms": 3.820346253685164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01436471939086914, "StateBufferConnector_ms": 0.009233421749538846, "ViewRequirementAgentConnector_ms": 1.348147127363417}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.7300637253243, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 34615.989, "sample_time_ms": 17028.045, "synch_weights_time_ms": 2.662}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 5, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-22-55", "timestamp": 1695990175, "time_this_iter_s": 33.13448977470398, "time_total_s": 173.09502482414246, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9943192d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 173.09502482414246, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.304255319148936, "ram_util_percent": 49.0851063829787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.976486173248292}, "policy_0": {"total_loss": 9.976486173248292, "policy_loss": -0.003541765478315453, "vf_loss": 9.979419007873535, "vf_loss_unclipped": 54780.07141979167, "vf_explained_var": -6.845254898071289e-05, "entropy": 5.770766060129802, "mean_kl_loss": 0.006089218675973734, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10851.267110527866, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11597.640307304855, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2378.5729170335208}, "policy_reward_mean": {"policy_0": -2899.410076826214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5440059929638767, "mean_inference_ms": 1.8870960053084145, "mean_action_processing_ms": 0.6412761020121274, "mean_env_wait_ms": 3.774361034516372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014537031000310724, "StateBufferConnector_ms": 0.009127096696333452, "ViewRequirementAgentConnector_ms": 1.3045744462446733}}, "episode_reward_max": -10851.267110527866, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11597.640307304855, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2378.5729170335208}, "policy_reward_mean": {"policy_0": -2899.410076826214}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5440059929638767, "mean_inference_ms": 1.8870960053084145, "mean_action_processing_ms": 0.6412761020121274, "mean_env_wait_ms": 3.774361034516372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014537031000310724, "StateBufferConnector_ms": 0.009127096696333452, "ViewRequirementAgentConnector_ms": 1.3045744462446733}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.70546308683876, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 34369.735, "sample_time_ms": 16797.734, "synch_weights_time_ms": 2.71}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 6, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-23-28", "timestamp": 1695990208, "time_this_iter_s": 33.141475200653076, "time_total_s": 206.23650002479553, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9944a2320>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 206.23650002479553, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 42.1468085106383, "ram_util_percent": 49.095744680851034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.975616657002767}, "policy_0": {"total_loss": 9.975616657002767, "policy_loss": -0.003927940257762869, "vf_loss": 9.978565001424153, "vf_loss_unclipped": 49166.811503320314, "vf_explained_var": -1.4258193969726562e-05, "entropy": 5.678719480260213, "mean_kl_loss": 0.00979604873325649, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10294.324292649262, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11430.903726446475, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2263.6975878289213}, "policy_reward_mean": {"policy_0": -2857.7259316116188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.50406871895864, "mean_inference_ms": 1.870850580733891, "mean_action_processing_ms": 0.6351857949235009, "mean_env_wait_ms": 3.7383522277281704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013962158790001502, "StateBufferConnector_ms": 0.009125929612379808, "ViewRequirementAgentConnector_ms": 1.2814787717965932}}, "episode_reward_max": -10294.324292649262, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11430.903726446475, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2263.6975878289213}, "policy_reward_mean": {"policy_0": -2857.7259316116188}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.50406871895864, "mean_inference_ms": 1.870850580733891, "mean_action_processing_ms": 0.6351857949235009, "mean_env_wait_ms": 3.7383522277281704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013962158790001502, "StateBufferConnector_ms": 0.009125929612379808, "ViewRequirementAgentConnector_ms": 1.2814787717965932}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.58158743814342, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 34238.332, "sample_time_ms": 16660.978, "synch_weights_time_ms": 2.693}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 7, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-24-01", "timestamp": 1695990241, "time_this_iter_s": 33.452723264694214, "time_total_s": 239.68922328948975, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa994318ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 239.68922328948975, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.862500000000004, "ram_util_percent": 49.14374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.975663865025838}, "policy_0": {"total_loss": 9.975663865025838, "policy_loss": -0.0036012507809946932, "vf_loss": 9.978338856760661, "vf_loss_unclipped": 47281.666145182295, "vf_explained_var": -2.127440770467122e-06, "entropy": 5.624784346262614, "mean_kl_loss": 0.009262657971225401, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10129.1845590296, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11284.114613739006, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2195.7703712002117}, "policy_reward_mean": {"policy_0": -2821.028653434751}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.471678375768211, "mean_inference_ms": 1.857543520931359, "mean_action_processing_ms": 0.6302452724649967, "mean_env_wait_ms": 3.7090380755730155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01356363296508789, "StateBufferConnector_ms": 0.009156068166097006, "ViewRequirementAgentConnector_ms": 1.2662180264790852}}, "episode_reward_max": -10129.1845590296, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11284.114613739006, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2195.7703712002117}, "policy_reward_mean": {"policy_0": -2821.028653434751}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.471678375768211, "mean_inference_ms": 1.857543520931359, "mean_action_processing_ms": 0.6302452724649967, "mean_env_wait_ms": 3.7090380755730155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01356363296508789, "StateBufferConnector_ms": 0.009156068166097006, "ViewRequirementAgentConnector_ms": 1.2662180264790852}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.8428378707517, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 34096.141, "sample_time_ms": 16529.439, "synch_weights_time_ms": 2.703}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 30, "training_iteration": 8, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-24-35", "timestamp": 1695990275, "time_this_iter_s": 33.10596442222595, "time_total_s": 272.7951877117157, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa994319ab0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 272.7951877117157, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.00212765957447, "ram_util_percent": 49.12978723404254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.972357870610555}, "policy_0": {"total_loss": 9.972357870610555, "policy_loss": -0.004629979781961689, "vf_loss": 9.976105075327556, "vf_loss_unclipped": 42804.40814464518, "vf_explained_var": -1.0938644409179688e-06, "entropy": 5.610026505788167, "mean_kl_loss": 0.008827569678713069, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9944.242891838807, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11150.712086800764, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2173.3700238928222}, "policy_reward_mean": {"policy_0": -2787.6780217001906}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4450402134834976, "mean_inference_ms": 1.8466737451502386, "mean_action_processing_ms": 0.6262601375876565, "mean_env_wait_ms": 3.6854202429628278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013774984023150276, "StateBufferConnector_ms": 0.00936283784754136, "ViewRequirementAgentConnector_ms": 1.303423853481517}}, "episode_reward_max": -9944.242891838807, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11150.712086800764, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2173.3700238928222}, "policy_reward_mean": {"policy_0": -2787.6780217001906}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4450402134834976, "mean_inference_ms": 1.8466737451502386, "mean_action_processing_ms": 0.6262601375876565, "mean_env_wait_ms": 3.6854202429628278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013774984023150276, "StateBufferConnector_ms": 0.00936283784754136, "ViewRequirementAgentConnector_ms": 1.303423853481517}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.54452078979426, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 34025.493, "sample_time_ms": 16463.724, "synch_weights_time_ms": 2.661}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 34, "training_iteration": 9, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-25-08", "timestamp": 1695990308, "time_this_iter_s": 33.46445846557617, "time_total_s": 306.25964617729187, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa99431ad40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 306.25964617729187, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.072916666666664, "ram_util_percent": 49.11041666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.972500152079265}, "policy_0": {"total_loss": 9.972500152079265, "policy_loss": -0.0037284318168181924, "vf_loss": 9.97553371149699, "vf_loss_unclipped": 37814.45451287435, "vf_explained_var": -9.936968485514323e-07, "entropy": 5.601515821329753, "mean_kl_loss": 0.006948689207548523, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9499.327175468425, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11000.04351083621, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2173.3700238928222}, "policy_reward_mean": {"policy_0": -2750.010877709053}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4226555965833754, "mean_inference_ms": 1.837506660882929, "mean_action_processing_ms": 0.6229235821570495, "mean_env_wait_ms": 3.665498065182775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014248647187885485, "StateBufferConnector_ms": 0.009490941700182463, "ViewRequirementAgentConnector_ms": 1.306668708198949}}, "episode_reward_max": -9499.327175468425, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -11000.04351083621, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2173.3700238928222}, "policy_reward_mean": {"policy_0": -2750.010877709053}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4226555965833754, "mean_inference_ms": 1.837506660882929, "mean_action_processing_ms": 0.6229235821570495, "mean_env_wait_ms": 3.665498065182775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014248647187885485, "StateBufferConnector_ms": 0.009490941700182463, "ViewRequirementAgentConnector_ms": 1.306668708198949}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.90047980942866, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 33959.04, "sample_time_ms": 16390.11, "synch_weights_time_ms": 2.667}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 38, "training_iteration": 10, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-25-41", "timestamp": 1695990341, "time_this_iter_s": 33.36386227607727, "time_total_s": 339.62350845336914, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9944a2200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 339.62350845336914, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 42.38510638297872, "ram_util_percent": 48.972340425531904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.972869299952189}, "policy_0": {"total_loss": 9.972869299952189, "policy_loss": -0.003125487750520309, "vf_loss": 9.975327577209473, "vf_loss_unclipped": 35470.87808260091, "vf_explained_var": -1.2344678243001302e-06, "entropy": 5.563414306386312, "mean_kl_loss": 0.006672223467803784, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9301.26016435299, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10848.581358811512, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2166.4945558581944}, "policy_reward_mean": {"policy_0": -2712.1453397028786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.403478109098541, "mean_inference_ms": 1.8296889331187915, "mean_action_processing_ms": 0.620093840241591, "mean_env_wait_ms": 3.648603418646489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014184202466692244, "StateBufferConnector_ms": 0.009469191233317057, "ViewRequirementAgentConnector_ms": 1.2964106741405668}}, "episode_reward_max": -9301.26016435299, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10848.581358811512, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2166.4945558581944}, "policy_reward_mean": {"policy_0": -2712.1453397028786}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.403478109098541, "mean_inference_ms": 1.8296889331187915, "mean_action_processing_ms": 0.620093840241591, "mean_env_wait_ms": 3.648603418646489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014184202466692244, "StateBufferConnector_ms": 0.009469191233317057, "ViewRequirementAgentConnector_ms": 1.2964106741405668}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.76470625019734, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 33298.805, "sample_time_ms": 15779.431, "synch_weights_time_ms": 2.638}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 42, "training_iteration": 11, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-26-15", "timestamp": 1695990375, "time_this_iter_s": 33.40202188491821, "time_total_s": 373.02553033828735, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa99431a3b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 373.02553033828735, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 42.22083333333333, "ram_util_percent": 48.779166666666676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.969642554601034}, "policy_0": {"total_loss": 9.969642554601034, "policy_loss": -0.004205902493993441, "vf_loss": 9.973076842244467, "vf_loss_unclipped": 32929.11386765951, "vf_explained_var": -9.886900583902995e-07, "entropy": 5.484690835825602, "mean_kl_loss": 0.007716271473865103, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9107.107190501043, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10706.675813577289, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2145.506568492886}, "policy_reward_mean": {"policy_0": -2676.668953394322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.386647975786071, "mean_inference_ms": 1.8229055282675224, "mean_action_processing_ms": 0.6176344359614014, "mean_env_wait_ms": 3.633915330411529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013919498609459919, "StateBufferConnector_ms": 0.009448631950046705, "ViewRequirementAgentConnector_ms": 1.2861961903779402}}, "episode_reward_max": -9107.107190501043, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10706.675813577289, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2145.506568492886}, "policy_reward_mean": {"policy_0": -2676.668953394322}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.386647975786071, "mean_inference_ms": 1.8229055282675224, "mean_action_processing_ms": 0.6176344359614014, "mean_env_wait_ms": 3.633915330411529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013919498609459919, "StateBufferConnector_ms": 0.009448631950046705, "ViewRequirementAgentConnector_ms": 1.2861961903779402}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.6718108643372, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 33318.774, "sample_time_ms": 15794.193, "synch_weights_time_ms": 2.702}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 46, "training_iteration": 12, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-26-48", "timestamp": 1695990408, "time_this_iter_s": 33.42783236503601, "time_total_s": 406.45336270332336, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9943193f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 406.45336270332336, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.07872340425532, "ram_util_percent": 48.85744680851065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.970635652033488}, "policy_0": {"total_loss": 9.970635652033488, "policy_loss": -0.0020752563521886863, "vf_loss": 9.972312778727213, "vf_loss_unclipped": 31611.847189241536, "vf_explained_var": -9.686787923177084e-07, "entropy": 5.53532616666158, "mean_kl_loss": 0.003981139419534156, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9014.013284563585, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10581.723242336891, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2119.5048405878156}, "policy_reward_mean": {"policy_0": -2645.4308105842233}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967, -9040.688738050914, -9263.430660854558, -9260.942008820224, -9014.013284563585], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372, -2137.7486188618423, -2203.310955190123, -2277.5461781668964, -2422.0829858320353, -2166.7365408484297, -2313.9416406683717, -2298.3195440465706, -2484.432935291174, -2153.950991774964, -2312.6330421577095, -2198.503897800743, -2595.854077086831, -2119.5048405878156, -2246.3847188446484, -2278.462470173433, -2369.6612549576553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3724334795290316, "mean_inference_ms": 1.817653394291711, "mean_action_processing_ms": 0.6157359544977217, "mean_env_wait_ms": 3.622631259742584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013660907745361328, "StateBufferConnector_ms": 0.00937509536743164, "ViewRequirementAgentConnector_ms": 1.2751235961914062}}, "episode_reward_max": -9014.013284563585, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10581.723242336891, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2119.5048405878156}, "policy_reward_mean": {"policy_0": -2645.4308105842233}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967, -9040.688738050914, -9263.430660854558, -9260.942008820224, -9014.013284563585], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372, -2137.7486188618423, -2203.310955190123, -2277.5461781668964, -2422.0829858320353, -2166.7365408484297, -2313.9416406683717, -2298.3195440465706, -2484.432935291174, -2153.950991774964, -2312.6330421577095, -2198.503897800743, -2595.854077086831, -2119.5048405878156, -2246.3847188446484, -2278.462470173433, -2369.6612549576553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3724334795290316, "mean_inference_ms": 1.817653394291711, "mean_action_processing_ms": 0.6157359544977217, "mean_env_wait_ms": 3.622631259742584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013660907745361328, "StateBufferConnector_ms": 0.00937509536743164, "ViewRequirementAgentConnector_ms": 1.2751235961914062}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 116.3585810564094, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 33428.27, "sample_time_ms": 15918.765, "synch_weights_time_ms": 2.675}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 50, "training_iteration": 13, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-27-23", "timestamp": 1695990443, "time_this_iter_s": 34.379831075668335, "time_total_s": 440.8331937789917, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa99431b640>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 440.8331937789917, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 44.328571428571415, "ram_util_percent": 48.82448979591838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.9684914604187}, "policy_0": {"total_loss": 9.9684914604187, "policy_loss": -0.0027267523288726806, "vf_loss": 9.970858501180013, "vf_loss_unclipped": 31332.644851383462, "vf_explained_var": -9.753068288167318e-07, "entropy": 5.495657205581665, "mean_kl_loss": 0.007194407669776653, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9014.013284563585, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10472.54477589896, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2110.7973078367963}, "policy_reward_mean": {"policy_0": -2618.1361939747403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967, -9040.688738050914, -9263.430660854558, -9260.942008820224, -9014.013284563585, -9100.023873349868, -9219.242620026265, -9045.381391188626, -9066.607897134549], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372, -2137.7486188618423, -2203.310955190123, -2277.5461781668964, -2422.0829858320353, -2166.7365408484297, -2313.9416406683717, -2298.3195440465706, -2484.432935291174, -2153.950991774964, -2312.6330421577095, -2198.503897800743, -2595.854077086831, -2119.5048405878156, -2246.3847188446484, -2278.462470173433, -2369.6612549576553, -2161.449394141803, -2353.486556540818, -2309.750681612243, -2275.337241055003, -2153.1062045056833, -2328.1273335178894, -2289.4579905020487, -2448.5510915006653, -2110.7973078367963, -2315.780003708389, -2259.7149766705006, -2359.0891029729155, -2151.9594499321283, -2189.6905763389623, -2274.487244012846, -2450.4706268506225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3601528700583083, "mean_inference_ms": 1.8131215724471215, "mean_action_processing_ms": 0.6141005659417272, "mean_env_wait_ms": 3.612900634104373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014105549565067998, "StateBufferConnector_ms": 0.009480670646384911, "ViewRequirementAgentConnector_ms": 1.2984637860898618}}, "episode_reward_max": -9014.013284563585, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10472.54477589896, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2110.7973078367963}, "policy_reward_mean": {"policy_0": -2618.1361939747403}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967, -9040.688738050914, -9263.430660854558, -9260.942008820224, -9014.013284563585, -9100.023873349868, -9219.242620026265, -9045.381391188626, -9066.607897134549], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372, -2137.7486188618423, -2203.310955190123, -2277.5461781668964, -2422.0829858320353, -2166.7365408484297, -2313.9416406683717, -2298.3195440465706, -2484.432935291174, -2153.950991774964, -2312.6330421577095, -2198.503897800743, -2595.854077086831, -2119.5048405878156, -2246.3847188446484, -2278.462470173433, -2369.6612549576553, -2161.449394141803, -2353.486556540818, -2309.750681612243, -2275.337241055003, -2153.1062045056833, -2328.1273335178894, -2289.4579905020487, -2448.5510915006653, -2110.7973078367963, -2315.780003708389, -2259.7149766705006, -2359.0891029729155, -2151.9594499321283, -2189.6905763389623, -2274.487244012846, -2450.4706268506225]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3601528700583083, "mean_inference_ms": 1.8131215724471215, "mean_action_processing_ms": 0.6141005659417272, "mean_env_wait_ms": 3.612900634104373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014105549565067998, "StateBufferConnector_ms": 0.009480670646384911, "ViewRequirementAgentConnector_ms": 1.2984637860898618}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 118.17769952618093, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 33468.943, "sample_time_ms": 15942.939, "synch_weights_time_ms": 2.648}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 54, "training_iteration": 14, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-27-57", "timestamp": 1695990477, "time_this_iter_s": 33.85170769691467, "time_total_s": 474.6849014759064, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa9943193f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 474.6849014759064, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.05833333333333, "ram_util_percent": 48.833333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.969526170094808}, "policy_0": {"total_loss": 9.969526170094808, "policy_loss": -0.003318189193618794, "vf_loss": 9.972488320668539, "vf_loss_unclipped": 28514.119023600262, "vf_explained_var": -9.55041249593099e-07, "entropy": 5.501309505844116, "mean_kl_loss": 0.007120658860646654, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8812.810630285536, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10373.600145765118, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2110.7973078367963}, "policy_reward_mean": {"policy_0": -2593.40003644128}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967, -9040.688738050914, -9263.430660854558, -9260.942008820224, -9014.013284563585, -9100.023873349868, -9219.242620026265, -9045.381391188626, -9066.607897134549, -9002.147134057099, -9073.989919447797, -9262.4428720427, -8812.810630285536], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372, -2137.7486188618423, -2203.310955190123, -2277.5461781668964, -2422.0829858320353, -2166.7365408484297, -2313.9416406683717, -2298.3195440465706, -2484.432935291174, -2153.950991774964, -2312.6330421577095, -2198.503897800743, -2595.854077086831, -2119.5048405878156, -2246.3847188446484, -2278.462470173433, -2369.6612549576553, -2161.449394141803, -2353.486556540818, -2309.750681612243, -2275.337241055003, -2153.1062045056833, -2328.1273335178894, -2289.4579905020487, -2448.5510915006653, -2110.7973078367963, -2315.780003708389, -2259.7149766705006, -2359.0891029729155, -2151.9594499321283, -2189.6905763389623, -2274.487244012846, -2450.4706268506225, -2174.929781788896, -2214.1308505041475, -2244.4361962390603, -2368.6503055249873, -2146.162656025364, -2249.051787662792, -2220.7587423399136, -2458.01673341971, -2164.377170008255, -2272.7386327509653, -2426.2272778955235, -2399.0997913879705, -2145.498528570919, -2222.297818138277, -2164.630131093682, -2280.384152482669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.349046540959581, "mean_inference_ms": 1.809053592276547, "mean_action_processing_ms": 0.6126335557020223, "mean_env_wait_ms": 3.604191618104328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014160419332570043, "StateBufferConnector_ms": 0.009493992246430496, "ViewRequirementAgentConnector_ms": 1.291192811110924}}, "episode_reward_max": -8812.810630285536, "episode_reward_min": -12435.997047907651, "episode_reward_mean": -10373.600145765118, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3352.86159071774}, "policy_reward_max": {"policy_0": -2110.7973078367963}, "policy_reward_mean": {"policy_0": -2593.40003644128}, "hist_stats": {"episode_reward": [-12168.837283225597, -12435.997047907651, -12347.652934954092, -11889.437344457443, -12161.89253298236, -11994.459229755625, -12061.282024920256, -11785.908682822928, -11896.640002498789, -11868.124644405392, -11609.862373937864, -11505.777948611967, -12002.009906174744, -11327.024375583555, -11229.14491983487, -10862.489500442129, -11164.457362888297, -10956.62383425602, -11151.797009838669, -10851.267110527866, -11001.448301417435, -10875.952389263273, -10871.794144644859, -10382.694309718094, -10506.597379889294, -10294.324292649262, -10346.53351250576, -10362.912949057705, -10481.310503968725, -10129.1845590296, -10349.52005217693, -10046.304200659175, -10260.705394380962, -9944.242891838807, -9955.554732352724, -9687.735245833219, -9734.825306895624, -9499.327175468425, -9301.26016435299, -9315.551410591632, -9546.940943909987, -9475.01113945297, -9383.702692063473, -9107.107190501043, -9191.4061465812, -9184.454325325967, -9040.688738050914, -9263.430660854558, -9260.942008820224, -9014.013284563585, -9100.023873349868, -9219.242620026265, -9045.381391188626, -9066.607897134549, -9002.147134057099, -9073.989919447797, -9262.4428720427, -8812.810630285536], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-2986.0053101209755, -2992.952007864997, -3241.5027056378344, -2948.37725960182, -2981.071908948503, -3141.9584554285802, -3224.7176514837884, -3088.249032046786, -2815.7722605757317, -3234.4402824060735, -3274.935839266514, -3022.5045527057573, -2837.610349763134, -2956.5986926638175, -3034.1090417158375, -3061.1192603146405, -2866.0646488125767, -3023.709666277846, -3243.3639522246453, -3028.754265667294, -2820.0896282749645, -2973.8843808245047, -3336.707230505426, -2863.777990150738, -2750.08776099742, -3128.4525714002443, -3232.41774602149, -2950.323946501106, -2747.25905768506, -2891.807008806811, -3199.6569734498757, -2947.1856428811866, -2780.4265565650157, -3002.58684829578, -3113.1028020438107, -3000.5237955941902, -2662.296523187233, -3031.254051012126, -3276.68706546825, -2897.8870047378205, -2592.3635905671194, -2878.481153817683, -3295.5545483754913, -2843.46308117756, -2750.1129977546398, -2695.8723848088594, -2964.9863929985045, -3094.8061730499894, -2734.229121336076, -3003.4657442846205, -3352.86159071774, -2911.453449836253, -2561.536085699627, -2790.09028857375, -2882.071777640295, -3093.32622366984, -2416.262206640943, -2661.172201345262, -3335.9156781880956, -2815.794833660595, -2417.531681713457, -2680.1820866020503, -2916.9446766763836, -2847.831055450226, -2575.6563971412374, -2705.6967695476105, -3084.750955550527, -2798.3532406489044, -2378.5729170335208, -2678.9144698715468, -3034.0728675725945, -2865.063579778361, -2577.4908736783627, -2765.2187952778695, -2893.884389730722, -2915.202951151758, -2561.9616388281124, -2717.4602162679776, -2811.422112171216, -2760.423143260557, -2497.2776901677516, -2711.2856287492355, -2861.122205793084, -2931.7627767073573, -2486.350595234667, -2714.098758725753, -2959.2555608023386, -2716.2474745005084, -2407.9199888279572, -2729.2511595050937, -2778.6060635784524, -2956.0169327333742, -2319.9465829442584, -2424.2571808686507, -2836.557285347169, -2801.933260557996, -2293.409007595715, -2609.9876635361684, -2727.9119959132245, -2875.288712844206, -2263.6975878289213, -2605.3206967190017, -2758.1197584434785, -2667.1862496578797, -2380.147919379777, -2666.98424293131, -2598.0787824145796, -2701.322567780091, -2283.219150318996, -2466.132068722567, -2786.2290502322494, -2827.3326797838854, -2312.952818472916, -2647.0153732568892, -2596.5501170076395, -2924.792195231284, -2195.7703712002117, -2498.4114725434706, -2530.9395047253834, -2904.0632105604964, -2199.0781404768354, -2508.6174156177176, -2780.6370890510952, -2861.187407031239, -2173.3700238928222, -2405.819918570177, -2627.999994449458, -2839.1142637467115, -2188.473589718972, -2613.3506501763563, -2694.6859702557713, -2764.1951842298818, -2173.9947297781255, -2405.560511943985, -2550.7511636246904, -2813.9364864920003, -2210.0911112422546, -2392.577480173275, -2585.8698795452046, -2767.0162613920043, -2222.6270053052367, -2342.4277517746473, -2475.9007960842428, -2646.7796926691153, -2185.811787879646, -2379.6407801744886, -2401.709040180592, -2767.6636986608933, -2187.589631939269, -2231.66186844344, -2431.8922058685835, -2648.183469217166, -2195.6879987882958, -2263.2960955638687, -2385.368708594799, -2456.907361406034, -2166.4945558581944, -2239.252488538288, -2315.895935243843, -2593.9084309513005, -2215.5336423806707, -2237.3804056403387, -2433.2551883489964, -2660.771707540024, -2247.6859513619193, -2248.69902070185, -2432.2891360218964, -2546.337031367291, -2156.9667384005097, -2249.8489126875643, -2477.921857650096, -2498.9651833252906, -2145.506568492886, -2313.526960696011, -2247.7818953992482, -2400.291765912917, -2150.729321217471, -2193.6477197079953, -2335.8784831581947, -2511.1506224975465, -2158.63854202554, -2230.4028883149285, -2414.8364967831258, -2380.576398202372, -2137.7486188618423, -2203.310955190123, -2277.5461781668964, -2422.0829858320353, -2166.7365408484297, -2313.9416406683717, -2298.3195440465706, -2484.432935291174, -2153.950991774964, -2312.6330421577095, -2198.503897800743, -2595.854077086831, -2119.5048405878156, -2246.3847188446484, -2278.462470173433, -2369.6612549576553, -2161.449394141803, -2353.486556540818, -2309.750681612243, -2275.337241055003, -2153.1062045056833, -2328.1273335178894, -2289.4579905020487, -2448.5510915006653, -2110.7973078367963, -2315.780003708389, -2259.7149766705006, -2359.0891029729155, -2151.9594499321283, -2189.6905763389623, -2274.487244012846, -2450.4706268506225, -2174.929781788896, -2214.1308505041475, -2244.4361962390603, -2368.6503055249873, -2146.162656025364, -2249.051787662792, -2220.7587423399136, -2458.01673341971, -2164.377170008255, -2272.7386327509653, -2426.2272778955235, -2399.0997913879705, -2145.498528570919, -2222.297818138277, -2164.630131093682, -2280.384152482669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.349046540959581, "mean_inference_ms": 1.809053592276547, "mean_action_processing_ms": 0.6126335557020223, "mean_env_wait_ms": 3.604191618104328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014160419332570043, "StateBufferConnector_ms": 0.009493992246430496, "ViewRequirementAgentConnector_ms": 1.291192811110924}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.45520441582546, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 33504.301, "sample_time_ms": 15972.307, "synch_weights_time_ms": 2.638}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 58, "training_iteration": 15, "trial_id": "7e8c4_00000", "date": "2023-09-29_14-28-30", "timestamp": 1695990510, "time_this_iter_s": 33.488632917404175, "time_total_s": 508.17353439331055, "pid": 76616, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fa994319090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 508.17353439331055, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.09166666666667, "ram_util_percent": 48.79999999999999}}
