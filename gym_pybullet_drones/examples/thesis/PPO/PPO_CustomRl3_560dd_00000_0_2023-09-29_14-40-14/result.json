{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.987737886555989}, "policy_0": {"total_loss": 9.987737886555989, "policy_loss": -0.0024681070305407047, "vf_loss": 9.989461241149902, "vf_loss_unclipped": 76782.05374869792, "vf_explained_var": -0.00014053163528442384, "entropy": 5.666145936584472, "mean_kl_loss": 0.0037237721779027197, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -12044.992440399701, "episode_reward_min": -12288.02433036426, "episode_reward_mean": -12166.508385381981, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -3154.8412152762576}, "policy_reward_max": {"policy_0": -2924.15504614704}, "policy_reward_mean": {"policy_0": -3041.627096345497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426], "episode_lengths": [1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9573426020258609, "mean_inference_ms": 1.6686013792229557, "mean_action_processing_ms": 0.5740595721769548, "mean_env_wait_ms": 3.4010103498322555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015461444854736328, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 1.070404052734375}}, "episode_reward_max": -12044.992440399701, "episode_reward_min": -12288.02433036426, "episode_reward_mean": -12166.508385381981, "episode_len_mean": 1002.0, "episodes_this_iter": 2, "policy_reward_min": {"policy_0": -3154.8412152762576}, "policy_reward_max": {"policy_0": -2924.15504614704}, "policy_reward_mean": {"policy_0": -3041.627096345497}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426], "episode_lengths": [1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9573426020258609, "mean_inference_ms": 1.6686013792229557, "mean_action_processing_ms": 0.5740595721769548, "mean_env_wait_ms": 3.4010103498322555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015461444854736328, "StateBufferConnector_ms": 0.00807046890258789, "ViewRequirementAgentConnector_ms": 1.070404052734375}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.56606436175902, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 4000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 33176.789, "sample_time_ms": 15396.503, "synch_weights_time_ms": 2.306}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 2, "training_iteration": 1, "trial_id": "560dd_00000", "date": "2023-09-29_14-40-54", "timestamp": 1695991254, "time_this_iter_s": 33.180675745010376, "time_total_s": 33.180675745010376, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c576830>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 33.180675745010376, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 42.385416666666664, "ram_util_percent": 48.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.979661820602416}, "policy_0": {"total_loss": 9.979661820602416, "policy_loss": -0.00407004930836459, "vf_loss": 9.983087407938639, "vf_loss_unclipped": 69763.36213828126, "vf_explained_var": -0.0003525974750518799, "entropy": 5.650223354975383, "mean_kl_loss": 0.0064446976905397, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -11500.46278175345, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11950.683053143706, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2782.7303140980675}, "policy_reward_mean": {"policy_0": -2987.6707632859266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9786530155603417, "mean_inference_ms": 1.6706432068766197, "mean_action_processing_ms": 0.5743574923248632, "mean_env_wait_ms": 3.3719103868209603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016840298970540363, "StateBufferConnector_ms": 0.00905593236287435, "ViewRequirementAgentConnector_ms": 1.2334267298380535}}, "episode_reward_max": -11500.46278175345, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11950.683053143706, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2782.7303140980675}, "policy_reward_mean": {"policy_0": -2987.6707632859266}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9786530155603417, "mean_inference_ms": 1.6706432068766197, "mean_action_processing_ms": 0.5743574923248632, "mean_env_wait_ms": 3.3719103868209603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016840298970540363, "StateBufferConnector_ms": 0.00905593236287435, "ViewRequirementAgentConnector_ms": 1.2334267298380535}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 121.00460149828987, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 8000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 33116.672, "sample_time_ms": 15417.79, "synch_weights_time_ms": 2.513}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 6, "training_iteration": 2, "trial_id": "560dd_00000", "date": "2023-09-29_14-41-27", "timestamp": 1695991287, "time_this_iter_s": 33.059470653533936, "time_total_s": 66.24014639854431, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c4f2050>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 66.24014639854431, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.01702127659574, "ram_util_percent": 48.73617021276598}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.975294464365641}, "policy_0": {"total_loss": 9.975294464365641, "policy_loss": -0.0033337257931629815, "vf_loss": 9.978085793558757, "vf_loss_unclipped": 61599.110891927085, "vf_explained_var": -7.62342611948649e-05, "entropy": 5.664576203791301, "mean_kl_loss": 0.005423999749685511, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -11013.351185902085, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11743.72796186002, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2599.2741033077464}, "policy_reward_mean": {"policy_0": -2935.9319904650074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9943522394409126, "mean_inference_ms": 1.6710758073321845, "mean_action_processing_ms": 0.574097451276681, "mean_env_wait_ms": 3.3616772650495874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014684200286865234, "StateBufferConnector_ms": 0.008869171142578125, "ViewRequirementAgentConnector_ms": 1.1886405944824219}}, "episode_reward_max": -11013.351185902085, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11743.72796186002, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2599.2741033077464}, "policy_reward_mean": {"policy_0": -2935.9319904650074}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9943522394409126, "mean_inference_ms": 1.6710758073321845, "mean_action_processing_ms": 0.574097451276681, "mean_env_wait_ms": 3.3616772650495874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014684200286865234, "StateBufferConnector_ms": 0.008869171142578125, "ViewRequirementAgentConnector_ms": 1.1886405944824219}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.68612802358037, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 12000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 33125.711, "sample_time_ms": 15433.408, "synch_weights_time_ms": 2.517}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 10, "training_iteration": 3, "trial_id": "560dd_00000", "date": "2023-09-29_14-42-00", "timestamp": 1695991320, "time_this_iter_s": 33.146753787994385, "time_total_s": 99.3869001865387, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c4f2ef0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 99.3869001865387, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.16170212765958, "ram_util_percent": 48.79787234042555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.97663630396525}, "policy_0": {"total_loss": 9.97663630396525, "policy_loss": -0.003895262306323275, "vf_loss": 9.979787244669597, "vf_loss_unclipped": 58694.16079609375, "vf_explained_var": -0.0001338774045308431, "entropy": 5.597168435923258, "mean_kl_loss": 0.007443117638020431, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.10000000149011612}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10944.367793496738, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11531.280077302215, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2429.929977961521}, "policy_reward_mean": {"policy_0": -2882.8200193255548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0079026491766494, "mean_inference_ms": 1.6764167160230687, "mean_action_processing_ms": 0.574704301167899, "mean_env_wait_ms": 3.359544416871064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013661384582519531, "StateBufferConnector_ms": 0.008903230939592634, "ViewRequirementAgentConnector_ms": 1.1709553854806083}}, "episode_reward_max": -10944.367793496738, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11531.280077302215, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2429.929977961521}, "policy_reward_mean": {"policy_0": -2882.8200193255548}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0079026491766494, "mean_inference_ms": 1.6764167160230687, "mean_action_processing_ms": 0.574704301167899, "mean_env_wait_ms": 3.359544416871064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013661384582519531, "StateBufferConnector_ms": 0.008903230939592634, "ViewRequirementAgentConnector_ms": 1.1709553854806083}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 119.98800836244932, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 16000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 33178.44, "sample_time_ms": 15519.55, "synch_weights_time_ms": 2.559}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 14, "training_iteration": 4, "trial_id": "560dd_00000", "date": "2023-09-29_14-42-33", "timestamp": 1695991353, "time_this_iter_s": 33.34053683280945, "time_total_s": 132.72743701934814, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3a8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 132.72743701934814, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.59166666666667, "ram_util_percent": 48.897916666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.977817116928101}, "policy_0": {"total_loss": 9.977817116928101, "policy_loss": -0.0021651827057202655, "vf_loss": 9.979494963582356, "vf_loss_unclipped": 49639.76964114583, "vf_explained_var": -4.610335032145182e-05, "entropy": 5.570857099660238, "mean_kl_loss": 0.004873328346899386, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10001.770049609506, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11308.832477262466, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2354.189073412113}, "policy_reward_mean": {"policy_0": -2827.2081193156173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0169454019677406, "mean_inference_ms": 1.679301184945738, "mean_action_processing_ms": 0.5752214933817914, "mean_env_wait_ms": 3.3587390092005935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013600455390082465, "StateBufferConnector_ms": 0.008919503953721788, "ViewRequirementAgentConnector_ms": 1.1632800102233887}}, "episode_reward_max": -10001.770049609506, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11308.832477262466, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2354.189073412113}, "policy_reward_mean": {"policy_0": -2827.2081193156173}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0169454019677406, "mean_inference_ms": 1.679301184945738, "mean_action_processing_ms": 0.5752214933817914, "mean_env_wait_ms": 3.3587390092005935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013600455390082465, "StateBufferConnector_ms": 0.008919503953721788, "ViewRequirementAgentConnector_ms": 1.1632800102233887}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.67764071711447, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 20000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 33171.977, "sample_time_ms": 15534.464, "synch_weights_time_ms": 2.562}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 18, "training_iteration": 5, "trial_id": "560dd_00000", "date": "2023-09-29_14-43-06", "timestamp": 1695991386, "time_this_iter_s": 33.1498441696167, "time_total_s": 165.87728118896484, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c4f31c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 165.87728118896484, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.831914893617025, "ram_util_percent": 48.86808510638299}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.973797416941325}, "policy_0": {"total_loss": 9.973797416941325, "policy_loss": -0.004259687592290963, "vf_loss": 9.977537618255615, "vf_loss_unclipped": 45878.8858546875, "vf_explained_var": -7.335238456726074e-05, "entropy": 5.54628927637736, "mean_kl_loss": 0.01038992299066055, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -10001.770049609506, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11115.513470148073, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2281.349468853101}, "policy_reward_mean": {"policy_0": -2778.878367537018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0233830009183693, "mean_inference_ms": 1.6811581587517848, "mean_action_processing_ms": 0.5756342613167881, "mean_env_wait_ms": 3.3585092556654916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013953989202325994, "StateBufferConnector_ms": 0.00887784090909091, "ViewRequirementAgentConnector_ms": 1.16006461056796}}, "episode_reward_max": -10001.770049609506, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -11115.513470148073, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2281.349468853101}, "policy_reward_mean": {"policy_0": -2778.878367537018}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0233830009183693, "mean_inference_ms": 1.6811581587517848, "mean_action_processing_ms": 0.5756342613167881, "mean_env_wait_ms": 3.3585092556654916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013953989202325994, "StateBufferConnector_ms": 0.00887784090909091, "ViewRequirementAgentConnector_ms": 1.16006461056796}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.62635165454128, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 24000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 33170.015, "sample_time_ms": 15546.161, "synch_weights_time_ms": 2.661}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 22, "training_iteration": 6, "trial_id": "560dd_00000", "date": "2023-09-29_14-43-40", "timestamp": 1695991420, "time_this_iter_s": 33.1637806892395, "time_total_s": 199.04106187820435, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c4f1ea0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 199.04106187820435, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 42.15744680851064, "ram_util_percent": 48.88723404255321}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.975563388824463}, "policy_0": {"total_loss": 9.975563388824463, "policy_loss": -0.0030668285205960274, "vf_loss": 9.978269134521485, "vf_loss_unclipped": 41256.772867578125, "vf_explained_var": -4.231913884480795e-06, "entropy": 5.532572767384847, "mean_kl_loss": 0.007221737743095976, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9451.511094618758, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10901.624381661763, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2250.061294794585}, "policy_reward_mean": {"policy_0": -2725.406095415441}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.031989218338109, "mean_inference_ms": 1.6841352524818671, "mean_action_processing_ms": 0.5765253052614947, "mean_env_wait_ms": 3.3612986890397205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013474317697378306, "StateBufferConnector_ms": 0.008869171142578125, "ViewRequirementAgentConnector_ms": 1.1529161379887507}}, "episode_reward_max": -9451.511094618758, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10901.624381661763, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2250.061294794585}, "policy_reward_mean": {"policy_0": -2725.406095415441}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.031989218338109, "mean_inference_ms": 1.6841352524818671, "mean_action_processing_ms": 0.5765253052614947, "mean_env_wait_ms": 3.3612986890397205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013474317697378306, "StateBufferConnector_ms": 0.008869171142578125, "ViewRequirementAgentConnector_ms": 1.1529161379887507}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 117.41245018957979, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 28000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 33298.283, "sample_time_ms": 15652.797, "synch_weights_time_ms": 2.699}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 26, "training_iteration": 7, "trial_id": "560dd_00000", "date": "2023-09-29_14-44-14", "timestamp": 1695991454, "time_this_iter_s": 34.07083463668823, "time_total_s": 233.11189651489258, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3a8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 233.11189651489258, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 44.356249999999996, "ram_util_percent": 48.94583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.973686556752522}, "policy_0": {"total_loss": 9.973686556752522, "policy_loss": -0.003934018780787786, "vf_loss": 9.97715624516805, "vf_loss_unclipped": 38104.401303776045, "vf_explained_var": -1.2540992101033528e-05, "entropy": 5.48373149579366, "mean_kl_loss": 0.009286405085804411, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9261.094581113803, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10713.360765671787, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2678.3401914179462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.03912977529757, "mean_inference_ms": 1.6861673698953008, "mean_action_processing_ms": 0.5771765497585424, "mean_env_wait_ms": 3.3632407772711748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013225873311360678, "StateBufferConnector_ms": 0.008933544158935547, "ViewRequirementAgentConnector_ms": 1.1639213562011719}}, "episode_reward_max": -9261.094581113803, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10713.360765671787, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2678.3401914179462}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.03912977529757, "mean_inference_ms": 1.6861673698953008, "mean_action_processing_ms": 0.5771765497585424, "mean_env_wait_ms": 3.3632407772711748, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013225873311360678, "StateBufferConnector_ms": 0.008933544158935547, "ViewRequirementAgentConnector_ms": 1.1639213562011719}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.10996338300501, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 32000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 33298.844, "sample_time_ms": 15661.947, "synch_weights_time_ms": 2.736}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 30, "training_iteration": 8, "trial_id": "560dd_00000", "date": "2023-09-29_14-44-47", "timestamp": 1695991487, "time_this_iter_s": 33.30571269989014, "time_total_s": 266.4176092147827, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3a9fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 266.4176092147827, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.22291666666667, "ram_util_percent": 48.93958333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.972368173980714}, "policy_0": {"total_loss": 9.972368173980714, "policy_loss": -0.0036871049497276547, "vf_loss": 9.975690526072185, "vf_loss_unclipped": 37487.53840004883, "vf_explained_var": -4.550329844156901e-06, "entropy": 5.451362058766683, "mean_kl_loss": 0.007295366419207615, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9195.329859164465, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10545.811301765874, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2636.4528254414677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.045691411010315, "mean_inference_ms": 1.6876645817372733, "mean_action_processing_ms": 0.577680304502078, "mean_env_wait_ms": 3.3648315581099872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01359406639547909, "StateBufferConnector_ms": 0.009261159335865694, "ViewRequirementAgentConnector_ms": 1.224362850189209}}, "episode_reward_max": -9195.329859164465, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10545.811301765874, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2636.4528254414677}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.045691411010315, "mean_inference_ms": 1.6876645817372733, "mean_action_processing_ms": 0.577680304502078, "mean_env_wait_ms": 3.3648315581099872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01359406639547909, "StateBufferConnector_ms": 0.009261159335865694, "ViewRequirementAgentConnector_ms": 1.224362850189209}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 117.08474940351368, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 36000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 33394.89, "sample_time_ms": 15682.606, "synch_weights_time_ms": 2.688}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 34, "training_iteration": 9, "trial_id": "560dd_00000", "date": "2023-09-29_14-45-21", "timestamp": 1695991521, "time_this_iter_s": 34.16701650619507, "time_total_s": 300.5846257209778, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c4f23b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 300.5846257209778, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 42.88163265306122, "ram_util_percent": 48.9530612244898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.971591714477539}, "policy_0": {"total_loss": 9.971591714477539, "policy_loss": -0.003624832151302447, "vf_loss": 9.97479405263265, "vf_loss_unclipped": 36036.875237402346, "vf_explained_var": -1.8507957458496095e-06, "entropy": 5.400239198557536, "mean_kl_loss": 0.008449852593126283, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9191.140231673075, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10417.100794810669, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2604.2751987026663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.052308348787239, "mean_inference_ms": 1.6899179842917462, "mean_action_processing_ms": 0.5784921912204203, "mean_env_wait_ms": 3.3683664670970943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013834551761024877, "StateBufferConnector_ms": 0.009183507216604133, "ViewRequirementAgentConnector_ms": 1.2121401335063733}}, "episode_reward_max": -9191.140231673075, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10417.100794810669, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2604.2751987026663}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.052308348787239, "mean_inference_ms": 1.6899179842917462, "mean_action_processing_ms": 0.5784921912204203, "mean_env_wait_ms": 3.3683664670970943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013834551761024877, "StateBufferConnector_ms": 0.009183507216604133, "ViewRequirementAgentConnector_ms": 1.2121401335063733}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 112.34893951419771, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 40000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 33615.733, "sample_time_ms": 15786.293, "synch_weights_time_ms": 2.705}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 38, "training_iteration": 10, "trial_id": "560dd_00000", "date": "2023-09-29_14-45-57", "timestamp": 1695991557, "time_this_iter_s": 35.60637307167053, "time_total_s": 336.1909987926483, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3a91b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 336.1909987926483, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.13, "ram_util_percent": 48.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.971744138209026}, "policy_0": {"total_loss": 9.971744138209026, "policy_loss": -0.002533752177034815, "vf_loss": 9.973930152130126, "vf_loss_unclipped": 34274.84751961263, "vf_explained_var": -1.0034720102945963e-06, "entropy": 5.371279844411214, "mean_kl_loss": 0.0069547316378136504, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -9071.247048453239, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10301.2632712098, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2575.3158178024496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0597668807527327, "mean_inference_ms": 1.6940685957175394, "mean_action_processing_ms": 0.5801822324062386, "mean_env_wait_ms": 3.375137085695446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01382998057774135, "StateBufferConnector_ms": 0.00913199924287342, "ViewRequirementAgentConnector_ms": 1.2046036266145252}}, "episode_reward_max": -9071.247048453239, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10301.2632712098, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2184.703619979935}, "policy_reward_mean": {"policy_0": -2575.3158178024496}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0597668807527327, "mean_inference_ms": 1.6940685957175394, "mean_action_processing_ms": 0.5801822324062386, "mean_env_wait_ms": 3.375137085695446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01382998057774135, "StateBufferConnector_ms": 0.00913199924287342, "ViewRequirementAgentConnector_ms": 1.2046036266145252}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 111.06163260033799, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 44000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 33899.654, "sample_time_ms": 16038.89, "synch_weights_time_ms": 2.729}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 42, "training_iteration": 11, "trial_id": "560dd_00000", "date": "2023-09-29_14-46-33", "timestamp": 1695991593, "time_this_iter_s": 36.02204704284668, "time_total_s": 372.213045835495, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3aa710>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 372.213045835495, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.10980392156863, "ram_util_percent": 48.97058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.969981906382243}, "policy_0": {"total_loss": 9.969981906382243, "policy_loss": -0.0025428844864169757, "vf_loss": 9.972170191701252, "vf_loss_unclipped": 30592.011169726564, "vf_explained_var": -8.54333241780599e-07, "entropy": 5.354896448644002, "mean_kl_loss": 0.007092162913181953, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8793.193067534752, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10185.227635424792, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2152.6618360991047}, "policy_reward_mean": {"policy_0": -2546.3069088561974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.066601448072746, "mean_inference_ms": 1.6979398947944264, "mean_action_processing_ms": 0.5817389883803518, "mean_env_wait_ms": 3.3817689047299617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01376348993052607, "StateBufferConnector_ms": 0.00914801721987517, "ViewRequirementAgentConnector_ms": 1.204036629718283}}, "episode_reward_max": -8793.193067534752, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10185.227635424792, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2152.6618360991047}, "policy_reward_mean": {"policy_0": -2546.3069088561974}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.066601448072746, "mean_inference_ms": 1.6979398947944264, "mean_action_processing_ms": 0.5817389883803518, "mean_env_wait_ms": 3.3817689047299617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01376348993052607, "StateBufferConnector_ms": 0.00914801721987517, "ViewRequirementAgentConnector_ms": 1.204036629718283}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 117.26683266754257, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 48000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 34005.019, "sample_time_ms": 16149.366, "synch_weights_time_ms": 2.72}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 46, "training_iteration": 12, "trial_id": "560dd_00000", "date": "2023-09-29_14-47-07", "timestamp": 1695991627, "time_this_iter_s": 34.113972663879395, "time_total_s": 406.3270184993744, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3a8ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 406.3270184993744, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 44.14489795918367, "ram_util_percent": 48.94081632653061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.968171332041422}, "policy_0": {"total_loss": 9.968171332041422, "policy_loss": -0.004432613885899384, "vf_loss": 9.972140191141765, "vf_loss_unclipped": 30712.409827148436, "vf_explained_var": -9.56281026204427e-07, "entropy": 5.292798057301839, "mean_kl_loss": 0.009274985095570567, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8792.471725707523, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10078.410244178549, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2130.7908773321515}, "policy_reward_mean": {"policy_0": -2519.6025610446363}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752, -8882.561572663033, -8896.859407214619, -8828.148273801837, -8792.471725707523], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354, -2214.056665765938, -2233.088915818539, -2226.8123297031366, -2208.603661375413, -2238.98354794099, -2294.957702560529, -2232.127279380932, -2130.7908773321515, -2276.6988956478276, -2179.1918863059973, -2171.4877090686036, -2200.7697827793713, -2206.6228500020525, -2175.167710938216, -2244.1264194132036, -2166.554745354034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.072118736103957, "mean_inference_ms": 1.701006498484841, "mean_action_processing_ms": 0.5829831305950823, "mean_env_wait_ms": 3.3871434002406566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013628005981445312, "StateBufferConnector_ms": 0.009235382080078125, "ViewRequirementAgentConnector_ms": 1.2104640007019043}}, "episode_reward_max": -8792.471725707523, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -10078.410244178549, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2130.7908773321515}, "policy_reward_mean": {"policy_0": -2519.6025610446363}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752, -8882.561572663033, -8896.859407214619, -8828.148273801837, -8792.471725707523], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354, -2214.056665765938, -2233.088915818539, -2226.8123297031366, -2208.603661375413, -2238.98354794099, -2294.957702560529, -2232.127279380932, -2130.7908773321515, -2276.6988956478276, -2179.1918863059973, -2171.4877090686036, -2200.7697827793713, -2206.6228500020525, -2175.167710938216, -2244.1264194132036, -2166.554745354034]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.072118736103957, "mean_inference_ms": 1.701006498484841, "mean_action_processing_ms": 0.5829831305950823, "mean_env_wait_ms": 3.3871434002406566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013628005981445312, "StateBufferConnector_ms": 0.009235382080078125, "ViewRequirementAgentConnector_ms": 1.2104640007019043}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.0377742428411, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 52000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 34022.919, "sample_time_ms": 16188.195, "synch_weights_time_ms": 2.76}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 50, "training_iteration": 13, "trial_id": "560dd_00000", "date": "2023-09-29_14-47-40", "timestamp": 1695991660, "time_this_iter_s": 33.32611846923828, "time_total_s": 439.65313696861267, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3a9a20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 439.65313696861267, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.300000000000004, "ram_util_percent": 48.98749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.969118176778158}, "policy_0": {"total_loss": 9.969118176778158, "policy_loss": -0.0038533781876166663, "vf_loss": 9.972509361012778, "vf_loss_unclipped": 28387.90482688802, "vf_explained_var": -9.801387786865234e-07, "entropy": 5.2817030513763426, "mean_kl_loss": 0.009243810228163481, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8713.27773722811, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -9989.578961376335, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2099.570025953444}, "policy_reward_mean": {"policy_0": -2497.3947403440834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752, -8882.561572663033, -8896.859407214619, -8828.148273801837, -8792.471725707523, -9027.449963194305, -8775.917190444314, -9000.106814527982, -8713.27773722811], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354, -2214.056665765938, -2233.088915818539, -2226.8123297031366, -2208.603661375413, -2238.98354794099, -2294.957702560529, -2232.127279380932, -2130.7908773321515, -2276.6988956478276, -2179.1918863059973, -2171.4877090686036, -2200.7697827793713, -2206.6228500020525, -2175.167710938216, -2244.1264194132036, -2166.554745354034, -2264.820686609188, -2229.3358775660126, -2348.61784549165, -2184.6755535274533, -2142.0407131951415, -2252.8125769623693, -2200.1827034247794, -2180.881196862018, -2264.0459090446816, -2264.2521456049, -2252.228611619158, -2219.580148259256, -2099.570025953444, -2234.6443921645746, -2221.9930697809605, -2157.070249329144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0766635598471486, "mean_inference_ms": 1.7033763064234941, "mean_action_processing_ms": 0.583960340303399, "mean_env_wait_ms": 3.3913056304111313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013967796608253761, "StateBufferConnector_ms": 0.009305830355043765, "ViewRequirementAgentConnector_ms": 1.2244083263255932}}, "episode_reward_max": -8713.27773722811, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -9989.578961376335, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2099.570025953444}, "policy_reward_mean": {"policy_0": -2497.3947403440834}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752, -8882.561572663033, -8896.859407214619, -8828.148273801837, -8792.471725707523, -9027.449963194305, -8775.917190444314, -9000.106814527982, -8713.27773722811], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354, -2214.056665765938, -2233.088915818539, -2226.8123297031366, -2208.603661375413, -2238.98354794099, -2294.957702560529, -2232.127279380932, -2130.7908773321515, -2276.6988956478276, -2179.1918863059973, -2171.4877090686036, -2200.7697827793713, -2206.6228500020525, -2175.167710938216, -2244.1264194132036, -2166.554745354034, -2264.820686609188, -2229.3358775660126, -2348.61784549165, -2184.6755535274533, -2142.0407131951415, -2252.8125769623693, -2200.1827034247794, -2180.881196862018, -2264.0459090446816, -2264.2521456049, -2252.228611619158, -2219.580148259256, -2099.570025953444, -2234.6443921645746, -2221.9930697809605, -2157.070249329144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0766635598471486, "mean_inference_ms": 1.7033763064234941, "mean_action_processing_ms": 0.583960340303399, "mean_env_wait_ms": 3.3913056304111313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013967796608253761, "StateBufferConnector_ms": 0.009305830355043765, "ViewRequirementAgentConnector_ms": 1.2244083263255932}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.44940943324339, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 34010.147, "sample_time_ms": 16168.969, "synch_weights_time_ms": 2.724}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 0}, "done": false, "episodes_total": 54, "training_iteration": 14, "trial_id": "560dd_00000", "date": "2023-09-29_14-48-14", "timestamp": 1695991694, "time_this_iter_s": 33.21244788169861, "time_total_s": 472.8655848503113, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c3aa9e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 472.8655848503113, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.29361702127659, "ram_util_percent": 48.98723404255319}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"__all__": {"num_agent_steps_trained": 128.0, "num_env_steps_trained": 16000.0, "total_loss": 9.966451570129394}, "policy_0": {"total_loss": 9.966451570129394, "policy_loss": -0.004708735242610176, "vf_loss": 9.970614996083578, "vf_loss_unclipped": 27569.332628645832, "vf_explained_var": -9.398778279622396e-07, "entropy": 5.199874296569824, "mean_kl_loss": 0.01090626945191422, "curr_lr": 5e-05, "curr_entropy_coeff": 0.0, "curr_kl_coeff": 0.05000000074505806}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "sampler_results": {"episode_reward_max": -8657.826214343904, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -9904.91339523585, "episode_len_mean": 1002.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2099.570025953444}, "policy_reward_mean": {"policy_0": -2476.2283488089615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752, -8882.561572663033, -8896.859407214619, -8828.148273801837, -8792.471725707523, -9027.449963194305, -8775.917190444314, -9000.106814527982, -8713.27773722811, -8657.826214343904, -8873.019279037324, -8773.915269762127, -8742.95224621369], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354, -2214.056665765938, -2233.088915818539, -2226.8123297031366, -2208.603661375413, -2238.98354794099, -2294.957702560529, -2232.127279380932, -2130.7908773321515, -2276.6988956478276, -2179.1918863059973, -2171.4877090686036, -2200.7697827793713, -2206.6228500020525, -2175.167710938216, -2244.1264194132036, -2166.554745354034, -2264.820686609188, -2229.3358775660126, -2348.61784549165, -2184.6755535274533, -2142.0407131951415, -2252.8125769623693, -2200.1827034247794, -2180.881196862018, -2264.0459090446816, -2264.2521456049, -2252.228611619158, -2219.580148259256, -2099.570025953444, -2234.6443921645746, -2221.9930697809605, -2157.070249329144, -2125.6260803466575, -2212.965067197767, -2176.5916975322184, -2142.6433692672495, -2193.0244389883287, -2307.094695429631, -2231.612583794845, -2141.2875608245236, -2187.5581496707687, -2214.6602646202127, -2181.9203856780427, -2189.776469793113, -2186.4339383217043, -2216.116512556, -2178.36349320903, -2162.038302126949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0804555955355206, "mean_inference_ms": 1.705167342102883, "mean_action_processing_ms": 0.5847168004995672, "mean_env_wait_ms": 3.394421858079949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014011202187373721, "StateBufferConnector_ms": 0.009373549757332638, "ViewRequirementAgentConnector_ms": 1.23253608572072}}, "episode_reward_max": -8657.826214343904, "episode_reward_min": -12343.122281479371, "episode_reward_mean": -9904.91339523585, "episode_len_mean": 1002.0, "episodes_this_iter": 4, "policy_reward_min": {"policy_0": -3215.5327914565732}, "policy_reward_max": {"policy_0": -2099.570025953444}, "policy_reward_mean": {"policy_0": -2476.2283488089615}, "hist_stats": {"episode_reward": [-12044.992440399701, -12288.02433036426, -12343.122281479371, -11762.487970886492, -11765.008513978957, -11500.46278175345, -11707.572006418495, -11320.20080724997, -11692.057300167413, -11013.351185902085, -10947.893199576945, -10968.191681645572, -11140.188788911548, -10944.367793496738, -10817.367969849176, -10001.770049609506, -11116.498916302116, -10185.426572732611, -10311.2698926456, -10045.051836378927, -10524.03882439691, -10101.951199111814, -9861.407735396748, -9451.511094618758, -10018.819342943376, -9569.199406989319, -9972.063695843264, -9376.984083612451, -9348.446686378273, -9261.094581113803, -9339.963238470567, -9376.246019394623, -9245.222172856393, -9195.329859164465, -9419.842504295915, -9191.140231673075, -9217.714192590243, -9463.54901420642, -9071.247048453239, -9179.811756174144, -9282.688485162007, -9269.47989821688, -9107.18409467943, -8820.585597179248, -9146.45107933538, -8793.193067534752, -8882.561572663033, -8896.859407214619, -8828.148273801837, -8792.471725707523, -9027.449963194305, -8775.917190444314, -9000.106814527982, -8713.27773722811, -8657.826214343904, -8873.019279037324, -8773.915269762127, -8742.95224621369], "episode_lengths": [1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002, 1002], "policy_policy_0_reward": [-3060.9673619412965, -3010.9872659235984, -3048.882766387765, -2924.15504614704, -3054.450849489479, -3154.8412152762576, -3061.302824979414, -3017.429440619126, -3164.6486137050106, -2838.946813513717, -3215.5327914565732, -3123.994062804066, -3055.702718436066, -3020.8048998626136, -2903.2500384897053, -2782.7303140980675, -3026.4371900364977, -3051.183951481979, -2809.1356552685615, -2878.2517171919317, -3034.0906552379465, -2813.3201752534123, -2798.35532248877, -2854.6966287733358, -2746.1632753252165, -3056.860225412906, -3049.29732947272, -2855.2511762077147, -2961.215032040087, -2760.496888592963, -2790.3574254278283, -2808.131461189085, -2951.161947488904, -2923.7153782904848, -3098.6046315226545, -2718.5753428653716, -2824.8928475835673, -2894.7295878900914, -2694.454647120716, -2599.2741033077464, -2755.1771370483284, -2845.789269804719, -2642.1584897541848, -2704.768302969727, -2766.476059281491, -2927.260209170049, -2744.4656613945253, -2529.9897517995087, -2814.942392078917, -2750.9407328847246, -2947.4807071741366, -2626.82495677377, -2891.694412401222, -2800.262133127065, -2822.481270006906, -2429.929977961521, -2709.5661869539376, -2912.2045788814553, -2816.7435496645003, -2378.8536543492837, -2464.8857314100496, -2676.7187998304594, -2505.9764449568465, -2354.189073412113, -2807.187553049154, -2927.9450132031434, -2768.0674603520233, -2613.2988896978113, -2498.345013629821, -2680.374605040601, -2511.235239267131, -2495.4717147950487, -2636.661897306462, -2730.342017852088, -2658.841153945205, -2285.4248235418154, -2427.2738668329366, -2741.947977817997, -2594.4805228748587, -2281.349468853101, -2533.4307869865806, -2764.514325786255, -2663.0338562934044, -2563.059855330633, -2505.3012409376042, -2583.191401049595, -2587.5768457656663, -2425.8817113589344, -2493.586916381656, -2610.147919734382, -2480.6340662365074, -2277.038833044205, -2398.578057718318, -2428.230046285315, -2374.641695820557, -2250.061294794585, -2551.5298824782426, -2686.13032680548, -2482.8416036748517, -2298.31752998481, -2422.9797710535004, -2457.6271089874904, -2437.4829938957814, -2251.1095330525586, -2566.8602211161437, -2605.3387227041962, -2450.7801330895554, -2349.084618933364, -2372.714299795579, -2458.0251760204364, -2323.4056677538324, -2222.8389400425795, -2337.798822147286, -2524.2471728046703, -2301.6970714463923, -2184.703619979935, -2329.288521133822, -2343.349880286615, -2334.436387819432, -2254.0197918739186, -2300.9553831107705, -2447.1095009372075, -2317.239588573539, -2274.658765849041, -2348.64035353828, -2328.0343511342503, -2386.321733439556, -2313.2495812825427, -2359.3899680011114, -2303.8693870719026, -2388.585825362217, -2193.376992421139, -2265.406061572353, -2258.783228080989, -2418.8606614447476, -2252.2799080663594, -2338.077807464108, -2512.8181760368234, -2294.9336358601295, -2274.012884934842, -2277.5690221105074, -2329.286088257017, -2242.8726947681243, -2341.4124265374244, -2261.9559625747374, -2378.77829015982, -2285.009256249042, -2291.97068360664, -2338.8081117441684, -2412.871219589891, -2350.8384331173197, -2361.03124975507, -2326.908884313946, -2233.4125806234874, -2287.8954785094293, -2223.0301050063827, -2363.5026902559116, -2288.4549293929267, -2237.618441353954, -2290.2356951713596, -2446.4346640115796, -2232.4258651490322, -2280.76132161324, -2323.066634388123, -2396.710833716138, -2320.0754871864174, -2311.942011410949, -2240.7515659033934, -2198.75085989944, -2372.934820500183, -2286.7129724253264, -2248.7854418544844, -2260.014077477732, -2197.805524184476, -2165.0180509064526, -2197.7479446105817, -2273.8590751923866, -2289.906837170862, -2291.05232496967, -2291.6328420024424, -2152.6618360991047, -2246.3131345616484, -2199.3214437834927, -2194.8966530905354, -2214.056665765938, -2233.088915818539, -2226.8123297031366, -2208.603661375413, -2238.98354794099, -2294.957702560529, -2232.127279380932, -2130.7908773321515, -2276.6988956478276, -2179.1918863059973, -2171.4877090686036, -2200.7697827793713, -2206.6228500020525, -2175.167710938216, -2244.1264194132036, -2166.554745354034, -2264.820686609188, -2229.3358775660126, -2348.61784549165, -2184.6755535274533, -2142.0407131951415, -2252.8125769623693, -2200.1827034247794, -2180.881196862018, -2264.0459090446816, -2264.2521456049, -2252.228611619158, -2219.580148259256, -2099.570025953444, -2234.6443921645746, -2221.9930697809605, -2157.070249329144, -2125.6260803466575, -2212.965067197767, -2176.5916975322184, -2142.6433692672495, -2193.0244389883287, -2307.094695429631, -2231.612583794845, -2141.2875608245236, -2187.5581496707687, -2214.6602646202127, -2181.9203856780427, -2189.776469793113, -2186.4339383217043, -2216.116512556, -2178.36349320903, -2162.038302126949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0804555955355206, "mean_inference_ms": 1.705167342102883, "mean_action_processing_ms": 0.5847168004995672, "mean_env_wait_ms": 3.394421858079949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014011202187373721, "StateBufferConnector_ms": 0.009373549757332638, "ViewRequirementAgentConnector_ms": 1.23253608572072}, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0, "num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 120.43701454949706, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 60000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 34016.768, "sample_time_ms": 16167.23, "synch_weights_time_ms": 2.754}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 0}, "done": true, "episodes_total": 58, "training_iteration": 15, "trial_id": "560dd_00000", "date": "2023-09-29_14-48-47", "timestamp": 1695991727, "time_this_iter_s": 33.2156937122345, "time_total_s": 506.0812785625458, "pid": 79436, "hostname": "saz-Lenovo-Z50-70", "node_ip": "172.18.15.139", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "<class 'gym_pybullet_drones.envs.multi_agent_rl.CustomBaseMAA3.CustomRl3'>", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": true, "explore": true, "exploration_config": {}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7fe38c4f1990>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": "SingleAgentRLModuleSpec(module_class=<class 'ray.rllib.algorithms.ppo.torch.ppo_torch_rl_module.PPOTorchRLModule'>, observation_space=None, action_space=None, model_config_dict=None, catalog_class=<class 'ray.rllib.algorithms.ppo.ppo_catalog.PPOCatalog'>, load_state_path=None)", "_enable_rl_module_api": true, "_AlgorithmConfig__prior_exploration_config": {"type": "StochasticSampling"}, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box([-1. -1. -1. -1. -1. -1. -1. -1. -1.  0.  0.  0.  0.], [1. 1. 1. 1. 1. 1. 2. 2. 2. 2. 1. 1. 2.], (13,), float32)", "Box(-1.0, 1.0, (4,), float32)", null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 2}, "time_since_restore": 506.0812785625458, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.42765957446809, "ram_util_percent": 48.980851063829796}}
